!function(){var t,e,r,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function i(t){return t&&t.__esModule?t.default:t}var a={},s={},o=n.parcelRequired167;null==o&&((o=function(t){if(t in a)return a[t].exports;if(t in s){var e=s[t];delete s[t];var r={id:t,exports:{}};return a[t]=r,e.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){s[t]=e},n.parcelRequired167=o),(0,o.register)("1WSnx",function(t,e){(function(){var r,i="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",o=1/0,u=0/0,l=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],h="[object Arguments]",c="[object Array]",f="[object Boolean]",d="[object Date]",p="[object Error]",m="[object Function]",v="[object GeneratorFunction]",g="[object Map]",y="[object Number]",b="[object Object]",w="[object Promise]",k="[object RegExp]",_="[object Set]",C="[object String]",x="[object Symbol]",A="[object WeakMap]",S="[object ArrayBuffer]",E="[object DataView]",I="[object Float32Array]",P="[object Float64Array]",M="[object Int8Array]",R="[object Int16Array]",O="[object Int32Array]",T="[object Uint8Array]",L="[object Uint8ClampedArray]",D="[object Uint16Array]",j="[object Uint32Array]",B=/\b__p \+= '';/g,F=/\b(__p \+=) '' \+/g,z=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,U=/[&<>"']/g,N=RegExp(W.source),H=RegExp(U.source),V=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,X=/<%=([\s\S]+?)%>/g,q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,K=/[\\^$.*+?()[\]{}|]/g,Y=RegExp(K.source),Q=/^\s+/,J=/\s/,tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,te=/\{\n\/\* \[wrapped with (.+)\] \*/,tr=/,? & /,tn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ti=/[()=,{}\[\]\/\s]/,ta=/\\(\\)?/g,ts=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,to=/\w*$/,tu=/^[-+]0x[0-9a-f]+$/i,tl=/^0b[01]+$/i,th=/^\[object .+?Constructor\]$/,tc=/^0o[0-7]+$/i,tf=/^(?:0|[1-9]\d*)$/,td=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tp=/($^)/,tm=/['\n\r\u2028\u2029\\]/g,tv="\ud800-\udfff",tg="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ty="\\u2700-\\u27bf",tb="a-z\\xdf-\\xf6\\xf8-\\xff",tw="A-Z\\xc0-\\xd6\\xd8-\\xde",tk="\\ufe0e\\ufe0f",t_="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tC="['’]",tx="["+t_+"]",tA="["+tg+"]",tS="["+tb+"]",tE="[^"+tv+t_+"\\d+"+ty+tb+tw+"]",tI="\ud83c[\udffb-\udfff]",tP="[^"+tv+"]",tM="(?:\ud83c[\udde6-\uddff]){2}",tR="[\ud800-\udbff][\udc00-\udfff]",tO="["+tw+"]",tT="\\u200d",tL="(?:"+tS+"|"+tE+")",tD="(?:"+tO+"|"+tE+")",tj="(?:"+tC+"(?:d|ll|m|re|s|t|ve))?",tB="(?:"+tC+"(?:D|LL|M|RE|S|T|VE))?",tF="(?:"+tA+"|"+tI+")?",tz="["+tk+"]?",tW="(?:"+tT+"(?:"+[tP,tM,tR].join("|")+")"+tz+tF+")*",tU=tz+tF+tW,tN="(?:"+["["+ty+"]",tM,tR].join("|")+")"+tU,tH="(?:"+[tP+tA+"?",tA,tM,tR,"["+tv+"]"].join("|")+")",tV=RegExp(tC,"g"),t$=RegExp(tA,"g"),tX=RegExp(tI+"(?="+tI+")|"+tH+tU,"g"),tq=RegExp([tO+"?"+tS+"+"+tj+"(?="+[tx,tO,"$"].join("|")+")",tD+"+"+tB+"(?="+[tx,tO+tL,"$"].join("|")+")",tO+"?"+tL+"+"+tj,tO+"+"+tB,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",tN].join("|"),"g"),tG=RegExp("["+tT+tv+tg+tk+"]"),tZ=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tK=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],tY=-1,tQ={};tQ[I]=tQ[P]=tQ[M]=tQ[R]=tQ[O]=tQ[T]=tQ[L]=tQ[D]=tQ[j]=!0,tQ[h]=tQ[c]=tQ[S]=tQ[f]=tQ[E]=tQ[d]=tQ[p]=tQ[m]=tQ[g]=tQ[y]=tQ[b]=tQ[k]=tQ[_]=tQ[C]=tQ[A]=!1;var tJ={};tJ[h]=tJ[c]=tJ[S]=tJ[E]=tJ[f]=tJ[d]=tJ[I]=tJ[P]=tJ[M]=tJ[R]=tJ[O]=tJ[g]=tJ[y]=tJ[b]=tJ[k]=tJ[_]=tJ[C]=tJ[x]=tJ[T]=tJ[L]=tJ[D]=tJ[j]=!0,tJ[p]=tJ[m]=tJ[A]=!1;var t0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},t1=parseFloat,t2=parseInt,t6="object"==typeof n&&n&&n.Object===Object&&n,t3="object"==typeof self&&self&&self.Object===Object&&self,t4=t6||t3||Function("return this")(),t7=e&&!e.nodeType&&e,t8=t7&&t&&!t.nodeType&&t,t5=t8&&t8.exports===t7,t9=t5&&t6.process,et=function(){try{var t=t8&&t8.require&&t8.require("util").types;if(t)return t;return t9&&t9.binding&&t9.binding("util")}catch(t){}}(),ee=et&&et.isArrayBuffer,er=et&&et.isDate,en=et&&et.isMap,ei=et&&et.isRegExp,ea=et&&et.isSet,es=et&&et.isTypedArray;function eo(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function eu(t,e,r,n){for(var i=-1,a=null==t?0:t.length;++i<a;){var s=t[i];e(n,s,r(s),t)}return n}function el(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}function eh(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function ec(t,e){for(var r=-1,n=null==t?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}function ef(t,e){return!!(null==t?0:t.length)&&e_(t,e,0)>-1}function ed(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}function ep(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}function em(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function ev(t,e,r,n){var i=-1,a=null==t?0:t.length;for(n&&a&&(r=t[++i]);++i<a;)r=e(r,t[i],i,t);return r}function eg(t,e,r,n){var i=null==t?0:t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function ey(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var eb=eS("length");function ew(t,e,r){var n;return r(t,function(t,r,i){if(e(t,r,i))return n=r,!1}),n}function ek(t,e,r,n){for(var i=t.length,a=r+(n?1:-1);n?a--:++a<i;)if(e(t[a],a,t))return a;return -1}function e_(t,e,r){return e==e?function(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return -1}(t,e,r):ek(t,ex,r)}function eC(t,e,r,n){for(var i=r-1,a=t.length;++i<a;)if(n(t[i],e))return i;return -1}function ex(t){return t!=t}function eA(t,e){var r=null==t?0:t.length;return r?eP(t,e)/r:u}function eS(t){return function(e){return null==e?r:e[t]}}function eE(t){return function(e){return null==t?r:t[e]}}function eI(t,e,r,n,i){return i(t,function(t,i,a){r=n?(n=!1,t):e(r,t,i,a)}),r}function eP(t,e){for(var n,i=-1,a=t.length;++i<a;){var s=e(t[i]);s!==r&&(n=n===r?s:n+s)}return n}function eM(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function eR(t){return t?t.slice(0,eq(t)+1).replace(Q,""):t}function eO(t){return function(e){return t(e)}}function eT(t,e){return ep(e,function(e){return t[e]})}function eL(t,e){return t.has(e)}function eD(t,e){for(var r=-1,n=t.length;++r<n&&e_(e,t[r],0)>-1;);return r}function ej(t,e){for(var r=t.length;r--&&e_(e,t[r],0)>-1;);return r}var eB=eE({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),eF=eE({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ez(t){return"\\"+t0[t]}function eW(t){return tG.test(t)}function eU(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function eN(t,e){return function(r){return t(e(r))}}function eH(t,e){for(var r=-1,n=t.length,i=0,a=[];++r<n;){var o=t[r];(o===e||o===s)&&(t[r]=s,a[i++]=r)}return a}function eV(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}function e$(t){return eW(t)?function(t){for(var e=tX.lastIndex=0;tX.test(t);)++e;return e}(t):eb(t)}function eX(t){return eW(t)?t.match(tX)||[]:t.split("")}function eq(t){for(var e=t.length;e--&&J.test(t.charAt(e)););return e}var eG=eE({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),eZ=function t(e){var n,J,tv,tg,ty=(e=null==e?t4:eZ.defaults(t4.Object(),e,eZ.pick(t4,tK))).Array,tb=e.Date,tw=e.Error,tk=e.Function,t_=e.Math,tC=e.Object,tx=e.RegExp,tA=e.String,tS=e.TypeError,tE=ty.prototype,tI=tk.prototype,tP=tC.prototype,tM=e["__core-js_shared__"],tR=tI.toString,tO=tP.hasOwnProperty,tT=0,tL=(n=/[^.]+$/.exec(tM&&tM.keys&&tM.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",tD=tP.toString,tj=tR.call(tC),tB=t4._,tF=tx("^"+tR.call(tO).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tz=t5?e.Buffer:r,tW=e.Symbol,tU=e.Uint8Array,tN=tz?tz.allocUnsafe:r,tH=eN(tC.getPrototypeOf,tC),tX=tC.create,tG=tP.propertyIsEnumerable,t0=tE.splice,t6=tW?tW.isConcatSpreadable:r,t3=tW?tW.iterator:r,t7=tW?tW.toStringTag:r,t8=function(){try{var t=ip(tC,"defineProperty");return t({},"",{}),t}catch(t){}}(),t9=e.clearTimeout!==t4.clearTimeout&&e.clearTimeout,et=tb&&tb.now!==t4.Date.now&&tb.now,eb=e.setTimeout!==t4.setTimeout&&e.setTimeout,eE=t_.ceil,eK=t_.floor,eY=tC.getOwnPropertySymbols,eQ=tz?tz.isBuffer:r,eJ=e.isFinite,e0=tE.join,e1=eN(tC.keys,tC),e2=t_.max,e6=t_.min,e3=tb.now,e4=e.parseInt,e7=t_.random,e8=tE.reverse,e5=ip(e,"DataView"),e9=ip(e,"Map"),rt=ip(e,"Promise"),re=ip(e,"Set"),rr=ip(e,"WeakMap"),rn=ip(tC,"create"),ri=rr&&new rr,ra={},rs=iz(e5),ro=iz(e9),ru=iz(rt),rl=iz(re),rh=iz(rr),rc=tW?tW.prototype:r,rf=rc?rc.valueOf:r,rd=rc?rc.toString:r;function rp(t){if(aX(t)&&!aD(t)&&!(t instanceof ry)){if(t instanceof rg)return t;if(tO.call(t,"__wrapped__"))return iW(t)}return new rg(t)}var rm=function(){function t(){}return function(e){if(!a$(e))return{};if(tX)return tX(e);t.prototype=e;var n=new t;return t.prototype=r,n}}();function rv(){}function rg(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=r}function ry(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=0xffffffff,this.__views__=[]}function rb(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function rw(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function rk(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function r_(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new rk;++e<r;)this.add(t[e])}function rC(t){var e=this.__data__=new rw(t);this.size=e.size}function rx(t,e){var r=aD(t),n=!r&&aL(t),i=!r&&!n&&az(t),a=!r&&!n&&!i&&a0(t),s=r||n||i||a,o=s?eM(t.length,tA):[],u=o.length;for(var l in t)(e||tO.call(t,l))&&!(s&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ik(l,u)))&&o.push(l);return o}function rA(t){var e=t.length;return e?t[nl(0,e-1)]:r}function rS(t,e,n){(n===r||aR(t[e],n))&&(n!==r||e in t)||rR(t,e,n)}function rE(t,e,n){var i=t[e];tO.call(t,e)&&aR(i,n)&&(n!==r||e in t)||rR(t,e,n)}function rI(t,e){for(var r=t.length;r--;)if(aR(t[r][0],e))return r;return -1}function rP(t,e,r,n){return rF(t,function(t,i,a){e(n,t,r(t),a)}),n}function rM(t,e){return t&&nU(e,sf(e),t)}function rR(t,e,r){"__proto__"==e&&t8?t8(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function rO(t,e){for(var n=-1,i=e.length,a=ty(i),s=null==t;++n<i;)a[n]=s?r:so(t,e[n]);return a}function rT(t,e,n){return t==t&&(n!==r&&(t=t<=n?t:n),e!==r&&(t=t>=e?t:e)),t}function rL(t,e,n,i,a,s){var o,u=1&e,l=2&e,c=4&e;if(n&&(o=a?n(t,i,a,s):n(t)),o!==r)return o;if(!a$(t))return t;var p=aD(t);if(p){if(w=t.length,A=new t.constructor(w),w&&"string"==typeof t[0]&&tO.call(t,"index")&&(A.index=t.index,A.input=t.input),o=A,!u)return nW(t,o)}else{var w,A,B,F,z,W=ig(t),U=W==m||W==v;if(az(t))return nL(t,u);if(W==b||W==h||U&&!a){if(o=l||U?{}:ib(t),!u)return l?(B=(z=o)&&nU(t,sd(t),z),nU(t,iv(t),B)):(F=rM(o,t),nU(t,im(t),F))}else{if(!tJ[W])return a?t:{};o=function(t,e,r){var n,i,a=t.constructor;switch(e){case S:return nD(t);case f:case d:return new a(+t);case E:return n=r?nD(t.buffer):t.buffer,new t.constructor(n,t.byteOffset,t.byteLength);case I:case P:case M:case R:case O:case T:case L:case D:case j:return nj(t,r);case g:return new a;case y:case C:return new a(t);case k:return(i=new t.constructor(t.source,to.exec(t))).lastIndex=t.lastIndex,i;case _:return new a;case x:return rf?tC(rf.call(t)):{}}}(t,W,u)}}s||(s=new rC);var N=s.get(t);if(N)return N;s.set(t,o),aY(t)?t.forEach(function(r){o.add(rL(r,e,n,r,t,s))}):aq(t)&&t.forEach(function(r,i){o.set(i,rL(r,e,n,i,t,s))});var H=c?l?is:ia:l?sd:sf,V=p?r:H(t);return el(V||t,function(r,i){V&&(r=t[i=r]),rE(o,i,rL(r,e,n,i,t,s))}),o}function rD(t,e,n){var i=n.length;if(null==t)return!i;for(t=tC(t);i--;){var a=n[i],s=e[a],o=t[a];if(o===r&&!(a in t)||!s(o))return!1}return!0}function rj(t,e,n){if("function"!=typeof t)throw new tS(i);return iO(function(){t.apply(r,n)},e)}function rB(t,e,r,n){var i=-1,a=ef,s=!0,o=t.length,u=[],l=e.length;if(!o)return u;r&&(e=ep(e,eO(r))),n?(a=ed,s=!1):e.length>=200&&(a=eL,s=!1,e=new r_(e));t:for(;++i<o;){var h=t[i],c=null==r?h:r(h);if(h=n||0!==h?h:0,s&&c==c){for(var f=l;f--;)if(e[f]===c)continue t;u.push(h)}else a(e,c,n)||u.push(h)}return u}rp.templateSettings={escape:V,evaluate:$,interpolate:X,variable:"",imports:{_:rp}},rp.prototype=rv.prototype,rp.prototype.constructor=rp,rg.prototype=rm(rv.prototype),rg.prototype.constructor=rg,ry.prototype=rm(rv.prototype),ry.prototype.constructor=ry,rb.prototype.clear=function(){this.__data__=rn?rn(null):{},this.size=0},rb.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},rb.prototype.get=function(t){var e=this.__data__;if(rn){var n=e[t];return n===a?r:n}return tO.call(e,t)?e[t]:r},rb.prototype.has=function(t){var e=this.__data__;return rn?e[t]!==r:tO.call(e,t)},rb.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rn&&e===r?a:e,this},rw.prototype.clear=function(){this.__data__=[],this.size=0},rw.prototype.delete=function(t){var e=this.__data__,r=rI(e,t);return!(r<0)&&(r==e.length-1?e.pop():t0.call(e,r,1),--this.size,!0)},rw.prototype.get=function(t){var e=this.__data__,n=rI(e,t);return n<0?r:e[n][1]},rw.prototype.has=function(t){return rI(this.__data__,t)>-1},rw.prototype.set=function(t,e){var r=this.__data__,n=rI(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},rk.prototype.clear=function(){this.size=0,this.__data__={hash:new rb,map:new(e9||rw),string:new rb}},rk.prototype.delete=function(t){var e=ic(this,t).delete(t);return this.size-=e?1:0,e},rk.prototype.get=function(t){return ic(this,t).get(t)},rk.prototype.has=function(t){return ic(this,t).has(t)},rk.prototype.set=function(t,e){var r=ic(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},r_.prototype.add=r_.prototype.push=function(t){return this.__data__.set(t,a),this},r_.prototype.has=function(t){return this.__data__.has(t)},rC.prototype.clear=function(){this.__data__=new rw,this.size=0},rC.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},rC.prototype.get=function(t){return this.__data__.get(t)},rC.prototype.has=function(t){return this.__data__.has(t)},rC.prototype.set=function(t,e){var r=this.__data__;if(r instanceof rw){var n=r.__data__;if(!e9||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new rk(n)}return r.set(t,e),this.size=r.size,this};var rF=nV(rX),rz=nV(rq,!0);function rW(t,e){var r=!0;return rF(t,function(t,n,i){return r=!!e(t,n,i)}),r}function rU(t,e,n){for(var i=-1,a=t.length;++i<a;){var s=t[i],o=e(s);if(null!=o&&(u===r?o==o&&!aJ(o):n(o,u)))var u=o,l=s}return l}function rN(t,e){var r=[];return rF(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r}function rH(t,e,r,n,i){var a=-1,s=t.length;for(r||(r=iw),i||(i=[]);++a<s;){var o=t[a];e>0&&r(o)?e>1?rH(o,e-1,r,n,i):em(i,o):n||(i[i.length]=o)}return i}var rV=n$(),r$=n$(!0);function rX(t,e){return t&&rV(t,e,sf)}function rq(t,e){return t&&r$(t,e,sf)}function rG(t,e){return ec(e,function(e){return aN(t[e])})}function rZ(t,e){e=nR(e,t);for(var n=0,i=e.length;null!=t&&n<i;)t=t[iF(e[n++])];return n&&n==i?t:r}function rK(t,e,r){var n=e(t);return aD(t)?n:em(n,r(t))}function rY(t){return null==t?t===r?"[object Undefined]":"[object Null]":t7&&t7 in tC(t)?function(t){var e=tO.call(t,t7),n=t[t7];try{t[t7]=r;var i=!0}catch(t){}var a=tD.call(t);return i&&(e?t[t7]=n:delete t[t7]),a}(t):tD.call(t)}function rQ(t,e){return t>e}function rJ(t,e){return null!=t&&tO.call(t,e)}function r0(t,e){return null!=t&&e in tC(t)}function r1(t,e,n){for(var i=n?ed:ef,a=t[0].length,s=t.length,o=s,u=ty(s),l=1/0,h=[];o--;){var c=t[o];o&&e&&(c=ep(c,eO(e))),l=e6(c.length,l),u[o]=!n&&(e||a>=120&&c.length>=120)?new r_(o&&c):r}c=t[0];var f=-1,d=u[0];t:for(;++f<a&&h.length<l;){var p=c[f],m=e?e(p):p;if(p=n||0!==p?p:0,!(d?eL(d,m):i(h,m,n))){for(o=s;--o;){var v=u[o];if(!(v?eL(v,m):i(t[o],m,n)))continue t}d&&d.push(m),h.push(p)}}return h}function r2(t,e,n){e=nR(e,t);var i=null==(t=iP(t,e))?t:t[iF(iY(e))];return null==i?r:eo(i,t,n)}function r6(t){return aX(t)&&rY(t)==h}function r3(t,e,n,i,a){return t===e||(null!=t&&null!=e&&(aX(t)||aX(e))?function(t,e,n,i,a,s){var o=aD(t),u=aD(e),l=o?c:ig(t),m=u?c:ig(e);l=l==h?b:l,m=m==h?b:m;var v=l==b,w=m==b,A=l==m;if(A&&az(t)){if(!az(e))return!1;o=!0,v=!1}if(A&&!v)return s||(s=new rC),o||a0(t)?ir(t,e,n,i,a,s):function(t,e,r,n,i,a,s){switch(r){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)break;t=t.buffer,e=e.buffer;case S:if(t.byteLength!=e.byteLength||!a(new tU(t),new tU(e)))break;return!0;case f:case d:case y:return aR(+t,+e);case p:return t.name==e.name&&t.message==e.message;case k:case C:return t==e+"";case g:var o=eU;case _:var u=1&n;if(o||(o=eV),t.size!=e.size&&!u)break;var l=s.get(t);if(l)return l==e;n|=2,s.set(t,e);var h=ir(o(t),o(e),n,i,a,s);return s.delete(t),h;case x:if(rf)return rf.call(t)==rf.call(e)}return!1}(t,e,l,n,i,a,s);if(!(1&n)){var I=v&&tO.call(t,"__wrapped__"),P=w&&tO.call(e,"__wrapped__");if(I||P){var M=I?t.value():t,R=P?e.value():e;return s||(s=new rC),a(M,R,n,i,s)}}return!!A&&(s||(s=new rC),function(t,e,n,i,a,s){var o=1&n,u=ia(t),l=u.length;if(l!=ia(e).length&&!o)return!1;for(var h=l;h--;){var c=u[h];if(!(o?c in e:tO.call(e,c)))return!1}var f=s.get(t),d=s.get(e);if(f&&d)return f==e&&d==t;var p=!0;s.set(t,e),s.set(e,t);for(var m=o;++h<l;){var v=t[c=u[h]],g=e[c];if(i)var y=o?i(g,v,c,e,t,s):i(v,g,c,t,e,s);if(!(y===r?v===g||a(v,g,n,i,s):y)){p=!1;break}m||(m="constructor"==c)}if(p&&!m){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(p=!1)}return s.delete(t),s.delete(e),p}(t,e,n,i,a,s))}(t,e,n,i,r3,a):t!=t&&e!=e)}function r4(t,e,n,i){var a=n.length,s=a,o=!i;if(null==t)return!s;for(t=tC(t);a--;){var u=n[a];if(o&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++a<s;){var l=(u=n[a])[0],h=t[l],c=u[1];if(o&&u[2]){if(h===r&&!(l in t))return!1}else{var f=new rC;if(i)var d=i(h,c,l,t,e,f);if(!(d===r?r3(c,h,3,i,f):d))return!1}}return!0}function r7(t){return!(!a$(t)||tL&&tL in t)&&(aN(t)?tF:th).test(iz(t))}function r8(t){return"function"==typeof t?t:null==t?sF:"object"==typeof t?aD(t)?nr(t[0],t[1]):ne(t):sq(t)}function r5(t){if(!iS(t))return e1(t);var e=[];for(var r in tC(t))tO.call(t,r)&&"constructor"!=r&&e.push(r);return e}function r9(t,e){return t<e}function nt(t,e){var r=-1,n=aB(t)?ty(t.length):[];return rF(t,function(t,i,a){n[++r]=e(t,i,a)}),n}function ne(t){var e=id(t);return 1==e.length&&e[0][2]?iE(e[0][0],e[0][1]):function(r){return r===t||r4(r,t,e)}}function nr(t,e){var n;return iC(t)&&(n=e)==n&&!a$(n)?iE(iF(t),e):function(n){var i=so(n,t);return i===r&&i===e?su(n,t):r3(e,i,3)}}function nn(t,e,n,i,a){t!==e&&rV(e,function(s,o){if(a||(a=new rC),a$(s))(function(t,e,n,i,a,s,o){var u=iM(t,n),l=iM(e,n),h=o.get(l);if(h){rS(t,n,h);return}var c=s?s(u,l,n+"",t,e,o):r,f=c===r;if(f){var d=aD(l),p=!d&&az(l),m=!d&&!p&&a0(l);c=l,d||p||m?aD(u)?c=u:aF(u)?c=nW(u):p?(f=!1,c=nL(l,!0)):m?(f=!1,c=nj(l,!0)):c=[]:aZ(l)||aL(l)?(c=u,aL(u)?c=a5(u):(!a$(u)||aN(u))&&(c=ib(l))):f=!1}f&&(o.set(l,c),a(c,l,i,s,o),o.delete(l)),rS(t,n,c)})(t,e,o,n,nn,i,a);else{var u=i?i(iM(t,o),s,o+"",t,e,a):r;u===r&&(u=s),rS(t,o,u)}},sd)}function ni(t,e){var n=t.length;if(n)return ik(e+=e<0?n:0,n)?t[e]:r}function na(t,e,r){e=e.length?ep(e,function(t){return aD(t)?function(e){return rZ(e,1===t.length?t[0]:t)}:t}):[sF];var n=-1;return e=ep(e,eO(ih())),function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}(nt(t,function(t,r,i){return{criteria:ep(e,function(e){return e(t)}),index:++n,value:t}}),function(t,e){return function(t,e,r){for(var n=-1,i=t.criteria,a=e.criteria,s=i.length,o=r.length;++n<s;){var u=nB(i[n],a[n]);if(u){if(n>=o)return u;return u*("desc"==r[n]?-1:1)}}return t.index-e.index}(t,e,r)})}function ns(t,e,r){for(var n=-1,i=e.length,a={};++n<i;){var s=e[n],o=rZ(t,s);r(o,s)&&nf(a,nR(s,t),o)}return a}function no(t,e,r,n){var i=n?eC:e_,a=-1,s=e.length,o=t;for(t===e&&(e=nW(e)),r&&(o=ep(t,eO(r)));++a<s;)for(var u=0,l=e[a],h=r?r(l):l;(u=i(o,h,u,n))>-1;)o!==t&&t0.call(o,u,1),t0.call(t,u,1);return t}function nu(t,e){for(var r=t?e.length:0,n=r-1;r--;){var i=e[r];if(r==n||i!==a){var a=i;ik(i)?t0.call(t,i,1):nC(t,i)}}return t}function nl(t,e){return t+eK(e7()*(e-t+1))}function nh(t,e){var r="";if(!t||e<1||e>0x1fffffffffffff)return r;do e%2&&(r+=t),(e=eK(e/2))&&(t+=t);while(e)return r}function nc(t,e){return iT(iI(t,e,sF),t+"")}function nf(t,e,n,i){if(!a$(t))return t;e=nR(e,t);for(var a=-1,s=e.length,o=s-1,u=t;null!=u&&++a<s;){var l=iF(e[a]),h=n;if("__proto__"===l||"constructor"===l||"prototype"===l)break;if(a!=o){var c=u[l];(h=i?i(c,l,u):r)===r&&(h=a$(c)?c:ik(e[a+1])?[]:{})}rE(u,l,h),u=u[l]}return t}var nd=ri?function(t,e){return ri.set(t,e),t}:sF,np=t8?function(t,e){return t8(t,"toString",{configurable:!0,enumerable:!1,value:sD(e),writable:!0})}:sF;function nm(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var a=ty(i);++n<i;)a[n]=t[n+e];return a}function nv(t,e){var r;return rF(t,function(t,n,i){return!(r=e(t,n,i))}),!!r}function ng(t,e,r){var n=0,i=null==t?n:t.length;if("number"==typeof e&&e==e&&i<=0x7fffffff){for(;n<i;){var a=n+i>>>1,s=t[a];null!==s&&!aJ(s)&&(r?s<=e:s<e)?n=a+1:i=a}return i}return ny(t,e,sF,r)}function ny(t,e,n,i){var a=0,s=null==t?0:t.length;if(0===s)return 0;for(var o=(e=n(e))!=e,u=null===e,l=aJ(e),h=e===r;a<s;){var c=eK((a+s)/2),f=n(t[c]),d=f!==r,p=null===f,m=f==f,v=aJ(f);if(o)var g=i||m;else g=h?m&&(i||d):u?m&&d&&(i||!p):l?m&&d&&!p&&(i||!v):!p&&!v&&(i?f<=e:f<e);g?a=c+1:s=c}return e6(s,0xfffffffe)}function nb(t,e){for(var r=-1,n=t.length,i=0,a=[];++r<n;){var s=t[r],o=e?e(s):s;if(!r||!aR(o,u)){var u=o;a[i++]=0===s?0:s}}return a}function nw(t){return"number"==typeof t?t:aJ(t)?u:+t}function nk(t){if("string"==typeof t)return t;if(aD(t))return ep(t,nk)+"";if(aJ(t))return rd?rd.call(t):"";var e=t+"";return"0"==e&&1/t==-o?"-0":e}function n_(t,e,r){var n=-1,i=ef,a=t.length,s=!0,o=[],u=o;if(r)s=!1,i=ed;else if(a>=200){var l=e?null:n7(t);if(l)return eV(l);s=!1,i=eL,u=new r_}else u=e?[]:o;t:for(;++n<a;){var h=t[n],c=e?e(h):h;if(h=r||0!==h?h:0,s&&c==c){for(var f=u.length;f--;)if(u[f]===c)continue t;e&&u.push(c),o.push(h)}else i(u,c,r)||(u!==o&&u.push(c),o.push(h))}return o}function nC(t,e){return e=nR(e,t),null==(t=iP(t,e))||delete t[iF(iY(e))]}function nx(t,e,r,n){return nf(t,e,r(rZ(t,e)),n)}function nA(t,e,r,n){for(var i=t.length,a=n?i:-1;(n?a--:++a<i)&&e(t[a],a,t););return r?nm(t,n?0:a,n?a+1:i):nm(t,n?a+1:0,n?i:a)}function nS(t,e){var r=t;return r instanceof ry&&(r=r.value()),ev(e,function(t,e){return e.func.apply(e.thisArg,em([t],e.args))},r)}function nE(t,e,r){var n=t.length;if(n<2)return n?n_(t[0]):[];for(var i=-1,a=ty(n);++i<n;)for(var s=t[i],o=-1;++o<n;)o!=i&&(a[i]=rB(a[i]||s,t[o],e,r));return n_(rH(a,1),e,r)}function nI(t,e,n){for(var i=-1,a=t.length,s=e.length,o={};++i<a;){var u=i<s?e[i]:r;n(o,t[i],u)}return o}function nP(t){return aF(t)?t:[]}function nM(t){return"function"==typeof t?t:sF}function nR(t,e){return aD(t)?t:iC(t,e)?[t]:iB(a9(t))}function nO(t,e,n){var i=t.length;return n=n===r?i:n,!e&&n>=i?t:nm(t,e,n)}var nT=t9||function(t){return t4.clearTimeout(t)};function nL(t,e){if(e)return t.slice();var r=t.length,n=tN?tN(r):new t.constructor(r);return t.copy(n),n}function nD(t){var e=new t.constructor(t.byteLength);return new tU(e).set(new tU(t)),e}function nj(t,e){var r=e?nD(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function nB(t,e){if(t!==e){var n=t!==r,i=null===t,a=t==t,s=aJ(t),o=e!==r,u=null===e,l=e==e,h=aJ(e);if(!u&&!h&&!s&&t>e||s&&o&&l&&!u&&!h||i&&o&&l||!n&&l||!a)return 1;if(!i&&!s&&!h&&t<e||h&&n&&a&&!i&&!s||u&&n&&a||!o&&a||!l)return -1}return 0}function nF(t,e,r,n){for(var i=-1,a=t.length,s=r.length,o=-1,u=e.length,l=e2(a-s,0),h=ty(u+l),c=!n;++o<u;)h[o]=e[o];for(;++i<s;)(c||i<a)&&(h[r[i]]=t[i]);for(;l--;)h[o++]=t[i++];return h}function nz(t,e,r,n){for(var i=-1,a=t.length,s=-1,o=r.length,u=-1,l=e.length,h=e2(a-o,0),c=ty(h+l),f=!n;++i<h;)c[i]=t[i];for(var d=i;++u<l;)c[d+u]=e[u];for(;++s<o;)(f||i<a)&&(c[d+r[s]]=t[i++]);return c}function nW(t,e){var r=-1,n=t.length;for(e||(e=ty(n));++r<n;)e[r]=t[r];return e}function nU(t,e,n,i){var a=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var u=e[s],l=i?i(n[u],t[u],u,n,t):r;l===r&&(l=t[u]),a?rR(n,u,l):rE(n,u,l)}return n}function nN(t,e){return function(r,n){var i=aD(r)?eu:rP,a=e?e():{};return i(r,t,ih(n,2),a)}}function nH(t){return nc(function(e,n){var i=-1,a=n.length,s=a>1?n[a-1]:r,o=a>2?n[2]:r;for(s=t.length>3&&"function"==typeof s?(a--,s):r,o&&i_(n[0],n[1],o)&&(s=a<3?r:s,a=1),e=tC(e);++i<a;){var u=n[i];u&&t(e,u,i,s)}return e})}function nV(t,e){return function(r,n){if(null==r)return r;if(!aB(r))return t(r,n);for(var i=r.length,a=e?i:-1,s=tC(r);(e?a--:++a<i)&&!1!==n(s[a],a,s););return r}}function n$(t){return function(e,r,n){for(var i=-1,a=tC(e),s=n(e),o=s.length;o--;){var u=s[t?o:++i];if(!1===r(a[u],u,a))break}return e}}function nX(t){return function(e){var n=eW(e=a9(e))?eX(e):r,i=n?n[0]:e.charAt(0),a=n?nO(n,1).join(""):e.slice(1);return i[t]()+a}}function nq(t){return function(e){return ev(sO(sx(e).replace(tV,"")),t,"")}}function nG(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=rm(t.prototype),n=t.apply(r,e);return a$(n)?n:r}}function nZ(t){return function(e,n,i){var a=tC(e);if(!aB(e)){var s=ih(n,3);e=sf(e),n=function(t){return s(a[t],t,a)}}var o=t(e,n,i);return o>-1?a[s?e[o]:o]:r}}function nK(t){return ii(function(e){var n=e.length,a=n,s=rg.prototype.thru;for(t&&e.reverse();a--;){var o=e[a];if("function"!=typeof o)throw new tS(i);if(s&&!u&&"wrapper"==iu(o))var u=new rg([],!0)}for(a=u?a:n;++a<n;){var l=iu(o=e[a]),h="wrapper"==l?io(o):r;u=h&&ix(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?u[iu(h[0])].apply(u,h[3]):1==o.length&&ix(o)?u[l]():u.thru(o)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&aD(r))return u.plant(r).value();for(var i=0,a=n?e[i].apply(this,t):r;++i<n;)a=e[i].call(this,a);return a}})}function nY(t,e,n,i,a,s,o,u,l,h){var c=128&e,f=1&e,d=2&e,p=24&e,m=512&e,v=d?r:nG(t);return function g(){for(var y=arguments.length,b=ty(y),w=y;w--;)b[w]=arguments[w];if(p)var k=il(g),_=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}(b,k);if(i&&(b=nF(b,i,a,p)),s&&(b=nz(b,s,o,p)),y-=_,p&&y<h){var C=eH(b,k);return n3(t,e,nY,g.placeholder,n,b,C,u,l,h-y)}var x=f?n:this,A=d?x[t]:t;return y=b.length,u?b=function(t,e){for(var n=t.length,i=e6(e.length,n),a=nW(t);i--;){var s=e[i];t[i]=ik(s,n)?a[s]:r}return t}(b,u):m&&y>1&&b.reverse(),c&&l<y&&(b.length=l),this&&this!==t4&&this instanceof g&&(A=v||nG(A)),A.apply(x,b)}}function nQ(t,e){return function(r,n){var i,a;return i=e(n),a={},rX(r,function(e,r,n){t(a,i(e),r,n)}),a}}function nJ(t,e){return function(n,i){var a;if(n===r&&i===r)return e;if(n!==r&&(a=n),i!==r){if(a===r)return i;"string"==typeof n||"string"==typeof i?(n=nk(n),i=nk(i)):(n=nw(n),i=nw(i)),a=t(n,i)}return a}}function n0(t){return ii(function(e){return e=ep(e,eO(ih())),nc(function(r){var n=this;return t(e,function(t){return eo(t,n,r)})})})}function n1(t,e){var n=(e=e===r?" ":nk(e)).length;if(n<2)return n?nh(e,t):e;var i=nh(e,eE(t/e$(e)));return eW(e)?nO(eX(i),0,t).join(""):i.slice(0,t)}function n2(t){return function(e,n,i){return i&&"number"!=typeof i&&i_(e,n,i)&&(n=i=r),e=a3(e),n===r?(n=e,e=0):n=a3(n),i=i===r?e<n?1:-1:a3(i),function(t,e,r,n){for(var i=-1,a=e2(eE((e-t)/(r||1)),0),s=ty(a);a--;)s[n?a:++i]=t,t+=r;return s}(e,n,i,t)}}function n6(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=a8(e),r=a8(r)),t(e,r)}}function n3(t,e,n,i,a,s,o,u,l,h){var c=8&e,f=c?o:r,d=c?r:o,p=c?s:r,m=c?r:s;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var v=[t,e,a,p,f,m,d,u,l,h],g=n.apply(r,v);return ix(t)&&iR(g,v),g.placeholder=i,iL(g,t,e)}function n4(t){var e=t_[t];return function(t,r){if(t=a8(t),(r=null==r?0:e6(a4(r),292))&&eJ(t)){var n=(a9(t)+"e").split("e");return+((n=(a9(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}var n7=re&&1/eV(new re([,-0]))[1]==o?function(t){return new re(t)}:sH;function n8(t){return function(e){var r,n,i=ig(e);return i==g?eU(e):i==_?(r=-1,n=Array(e.size),e.forEach(function(t){n[++r]=[t,t]}),n):ep(t(e),function(t){return[t,e[t]]})}}function n5(t,e,n,a,o,u,l,h){var c=2&e;if(!c&&"function"!=typeof t)throw new tS(i);var f=a?a.length:0;if(f||(e&=-97,a=o=r),l=l===r?l:e2(a4(l),0),h=h===r?h:a4(h),f-=o?o.length:0,64&e){var d=a,p=o;a=o=r}var m=c?r:io(t),v=[t,e,n,a,o,d,p,u,l,h];if(m&&function(t,e){var r=t[1],n=e[1],i=r|n,a=i<131,o=128==n&&8==r||128==n&&256==r&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==r;if(a||o){1&n&&(t[2]=e[2],i|=1&r?0:4);var u=e[3];if(u){var l=t[3];t[3]=l?nF(l,u,e[4]):u,t[4]=l?eH(t[3],s):e[4]}(u=e[5])&&(l=t[5],t[5]=l?nz(l,u,e[6]):u,t[6]=l?eH(t[5],s):e[6]),(u=e[7])&&(t[7]=u),128&n&&(t[8]=null==t[8]?e[8]:e6(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}}(v,m),t=v[0],e=v[1],n=v[2],a=v[3],o=v[4],(h=v[9]=v[9]===r?c?0:t.length:e2(v[9]-f,0))||!(24&e)||(e&=-25),e&&1!=e)8==e||16==e?(g=t,y=e,b=h,w=nG(g),O=function t(){for(var e=arguments.length,n=ty(e),i=e,a=il(t);i--;)n[i]=arguments[i];var s=e<3&&n[0]!==a&&n[e-1]!==a?[]:eH(n,a);return(e-=s.length)<b?n3(g,y,nY,t.placeholder,r,n,s,r,r,b-e):eo(this&&this!==t4&&this instanceof t?w:g,this,n)}):32!=e&&33!=e||o.length?O=nY.apply(r,v):(k=t,_=e,C=n,x=a,A=1&_,S=nG(k),O=function t(){for(var e=-1,r=arguments.length,n=-1,i=x.length,a=ty(i+r),s=this&&this!==t4&&this instanceof t?S:k;++n<i;)a[n]=x[n];for(;r--;)a[n++]=arguments[++e];return eo(s,A?C:this,a)});else var g,y,b,w,k,_,C,x,A,S,E,I,P,M,R,O=(E=t,I=e,P=n,M=1&I,R=nG(E),function t(){return(this&&this!==t4&&this instanceof t?R:E).apply(M?P:this,arguments)});return iL((m?nd:iR)(O,v),t,e)}function n9(t,e,n,i){return t===r||aR(t,tP[n])&&!tO.call(i,n)?e:t}function it(t,e,n,i,a,s){return a$(t)&&a$(e)&&(s.set(e,t),nn(t,e,r,it,s),s.delete(e)),t}function ie(t){return aZ(t)?r:t}function ir(t,e,n,i,a,s){var o=1&n,u=t.length,l=e.length;if(u!=l&&!(o&&l>u))return!1;var h=s.get(t),c=s.get(e);if(h&&c)return h==e&&c==t;var f=-1,d=!0,p=2&n?new r_:r;for(s.set(t,e),s.set(e,t);++f<u;){var m=t[f],v=e[f];if(i)var g=o?i(v,m,f,e,t,s):i(m,v,f,t,e,s);if(g!==r){if(g)continue;d=!1;break}if(p){if(!ey(e,function(t,e){if(!eL(p,e)&&(m===t||a(m,t,n,i,s)))return p.push(e)})){d=!1;break}}else if(!(m===v||a(m,v,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}function ii(t){return iT(iI(t,r,iX),t+"")}function ia(t){return rK(t,sf,im)}function is(t){return rK(t,sd,iv)}var io=ri?function(t){return ri.get(t)}:sH;function iu(t){for(var e=t.name+"",r=ra[e],n=tO.call(ra,e)?r.length:0;n--;){var i=r[n],a=i.func;if(null==a||a==t)return i.name}return e}function il(t){return(tO.call(rp,"placeholder")?rp:t).placeholder}function ih(){var t=rp.iteratee||sz;return t=t===sz?r8:t,arguments.length?t(arguments[0],arguments[1]):t}function ic(t,e){var r,n=t.__data__;return("string"==(r=typeof e)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==e:null===e)?n["string"==typeof e?"string":"hash"]:n.map}function id(t){for(var e=sf(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,i==i&&!a$(i)]}return e}function ip(t,e){var n=null==t?r:t[e];return r7(n)?n:r}var im=eY?function(t){return null==t?[]:ec(eY(t=tC(t)),function(e){return tG.call(t,e)})}:sK,iv=eY?function(t){for(var e=[];t;)em(e,im(t)),t=tH(t);return e}:sK,ig=rY;function iy(t,e,r){e=nR(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=iF(e[n]);if(!(a=null!=t&&r(t,s)))break;t=t[s]}return a||++n!=i?a:!!(i=null==t?0:t.length)&&aV(i)&&ik(s,i)&&(aD(t)||aL(t))}function ib(t){return"function"!=typeof t.constructor||iS(t)?{}:rm(tH(t))}function iw(t){return aD(t)||aL(t)||!!(t6&&t&&t[t6])}function ik(t,e){var r=typeof t;return!!(e=null==e?0x1fffffffffffff:e)&&("number"==r||"symbol"!=r&&tf.test(t))&&t>-1&&t%1==0&&t<e}function i_(t,e,r){if(!a$(r))return!1;var n=typeof e;return("number"==n?!!(aB(r)&&ik(e,r.length)):"string"==n&&e in r)&&aR(r[e],t)}function iC(t,e){if(aD(t))return!1;var r=typeof t;return!!("number"==r||"symbol"==r||"boolean"==r||null==t||aJ(t))||G.test(t)||!q.test(t)||null!=e&&t in tC(e)}function ix(t){var e=iu(t),r=rp[e];if("function"!=typeof r||!(e in ry.prototype))return!1;if(t===r)return!0;var n=io(r);return!!n&&t===n[0]}(e5&&ig(new e5(new ArrayBuffer(1)))!=E||e9&&ig(new e9)!=g||rt&&ig(rt.resolve())!=w||re&&ig(new re)!=_||rr&&ig(new rr)!=A)&&(ig=function(t){var e=rY(t),n=e==b?t.constructor:r,i=n?iz(n):"";if(i)switch(i){case rs:return E;case ro:return g;case ru:return w;case rl:return _;case rh:return A}return e});var iA=tM?aN:sY;function iS(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||tP)}function iE(t,e){return function(n){return null!=n&&n[t]===e&&(e!==r||t in tC(n))}}function iI(t,e,n){return e=e2(e===r?t.length-1:e,0),function(){for(var r=arguments,i=-1,a=e2(r.length-e,0),s=ty(a);++i<a;)s[i]=r[e+i];i=-1;for(var o=ty(e+1);++i<e;)o[i]=r[i];return o[e]=n(s),eo(t,this,o)}}function iP(t,e){return e.length<2?t:rZ(t,nm(e,0,-1))}function iM(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var iR=iD(nd),iO=eb||function(t,e){return t4.setTimeout(t,e)},iT=iD(np);function iL(t,e,r){var n,i,a=e+"";return iT(t,function(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(tt,"{\n/* [wrapped with "+e+"] */\n")}(a,(n=(i=a.match(te))?i[1].split(tr):[],el(l,function(t){var e="_."+t[0];r&t[1]&&!ef(n,e)&&n.push(e)}),n.sort())))}function iD(t){var e=0,n=0;return function(){var i=e3(),a=16-(i-n);if(n=i,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(r,arguments)}}function ij(t,e){var n=-1,i=t.length,a=i-1;for(e=e===r?i:e;++n<e;){var s=nl(n,a),o=t[s];t[s]=t[n],t[n]=o}return t.length=e,t}var iB=(tv=(J=aA(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Z,function(t,r,n,i){e.push(n?i.replace(ta,"$1"):r||t)}),e},function(t){return 500===tv.size&&tv.clear(),t})).cache,J);function iF(t){if("string"==typeof t||aJ(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}function iz(t){if(null!=t){try{return tR.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function iW(t){if(t instanceof ry)return t.clone();var e=new rg(t.__wrapped__,t.__chain__);return e.__actions__=nW(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var iU=nc(function(t,e){return aF(t)?rB(t,rH(e,1,aF,!0)):[]}),iN=nc(function(t,e){var n=iY(e);return aF(n)&&(n=r),aF(t)?rB(t,rH(e,1,aF,!0),ih(n,2)):[]}),iH=nc(function(t,e){var n=iY(e);return aF(n)&&(n=r),aF(t)?rB(t,rH(e,1,aF,!0),r,n):[]});function iV(t,e,r){var n=null==t?0:t.length;if(!n)return -1;var i=null==r?0:a4(r);return i<0&&(i=e2(n+i,0)),ek(t,ih(e,3),i)}function i$(t,e,n){var i=null==t?0:t.length;if(!i)return -1;var a=i-1;return n!==r&&(a=a4(n),a=n<0?e2(i+a,0):e6(a,i-1)),ek(t,ih(e,3),a,!0)}function iX(t){return(null==t?0:t.length)?rH(t,1):[]}function iq(t){return t&&t.length?t[0]:r}var iG=nc(function(t){var e=ep(t,nP);return e.length&&e[0]===t[0]?r1(e):[]}),iZ=nc(function(t){var e=iY(t),n=ep(t,nP);return e===iY(n)?e=r:n.pop(),n.length&&n[0]===t[0]?r1(n,ih(e,2)):[]}),iK=nc(function(t){var e=iY(t),n=ep(t,nP);return(e="function"==typeof e?e:r)&&n.pop(),n.length&&n[0]===t[0]?r1(n,r,e):[]});function iY(t){var e=null==t?0:t.length;return e?t[e-1]:r}var iQ=nc(iJ);function iJ(t,e){return t&&t.length&&e&&e.length?no(t,e):t}var i0=ii(function(t,e){var r=null==t?0:t.length,n=rO(t,e);return nu(t,ep(e,function(t){return ik(t,r)?+t:t}).sort(nB)),n});function i1(t){return null==t?t:e8.call(t)}var i2=nc(function(t){return n_(rH(t,1,aF,!0))}),i6=nc(function(t){var e=iY(t);return aF(e)&&(e=r),n_(rH(t,1,aF,!0),ih(e,2))}),i3=nc(function(t){var e=iY(t);return e="function"==typeof e?e:r,n_(rH(t,1,aF,!0),r,e)});function i4(t){if(!(t&&t.length))return[];var e=0;return t=ec(t,function(t){if(aF(t))return e=e2(t.length,e),!0}),eM(e,function(e){return ep(t,eS(e))})}function i7(t,e){if(!(t&&t.length))return[];var n=i4(t);return null==e?n:ep(n,function(t){return eo(e,r,t)})}var i8=nc(function(t,e){return aF(t)?rB(t,e):[]}),i5=nc(function(t){return nE(ec(t,aF))}),i9=nc(function(t){var e=iY(t);return aF(e)&&(e=r),nE(ec(t,aF),ih(e,2))}),at=nc(function(t){var e=iY(t);return e="function"==typeof e?e:r,nE(ec(t,aF),r,e)}),ae=nc(i4),ar=nc(function(t){var e=t.length,n=e>1?t[e-1]:r;return n="function"==typeof n?(t.pop(),n):r,i7(t,n)});function an(t){var e=rp(t);return e.__chain__=!0,e}function ai(t,e){return e(t)}var aa=ii(function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,a=function(e){return rO(e,t)};return!(e>1)&&!this.__actions__.length&&i instanceof ry&&ik(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:ai,args:[a],thisArg:r}),new rg(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(r),t})):this.thru(a)}),as=nN(function(t,e,r){tO.call(t,r)?++t[r]:rR(t,r,1)}),ao=nZ(iV),au=nZ(i$);function al(t,e){return(aD(t)?el:rF)(t,ih(e,3))}function ah(t,e){return(aD(t)?function(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}:rz)(t,ih(e,3))}var ac=nN(function(t,e,r){tO.call(t,r)?t[r].push(e):rR(t,r,[e])}),af=nc(function(t,e,r){var n=-1,i="function"==typeof e,a=aB(t)?ty(t.length):[];return rF(t,function(t){a[++n]=i?eo(e,t,r):r2(t,e,r)}),a}),ad=nN(function(t,e,r){rR(t,r,e)});function ap(t,e){return(aD(t)?ep:nt)(t,ih(e,3))}var am=nN(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]}),av=nc(function(t,e){if(null==t)return[];var r=e.length;return r>1&&i_(t,e[0],e[1])?e=[]:r>2&&i_(e[0],e[1],e[2])&&(e=[e[0]]),na(t,rH(e,1),[])}),ag=et||function(){return t4.Date.now()};function ay(t,e,n){return e=n?r:e,e=t&&null==e?t.length:e,n5(t,128,r,r,r,r,e)}function ab(t,e){var n;if("function"!=typeof e)throw new tS(i);return t=a4(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=r),n}}var aw=nc(function(t,e,r){var n=1;if(r.length){var i=eH(r,il(aw));n|=32}return n5(t,n,e,r,i)}),ak=nc(function(t,e,r){var n=3;if(r.length){var i=eH(r,il(ak));n|=32}return n5(e,n,t,r,i)});function a_(t,e,n){var a,s,o,u,l,h,c=0,f=!1,d=!1,p=!0;if("function"!=typeof t)throw new tS(i);function m(e){var n=a,i=s;return a=s=r,c=e,u=t.apply(i,n)}function v(t){var n=t-h,i=t-c;return h===r||n>=e||n<0||d&&i>=o}function g(){var t,r,n,i=ag();if(v(i))return y(i);l=iO(g,(t=i-h,r=i-c,n=e-t,d?e6(n,o-r):n))}function y(t){return(l=r,p&&a)?m(t):(a=s=r,u)}function b(){var t,n=ag(),i=v(n);if(a=arguments,s=this,h=n,i){if(l===r)return c=t=h,l=iO(g,e),f?m(t):u;if(d)return nT(l),l=iO(g,e),m(h)}return l===r&&(l=iO(g,e)),u}return e=a8(e)||0,a$(n)&&(f=!!n.leading,o=(d="maxWait"in n)?e2(a8(n.maxWait)||0,e):o,p="trailing"in n?!!n.trailing:p),b.cancel=function(){l!==r&&nT(l),c=0,a=h=s=l=r},b.flush=function(){return l===r?u:y(ag())},b}var aC=nc(function(t,e){return rj(t,1,e)}),ax=nc(function(t,e,r){return rj(t,a8(e)||0,r)});function aA(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new tS(i);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(aA.Cache||rk),r}function aS(t){if("function"!=typeof t)throw new tS(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}aA.Cache=rk;var aE=nc(function(t,e){var r=(e=1==e.length&&aD(e[0])?ep(e[0],eO(ih())):ep(rH(e,1),eO(ih()))).length;return nc(function(n){for(var i=-1,a=e6(n.length,r);++i<a;)n[i]=e[i].call(this,n[i]);return eo(t,this,n)})}),aI=nc(function(t,e){var n=eH(e,il(aI));return n5(t,32,r,e,n)}),aP=nc(function(t,e){var n=eH(e,il(aP));return n5(t,64,r,e,n)}),aM=ii(function(t,e){return n5(t,256,r,r,r,e)});function aR(t,e){return t===e||t!=t&&e!=e}var aO=n6(rQ),aT=n6(function(t,e){return t>=e}),aL=r6(function(){return arguments}())?r6:function(t){return aX(t)&&tO.call(t,"callee")&&!tG.call(t,"callee")},aD=ty.isArray,aj=ee?eO(ee):function(t){return aX(t)&&rY(t)==S};function aB(t){return null!=t&&aV(t.length)&&!aN(t)}function aF(t){return aX(t)&&aB(t)}var az=eQ||sY,aW=er?eO(er):function(t){return aX(t)&&rY(t)==d};function aU(t){if(!aX(t))return!1;var e=rY(t);return e==p||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!aZ(t)}function aN(t){if(!a$(t))return!1;var e=rY(t);return e==m||e==v||"[object AsyncFunction]"==e||"[object Proxy]"==e}function aH(t){return"number"==typeof t&&t==a4(t)}function aV(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=0x1fffffffffffff}function a$(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function aX(t){return null!=t&&"object"==typeof t}var aq=en?eO(en):function(t){return aX(t)&&ig(t)==g};function aG(t){return"number"==typeof t||aX(t)&&rY(t)==y}function aZ(t){if(!aX(t)||rY(t)!=b)return!1;var e=tH(t);if(null===e)return!0;var r=tO.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&tR.call(r)==tj}var aK=ei?eO(ei):function(t){return aX(t)&&rY(t)==k},aY=ea?eO(ea):function(t){return aX(t)&&ig(t)==_};function aQ(t){return"string"==typeof t||!aD(t)&&aX(t)&&rY(t)==C}function aJ(t){return"symbol"==typeof t||aX(t)&&rY(t)==x}var a0=es?eO(es):function(t){return aX(t)&&aV(t.length)&&!!tQ[rY(t)]},a1=n6(r9),a2=n6(function(t,e){return t<=e});function a6(t){if(!t)return[];if(aB(t))return aQ(t)?eX(t):nW(t);if(t3&&t[t3])return function(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}(t[t3]());var e=ig(t);return(e==g?eU:e==_?eV:sk)(t)}function a3(t){return t?(t=a8(t))===o||t===-o?(t<0?-1:1)*17976931348623157e292:t==t?t:0:0===t?t:0}function a4(t){var e=a3(t),r=e%1;return e==e?r?e-r:e:0}function a7(t){return t?rT(a4(t),0,0xffffffff):0}function a8(t){if("number"==typeof t)return t;if(aJ(t))return u;if(a$(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=a$(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=eR(t);var r=tl.test(t);return r||tc.test(t)?t2(t.slice(2),r?2:8):tu.test(t)?u:+t}function a5(t){return nU(t,sd(t))}function a9(t){return null==t?"":nk(t)}var st=nH(function(t,e){if(iS(e)||aB(e)){nU(e,sf(e),t);return}for(var r in e)tO.call(e,r)&&rE(t,r,e[r])}),se=nH(function(t,e){nU(e,sd(e),t)}),sr=nH(function(t,e,r,n){nU(e,sd(e),t,n)}),sn=nH(function(t,e,r,n){nU(e,sf(e),t,n)}),si=ii(rO),sa=nc(function(t,e){t=tC(t);var n=-1,i=e.length,a=i>2?e[2]:r;for(a&&i_(e[0],e[1],a)&&(i=1);++n<i;)for(var s=e[n],o=sd(s),u=-1,l=o.length;++u<l;){var h=o[u],c=t[h];(c===r||aR(c,tP[h])&&!tO.call(t,h))&&(t[h]=s[h])}return t}),ss=nc(function(t){return t.push(r,it),eo(sm,r,t)});function so(t,e,n){var i=null==t?r:rZ(t,e);return i===r?n:i}function su(t,e){return null!=t&&iy(t,e,r0)}var sl=nQ(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=tD.call(e)),t[e]=r},sD(sF)),sh=nQ(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=tD.call(e)),tO.call(t,e)?t[e].push(r):t[e]=[r]},ih),sc=nc(r2);function sf(t){return aB(t)?rx(t):r5(t)}function sd(t){return aB(t)?rx(t,!0):function(t){if(!a$(t))return function(t){var e=[];if(null!=t)for(var r in tC(t))e.push(r);return e}(t);var e=iS(t),r=[];for(var n in t)"constructor"==n&&(e||!tO.call(t,n))||r.push(n);return r}(t)}var sp=nH(function(t,e,r){nn(t,e,r)}),sm=nH(function(t,e,r,n){nn(t,e,r,n)}),sv=ii(function(t,e){var r={};if(null==t)return r;var n=!1;e=ep(e,function(e){return e=nR(e,t),n||(n=e.length>1),e}),nU(t,is(t),r),n&&(r=rL(r,7,ie));for(var i=e.length;i--;)nC(r,e[i]);return r}),sg=ii(function(t,e){return null==t?{}:ns(t,e,function(e,r){return su(t,r)})});function sy(t,e){if(null==t)return{};var r=ep(is(t),function(t){return[t]});return e=ih(e),ns(t,r,function(t,r){return e(t,r[0])})}var sb=n8(sf),sw=n8(sd);function sk(t){return null==t?[]:eT(t,sf(t))}var s_=nq(function(t,e,r){return e=e.toLowerCase(),t+(r?sC(e):e)});function sC(t){return sR(a9(t).toLowerCase())}function sx(t){return(t=a9(t))&&t.replace(td,eB).replace(t$,"")}var sA=nq(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),sS=nq(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()}),sE=nX("toLowerCase"),sI=nq(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()}),sP=nq(function(t,e,r){return t+(r?" ":"")+sR(e)}),sM=nq(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()}),sR=nX("toUpperCase");function sO(t,e,n){if(t=a9(t),(e=n?r:e)===r){var i;return(i=t,tZ.test(i))?t.match(tq)||[]:t.match(tn)||[]}return t.match(e)||[]}var sT=nc(function(t,e){try{return eo(t,r,e)}catch(t){return aU(t)?t:new tw(t)}}),sL=ii(function(t,e){return el(e,function(e){rR(t,e=iF(e),aw(t[e],t))}),t});function sD(t){return function(){return t}}var sj=nK(),sB=nK(!0);function sF(t){return t}function sz(t){return r8("function"==typeof t?t:rL(t,1))}var sW=nc(function(t,e){return function(r){return r2(r,t,e)}}),sU=nc(function(t,e){return function(r){return r2(t,r,e)}});function sN(t,e,r){var n=sf(e),i=rG(e,n);null!=r||a$(e)&&(i.length||!n.length)||(r=e,e=t,t=this,i=rG(e,sf(e)));var a=!(a$(r)&&"chain"in r)||!!r.chain,s=aN(t);return el(i,function(r){var n=e[r];t[r]=n,s&&(t.prototype[r]=function(){var e=this.__chain__;if(a||e){var r=t(this.__wrapped__);return(r.__actions__=nW(this.__actions__)).push({func:n,args:arguments,thisArg:t}),r.__chain__=e,r}return n.apply(t,em([this.value()],arguments))})}),t}function sH(){}var sV=n0(ep),s$=n0(eh),sX=n0(ey);function sq(t){return iC(t)?eS(iF(t)):function(e){return rZ(e,t)}}var sG=n2(),sZ=n2(!0);function sK(){return[]}function sY(){return!1}var sQ=nJ(function(t,e){return t+e},0),sJ=n4("ceil"),s0=nJ(function(t,e){return t/e},1),s1=n4("floor"),s2=nJ(function(t,e){return t*e},1),s6=n4("round"),s3=nJ(function(t,e){return t-e},0);return rp.after=function(t,e){if("function"!=typeof e)throw new tS(i);return t=a4(t),function(){if(--t<1)return e.apply(this,arguments)}},rp.ary=ay,rp.assign=st,rp.assignIn=se,rp.assignInWith=sr,rp.assignWith=sn,rp.at=si,rp.before=ab,rp.bind=aw,rp.bindAll=sL,rp.bindKey=ak,rp.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return aD(t)?t:[t]},rp.chain=an,rp.chunk=function(t,e,n){e=(n?i_(t,e,n):e===r)?1:e2(a4(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var a=0,s=0,o=ty(eE(i/e));a<i;)o[s++]=nm(t,a,a+=e);return o},rp.compact=function(t){for(var e=-1,r=null==t?0:t.length,n=0,i=[];++e<r;){var a=t[e];a&&(i[n++]=a)}return i},rp.concat=function(){var t=arguments.length;if(!t)return[];for(var e=ty(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return em(aD(r)?nW(r):[r],rH(e,1))},rp.cond=function(t){var e=null==t?0:t.length,r=ih();return t=e?ep(t,function(t){if("function"!=typeof t[1])throw new tS(i);return[r(t[0]),t[1]]}):[],nc(function(r){for(var n=-1;++n<e;){var i=t[n];if(eo(i[0],this,r))return eo(i[1],this,r)}})},rp.conforms=function(t){var e,r;return r=sf(e=rL(t,1)),function(t){return rD(t,e,r)}},rp.constant=sD,rp.countBy=as,rp.create=function(t,e){var r=rm(t);return null==e?r:rM(r,e)},rp.curry=function t(e,n,i){n=i?r:n;var a=n5(e,8,r,r,r,r,r,n);return a.placeholder=t.placeholder,a},rp.curryRight=function t(e,n,i){n=i?r:n;var a=n5(e,16,r,r,r,r,r,n);return a.placeholder=t.placeholder,a},rp.debounce=a_,rp.defaults=sa,rp.defaultsDeep=ss,rp.defer=aC,rp.delay=ax,rp.difference=iU,rp.differenceBy=iN,rp.differenceWith=iH,rp.drop=function(t,e,n){var i=null==t?0:t.length;return i?nm(t,(e=n||e===r?1:a4(e))<0?0:e,i):[]},rp.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?nm(t,0,(e=i-(e=n||e===r?1:a4(e)))<0?0:e):[]},rp.dropRightWhile=function(t,e){return t&&t.length?nA(t,ih(e,3),!0,!0):[]},rp.dropWhile=function(t,e){return t&&t.length?nA(t,ih(e,3),!0):[]},rp.fill=function(t,e,n,i){var a=null==t?0:t.length;return a?(n&&"number"!=typeof n&&i_(t,e,n)&&(n=0,i=a),function(t,e,n,i){var a=t.length;for((n=a4(n))<0&&(n=-n>a?0:a+n),(i=i===r||i>a?a:a4(i))<0&&(i+=a),i=n>i?0:a7(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},rp.filter=function(t,e){return(aD(t)?ec:rN)(t,ih(e,3))},rp.flatMap=function(t,e){return rH(ap(t,e),1)},rp.flatMapDeep=function(t,e){return rH(ap(t,e),o)},rp.flatMapDepth=function(t,e,n){return n=n===r?1:a4(n),rH(ap(t,e),n)},rp.flatten=iX,rp.flattenDeep=function(t){return(null==t?0:t.length)?rH(t,o):[]},rp.flattenDepth=function(t,e){return(null==t?0:t.length)?rH(t,e=e===r?1:a4(e)):[]},rp.flip=function(t){return n5(t,512)},rp.flow=sj,rp.flowRight=sB,rp.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,n={};++e<r;){var i=t[e];n[i[0]]=i[1]}return n},rp.functions=function(t){return null==t?[]:rG(t,sf(t))},rp.functionsIn=function(t){return null==t?[]:rG(t,sd(t))},rp.groupBy=ac,rp.initial=function(t){return(null==t?0:t.length)?nm(t,0,-1):[]},rp.intersection=iG,rp.intersectionBy=iZ,rp.intersectionWith=iK,rp.invert=sl,rp.invertBy=sh,rp.invokeMap=af,rp.iteratee=sz,rp.keyBy=ad,rp.keys=sf,rp.keysIn=sd,rp.map=ap,rp.mapKeys=function(t,e){var r={};return e=ih(e,3),rX(t,function(t,n,i){rR(r,e(t,n,i),t)}),r},rp.mapValues=function(t,e){var r={};return e=ih(e,3),rX(t,function(t,n,i){rR(r,n,e(t,n,i))}),r},rp.matches=function(t){return ne(rL(t,1))},rp.matchesProperty=function(t,e){return nr(t,rL(e,1))},rp.memoize=aA,rp.merge=sp,rp.mergeWith=sm,rp.method=sW,rp.methodOf=sU,rp.mixin=sN,rp.negate=aS,rp.nthArg=function(t){return t=a4(t),nc(function(e){return ni(e,t)})},rp.omit=sv,rp.omitBy=function(t,e){return sy(t,aS(ih(e)))},rp.once=function(t){return ab(2,t)},rp.orderBy=function(t,e,n,i){return null==t?[]:(aD(e)||(e=null==e?[]:[e]),aD(n=i?r:n)||(n=null==n?[]:[n]),na(t,e,n))},rp.over=sV,rp.overArgs=aE,rp.overEvery=s$,rp.overSome=sX,rp.partial=aI,rp.partialRight=aP,rp.partition=am,rp.pick=sg,rp.pickBy=sy,rp.property=sq,rp.propertyOf=function(t){return function(e){return null==t?r:rZ(t,e)}},rp.pull=iQ,rp.pullAll=iJ,rp.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?no(t,e,ih(r,2)):t},rp.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?no(t,e,r,n):t},rp.pullAt=i0,rp.range=sG,rp.rangeRight=sZ,rp.rearg=aM,rp.reject=function(t,e){return(aD(t)?ec:rN)(t,aS(ih(e,3)))},rp.remove=function(t,e){var r=[];if(!(t&&t.length))return r;var n=-1,i=[],a=t.length;for(e=ih(e,3);++n<a;){var s=t[n];e(s,n,t)&&(r.push(s),i.push(n))}return nu(t,i),r},rp.rest=function(t,e){if("function"!=typeof t)throw new tS(i);return nc(t,e=e===r?e:a4(e))},rp.reverse=i1,rp.sampleSize=function(t,e,n){return e=(n?i_(t,e,n):e===r)?1:a4(e),(aD(t)?function(t,e){return ij(nW(t),rT(e,0,t.length))}:function(t,e){var r=sk(t);return ij(r,rT(e,0,r.length))})(t,e)},rp.set=function(t,e,r){return null==t?t:nf(t,e,r)},rp.setWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:nf(t,e,n,i)},rp.shuffle=function(t){return(aD(t)?function(t){return ij(nW(t))}:function(t){return ij(sk(t))})(t)},rp.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&i_(t,e,n)?(e=0,n=i):(e=null==e?0:a4(e),n=n===r?i:a4(n)),nm(t,e,n)):[]},rp.sortBy=av,rp.sortedUniq=function(t){return t&&t.length?nb(t):[]},rp.sortedUniqBy=function(t,e){return t&&t.length?nb(t,ih(e,2)):[]},rp.split=function(t,e,n){return(n&&"number"!=typeof n&&i_(t,e,n)&&(e=n=r),n=n===r?0xffffffff:n>>>0)?(t=a9(t))&&("string"==typeof e||null!=e&&!aK(e))&&!(e=nk(e))&&eW(t)?nO(eX(t),0,n):t.split(e,n):[]},rp.spread=function(t,e){if("function"!=typeof t)throw new tS(i);return e=null==e?0:e2(a4(e),0),nc(function(r){var n=r[e],i=nO(r,0,e);return n&&em(i,n),eo(t,this,i)})},rp.tail=function(t){var e=null==t?0:t.length;return e?nm(t,1,e):[]},rp.take=function(t,e,n){return t&&t.length?nm(t,0,(e=n||e===r?1:a4(e))<0?0:e):[]},rp.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?nm(t,(e=i-(e=n||e===r?1:a4(e)))<0?0:e,i):[]},rp.takeRightWhile=function(t,e){return t&&t.length?nA(t,ih(e,3),!1,!0):[]},rp.takeWhile=function(t,e){return t&&t.length?nA(t,ih(e,3)):[]},rp.tap=function(t,e){return e(t),t},rp.throttle=function(t,e,r){var n=!0,a=!0;if("function"!=typeof t)throw new tS(i);return a$(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),a_(t,e,{leading:n,maxWait:e,trailing:a})},rp.thru=ai,rp.toArray=a6,rp.toPairs=sb,rp.toPairsIn=sw,rp.toPath=function(t){return aD(t)?ep(t,iF):aJ(t)?[t]:nW(iB(a9(t)))},rp.toPlainObject=a5,rp.transform=function(t,e,r){var n=aD(t),i=n||az(t)||a0(t);if(e=ih(e,4),null==r){var a=t&&t.constructor;r=i?n?new a:[]:a$(t)&&aN(a)?rm(tH(t)):{}}return(i?el:rX)(t,function(t,n,i){return e(r,t,n,i)}),r},rp.unary=function(t){return ay(t,1)},rp.union=i2,rp.unionBy=i6,rp.unionWith=i3,rp.uniq=function(t){return t&&t.length?n_(t):[]},rp.uniqBy=function(t,e){return t&&t.length?n_(t,ih(e,2)):[]},rp.uniqWith=function(t,e){return e="function"==typeof e?e:r,t&&t.length?n_(t,r,e):[]},rp.unset=function(t,e){return null==t||nC(t,e)},rp.unzip=i4,rp.unzipWith=i7,rp.update=function(t,e,r){return null==t?t:nx(t,e,nM(r))},rp.updateWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:nx(t,e,nM(n),i)},rp.values=sk,rp.valuesIn=function(t){return null==t?[]:eT(t,sd(t))},rp.without=i8,rp.words=sO,rp.wrap=function(t,e){return aI(nM(e),t)},rp.xor=i5,rp.xorBy=i9,rp.xorWith=at,rp.zip=ae,rp.zipObject=function(t,e){return nI(t||[],e||[],rE)},rp.zipObjectDeep=function(t,e){return nI(t||[],e||[],nf)},rp.zipWith=ar,rp.entries=sb,rp.entriesIn=sw,rp.extend=se,rp.extendWith=sr,sN(rp,rp),rp.add=sQ,rp.attempt=sT,rp.camelCase=s_,rp.capitalize=sC,rp.ceil=sJ,rp.clamp=function(t,e,n){return n===r&&(n=e,e=r),n!==r&&(n=(n=a8(n))==n?n:0),e!==r&&(e=(e=a8(e))==e?e:0),rT(a8(t),e,n)},rp.clone=function(t){return rL(t,4)},rp.cloneDeep=function(t){return rL(t,5)},rp.cloneDeepWith=function(t,e){return rL(t,5,e="function"==typeof e?e:r)},rp.cloneWith=function(t,e){return rL(t,4,e="function"==typeof e?e:r)},rp.conformsTo=function(t,e){return null==e||rD(t,e,sf(e))},rp.deburr=sx,rp.defaultTo=function(t,e){return null==t||t!=t?e:t},rp.divide=s0,rp.endsWith=function(t,e,n){t=a9(t),e=nk(e);var i=t.length,a=n=n===r?i:rT(a4(n),0,i);return(n-=e.length)>=0&&t.slice(n,a)==e},rp.eq=aR,rp.escape=function(t){return(t=a9(t))&&H.test(t)?t.replace(U,eF):t},rp.escapeRegExp=function(t){return(t=a9(t))&&Y.test(t)?t.replace(K,"\\$&"):t},rp.every=function(t,e,n){var i=aD(t)?eh:rW;return n&&i_(t,e,n)&&(e=r),i(t,ih(e,3))},rp.find=ao,rp.findIndex=iV,rp.findKey=function(t,e){return ew(t,ih(e,3),rX)},rp.findLast=au,rp.findLastIndex=i$,rp.findLastKey=function(t,e){return ew(t,ih(e,3),rq)},rp.floor=s1,rp.forEach=al,rp.forEachRight=ah,rp.forIn=function(t,e){return null==t?t:rV(t,ih(e,3),sd)},rp.forInRight=function(t,e){return null==t?t:r$(t,ih(e,3),sd)},rp.forOwn=function(t,e){return t&&rX(t,ih(e,3))},rp.forOwnRight=function(t,e){return t&&rq(t,ih(e,3))},rp.get=so,rp.gt=aO,rp.gte=aT,rp.has=function(t,e){return null!=t&&iy(t,e,rJ)},rp.hasIn=su,rp.head=iq,rp.identity=sF,rp.includes=function(t,e,r,n){t=aB(t)?t:sk(t),r=r&&!n?a4(r):0;var i=t.length;return r<0&&(r=e2(i+r,0)),aQ(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&e_(t,e,r)>-1},rp.indexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return -1;var i=null==r?0:a4(r);return i<0&&(i=e2(n+i,0)),e_(t,e,i)},rp.inRange=function(t,e,n){var i,a,s;return e=a3(e),n===r?(n=e,e=0):n=a3(n),(i=t=a8(t))>=e6(a=e,s=n)&&i<e2(a,s)},rp.invoke=sc,rp.isArguments=aL,rp.isArray=aD,rp.isArrayBuffer=aj,rp.isArrayLike=aB,rp.isArrayLikeObject=aF,rp.isBoolean=function(t){return!0===t||!1===t||aX(t)&&rY(t)==f},rp.isBuffer=az,rp.isDate=aW,rp.isElement=function(t){return aX(t)&&1===t.nodeType&&!aZ(t)},rp.isEmpty=function(t){if(null==t)return!0;if(aB(t)&&(aD(t)||"string"==typeof t||"function"==typeof t.splice||az(t)||a0(t)||aL(t)))return!t.length;var e=ig(t);if(e==g||e==_)return!t.size;if(iS(t))return!r5(t).length;for(var r in t)if(tO.call(t,r))return!1;return!0},rp.isEqual=function(t,e){return r3(t,e)},rp.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:r)?n(t,e):r;return i===r?r3(t,e,r,n):!!i},rp.isError=aU,rp.isFinite=function(t){return"number"==typeof t&&eJ(t)},rp.isFunction=aN,rp.isInteger=aH,rp.isLength=aV,rp.isMap=aq,rp.isMatch=function(t,e){return t===e||r4(t,e,id(e))},rp.isMatchWith=function(t,e,n){return n="function"==typeof n?n:r,r4(t,e,id(e),n)},rp.isNaN=function(t){return aG(t)&&t!=+t},rp.isNative=function(t){if(iA(t))throw new tw("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return r7(t)},rp.isNil=function(t){return null==t},rp.isNull=function(t){return null===t},rp.isNumber=aG,rp.isObject=a$,rp.isObjectLike=aX,rp.isPlainObject=aZ,rp.isRegExp=aK,rp.isSafeInteger=function(t){return aH(t)&&t>=-0x1fffffffffffff&&t<=0x1fffffffffffff},rp.isSet=aY,rp.isString=aQ,rp.isSymbol=aJ,rp.isTypedArray=a0,rp.isUndefined=function(t){return t===r},rp.isWeakMap=function(t){return aX(t)&&ig(t)==A},rp.isWeakSet=function(t){return aX(t)&&"[object WeakSet]"==rY(t)},rp.join=function(t,e){return null==t?"":e0.call(t,e)},rp.kebabCase=sA,rp.last=iY,rp.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return -1;var a=i;return n!==r&&(a=(a=a4(n))<0?e2(i+a,0):e6(a,i-1)),e==e?function(t,e,r){for(var n=r+1;n--&&t[n]!==e;);return n}(t,e,a):ek(t,ex,a,!0)},rp.lowerCase=sS,rp.lowerFirst=sE,rp.lt=a1,rp.lte=a2,rp.max=function(t){return t&&t.length?rU(t,sF,rQ):r},rp.maxBy=function(t,e){return t&&t.length?rU(t,ih(e,2),rQ):r},rp.mean=function(t){return eA(t,sF)},rp.meanBy=function(t,e){return eA(t,ih(e,2))},rp.min=function(t){return t&&t.length?rU(t,sF,r9):r},rp.minBy=function(t,e){return t&&t.length?rU(t,ih(e,2),r9):r},rp.stubArray=sK,rp.stubFalse=sY,rp.stubObject=function(){return{}},rp.stubString=function(){return""},rp.stubTrue=function(){return!0},rp.multiply=s2,rp.nth=function(t,e){return t&&t.length?ni(t,a4(e)):r},rp.noConflict=function(){return t4._===this&&(t4._=tB),this},rp.noop=sH,rp.now=ag,rp.pad=function(t,e,r){t=a9(t);var n=(e=a4(e))?e$(t):0;if(!e||n>=e)return t;var i=(e-n)/2;return n1(eK(i),r)+t+n1(eE(i),r)},rp.padEnd=function(t,e,r){t=a9(t);var n=(e=a4(e))?e$(t):0;return e&&n<e?t+n1(e-n,r):t},rp.padStart=function(t,e,r){t=a9(t);var n=(e=a4(e))?e$(t):0;return e&&n<e?n1(e-n,r)+t:t},rp.parseInt=function(t,e,r){return r||null==e?e=0:e&&(e=+e),e4(a9(t).replace(Q,""),e||0)},rp.random=function(t,e,n){if(n&&"boolean"!=typeof n&&i_(t,e,n)&&(e=n=r),n===r&&("boolean"==typeof e?(n=e,e=r):"boolean"==typeof t&&(n=t,t=r)),t===r&&e===r?(t=0,e=1):(t=a3(t),e===r?(e=t,t=0):e=a3(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var a=e7();return e6(t+a*(e-t+t1("1e-"+((a+"").length-1))),e)}return nl(t,e)},rp.reduce=function(t,e,r){var n=aD(t)?ev:eI,i=arguments.length<3;return n(t,ih(e,4),r,i,rF)},rp.reduceRight=function(t,e,r){var n=aD(t)?eg:eI,i=arguments.length<3;return n(t,ih(e,4),r,i,rz)},rp.repeat=function(t,e,n){return e=(n?i_(t,e,n):e===r)?1:a4(e),nh(a9(t),e)},rp.replace=function(){var t=arguments,e=a9(t[0]);return t.length<3?e:e.replace(t[1],t[2])},rp.result=function(t,e,n){e=nR(e,t);var i=-1,a=e.length;for(a||(a=1,t=r);++i<a;){var s=null==t?r:t[iF(e[i])];s===r&&(i=a,s=n),t=aN(s)?s.call(t):s}return t},rp.round=s6,rp.runInContext=t,rp.sample=function(t){return(aD(t)?rA:function(t){return rA(sk(t))})(t)},rp.size=function(t){if(null==t)return 0;if(aB(t))return aQ(t)?e$(t):t.length;var e=ig(t);return e==g||e==_?t.size:r5(t).length},rp.snakeCase=sI,rp.some=function(t,e,n){var i=aD(t)?ey:nv;return n&&i_(t,e,n)&&(e=r),i(t,ih(e,3))},rp.sortedIndex=function(t,e){return ng(t,e)},rp.sortedIndexBy=function(t,e,r){return ny(t,e,ih(r,2))},rp.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var n=ng(t,e);if(n<r&&aR(t[n],e))return n}return -1},rp.sortedLastIndex=function(t,e){return ng(t,e,!0)},rp.sortedLastIndexBy=function(t,e,r){return ny(t,e,ih(r,2),!0)},rp.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var r=ng(t,e,!0)-1;if(aR(t[r],e))return r}return -1},rp.startCase=sP,rp.startsWith=function(t,e,r){return t=a9(t),r=null==r?0:rT(a4(r),0,t.length),e=nk(e),t.slice(r,r+e.length)==e},rp.subtract=s3,rp.sum=function(t){return t&&t.length?eP(t,sF):0},rp.sumBy=function(t,e){return t&&t.length?eP(t,ih(e,2)):0},rp.template=function(t,e,n){var i=rp.templateSettings;n&&i_(t,e,n)&&(e=r),t=a9(t),e=sr({},e,i,n9);var a,s,o=sr({},e.imports,i.imports,n9),u=sf(o),l=eT(o,u),h=0,c=e.interpolate||tp,f="__p += '",d=tx((e.escape||tp).source+"|"+c.source+"|"+(c===X?ts:tp).source+"|"+(e.evaluate||tp).source+"|$","g"),p="//# sourceURL="+(tO.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++tY+"]")+"\n";t.replace(d,function(e,r,n,i,o,u){return n||(n=i),f+=t.slice(h,u).replace(tm,ez),r&&(a=!0,f+="' +\n__e("+r+") +\n'"),o&&(s=!0,f+="';\n"+o+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),h=u+e.length,e}),f+="';\n";var m=tO.call(e,"variable")&&e.variable;if(m){if(ti.test(m))throw new tw("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(s?f.replace(B,""):f).replace(F,"$1").replace(z,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=sT(function(){return tk(u,p+"return "+f).apply(r,l)});if(v.source=f,aU(v))throw v;return v},rp.times=function(t,e){if((t=a4(t))<1||t>0x1fffffffffffff)return[];var r=0xffffffff,n=e6(t,0xffffffff);e=ih(e),t-=0xffffffff;for(var i=eM(n,e);++r<t;)e(r);return i},rp.toFinite=a3,rp.toInteger=a4,rp.toLength=a7,rp.toLower=function(t){return a9(t).toLowerCase()},rp.toNumber=a8,rp.toSafeInteger=function(t){return t?rT(a4(t),-0x1fffffffffffff,0x1fffffffffffff):0===t?t:0},rp.toString=a9,rp.toUpper=function(t){return a9(t).toUpperCase()},rp.trim=function(t,e,n){if((t=a9(t))&&(n||e===r))return eR(t);if(!t||!(e=nk(e)))return t;var i=eX(t),a=eX(e),s=eD(i,a),o=ej(i,a)+1;return nO(i,s,o).join("")},rp.trimEnd=function(t,e,n){if((t=a9(t))&&(n||e===r))return t.slice(0,eq(t)+1);if(!t||!(e=nk(e)))return t;var i=eX(t),a=ej(i,eX(e))+1;return nO(i,0,a).join("")},rp.trimStart=function(t,e,n){if((t=a9(t))&&(n||e===r))return t.replace(Q,"");if(!t||!(e=nk(e)))return t;var i=eX(t),a=eD(i,eX(e));return nO(i,a).join("")},rp.truncate=function(t,e){var n=30,i="...";if(a$(e)){var a="separator"in e?e.separator:a;n="length"in e?a4(e.length):n,i="omission"in e?nk(e.omission):i}var s=(t=a9(t)).length;if(eW(t)){var o=eX(t);s=o.length}if(n>=s)return t;var u=n-e$(i);if(u<1)return i;var l=o?nO(o,0,u).join(""):t.slice(0,u);if(a===r)return l+i;if(o&&(u+=l.length-u),aK(a)){if(t.slice(u).search(a)){var h,c=l;for(a.global||(a=tx(a.source,a9(to.exec(a))+"g")),a.lastIndex=0;h=a.exec(c);)var f=h.index;l=l.slice(0,f===r?u:f)}}else if(t.indexOf(nk(a),u)!=u){var d=l.lastIndexOf(a);d>-1&&(l=l.slice(0,d))}return l+i},rp.unescape=function(t){return(t=a9(t))&&N.test(t)?t.replace(W,eG):t},rp.uniqueId=function(t){var e=++tT;return a9(t)+e},rp.upperCase=sM,rp.upperFirst=sR,rp.each=al,rp.eachRight=ah,rp.first=iq,sN(rp,(tg={},rX(rp,function(t,e){tO.call(rp.prototype,e)||(tg[e]=t)}),tg),{chain:!1}),rp.VERSION="4.17.21",el(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){rp[t].placeholder=rp}),el(["drop","take"],function(t,e){ry.prototype[t]=function(n){n=n===r?1:e2(a4(n),0);var i=this.__filtered__&&!e?new ry(this):this.clone();return i.__filtered__?i.__takeCount__=e6(n,i.__takeCount__):i.__views__.push({size:e6(n,0xffffffff),type:t+(i.__dir__<0?"Right":"")}),i},ry.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),el(["filter","map","takeWhile"],function(t,e){var r=e+1,n=1==r||3==r;ry.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ih(t,3),type:r}),e.__filtered__=e.__filtered__||n,e}}),el(["head","last"],function(t,e){var r="take"+(e?"Right":"");ry.prototype[t]=function(){return this[r](1).value()[0]}}),el(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");ry.prototype[t]=function(){return this.__filtered__?new ry(this):this[r](1)}}),ry.prototype.compact=function(){return this.filter(sF)},ry.prototype.find=function(t){return this.filter(t).head()},ry.prototype.findLast=function(t){return this.reverse().find(t)},ry.prototype.invokeMap=nc(function(t,e){return"function"==typeof t?new ry(this):this.map(function(r){return r2(r,t,e)})}),ry.prototype.reject=function(t){return this.filter(aS(ih(t)))},ry.prototype.slice=function(t,e){t=a4(t);var n=this;return n.__filtered__&&(t>0||e<0)?new ry(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==r&&(n=(e=a4(e))<0?n.dropRight(-e):n.take(e-t)),n)},ry.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},ry.prototype.toArray=function(){return this.take(0xffffffff)},rX(ry.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),a=rp[i?"take"+("last"==e?"Right":""):e],s=i||/^find/.test(e);a&&(rp.prototype[e]=function(){var e=this.__wrapped__,o=i?[1]:arguments,u=e instanceof ry,l=o[0],h=u||aD(e),c=function(t){var e=a.apply(rp,em([t],o));return i&&f?e[0]:e};h&&n&&"function"==typeof l&&1!=l.length&&(u=h=!1);var f=this.__chain__,d=!!this.__actions__.length,p=s&&!f,m=u&&!d;if(!s&&h){e=m?e:new ry(this);var v=t.apply(e,o);return v.__actions__.push({func:ai,args:[c],thisArg:r}),new rg(v,f)}return p&&m?t.apply(this,o):(v=this.thru(c),p?i?v.value()[0]:v.value():v)})}),el(["pop","push","shift","sort","splice","unshift"],function(t){var e=tE[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);rp.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var i=this.value();return e.apply(aD(i)?i:[],t)}return this[r](function(r){return e.apply(aD(r)?r:[],t)})}}),rX(ry.prototype,function(t,e){var r=rp[e];if(r){var n=r.name+"";tO.call(ra,n)||(ra[n]=[]),ra[n].push({name:e,func:r})}}),ra[nY(r,2).name]=[{name:"wrapper",func:r}],ry.prototype.clone=function(){var t=new ry(this.__wrapped__);return t.__actions__=nW(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=nW(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=nW(this.__views__),t},ry.prototype.reverse=function(){if(this.__filtered__){var t=new ry(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t},ry.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=aD(t),n=e<0,i=r?t.length:0,a=function(t,e,r){for(var n=-1,i=r.length;++n<i;){var a=r[n],s=a.size;switch(a.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=e6(e,t+s);break;case"takeRight":t=e2(t,e-s)}}return{start:t,end:e}}(0,i,this.__views__),s=a.start,o=a.end,u=o-s,l=n?o:s-1,h=this.__iteratees__,c=h.length,f=0,d=e6(u,this.__takeCount__);if(!r||!n&&i==u&&d==u)return nS(t,this.__actions__);var p=[];t:for(;u--&&f<d;){for(var m=-1,v=t[l+=e];++m<c;){var g=h[m],y=g.iteratee,b=g.type,w=y(v);if(2==b)v=w;else if(!w){if(1==b)continue t;break t}}p[f++]=v}return p},rp.prototype.at=aa,rp.prototype.chain=function(){return an(this)},rp.prototype.commit=function(){return new rg(this.value(),this.__chain__)},rp.prototype.next=function(){this.__values__===r&&(this.__values__=a6(this.value()));var t=this.__index__>=this.__values__.length,e=t?r:this.__values__[this.__index__++];return{done:t,value:e}},rp.prototype.plant=function(t){for(var e,n=this;n instanceof rv;){var i=iW(n);i.__index__=0,i.__values__=r,e?a.__wrapped__=i:e=i;var a=i;n=n.__wrapped__}return a.__wrapped__=t,e},rp.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof ry){var e=t;return this.__actions__.length&&(e=new ry(this)),(e=e.reverse()).__actions__.push({func:ai,args:[i1],thisArg:r}),new rg(e,this.__chain__)}return this.thru(i1)},rp.prototype.toJSON=rp.prototype.valueOf=rp.prototype.value=function(){return nS(this.__wrapped__,this.__actions__)},rp.prototype.first=rp.prototype.head,t3&&(rp.prototype[t3]=function(){return this}),rp}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t4._=eZ,define(function(){return eZ})):t8?((t8.exports=eZ)._=eZ,t7._=eZ):t4._=eZ}).call(this)});var u={};self,t={"./src/drawer.canvasentry.js":/*!***********************************!*\
  !*** ./src/drawer.canvasentry.js ***!
  \***********************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(/*! ./util/style */"./src/util/style.js")),i=a(r(/*! ./util/get-id */"./src/util/get-id.js"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=/*#__PURE__*/function(){var t;function e(){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,i.default)(void 0!==this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_"),this.canvasContextAttributes={}}return t=[{key:"initWave",value:function(t){this.wave=t,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(t){this.progress=t,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(t,e,r,i){this.start=this.wave.offsetLeft/e||0,this.end=this.start+t/e,this.wave.width=r,this.wave.height=i;var a={width:t+"px"};(0,n.default)(this.wave,a),this.hasProgressCanvas&&(this.progress.width=r,this.progress.height=i,(0,n.default)(this.progress,a))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(t,e){this.waveCtx.fillStyle=this.getFillStyle(this.waveCtx,t),this.hasProgressCanvas&&(this.progressCtx.fillStyle=this.getFillStyle(this.progressCtx,e))}},{key:"getFillStyle",value:function(t,e){if("string"==typeof e||e instanceof CanvasGradient)return e;var r=t.createLinearGradient(0,0,0,t.canvas.height);return e.forEach(function(t,n){return r.addColorStop(n/e.length,t)}),r}},{key:"applyCanvasTransforms",value:function(t){t&&(this.waveCtx.setTransform(0,1,1,0,0,0),this.hasProgressCanvas&&this.progressCtx.setTransform(0,1,1,0,0,0))}},{key:"fillRects",value:function(t,e,r,n,i){this.fillRectToContext(this.waveCtx,t,e,r,n,i),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,t,e,r,n,i)}},{key:"fillRectToContext",value:function(t,e,r,n,i,a){t&&(a?this.drawRoundedRect(t,e,r,n,i,a):t.fillRect(e,r,n,i))}},{key:"drawRoundedRect",value:function(t,e,r,n,i,a){0!==i&&(i<0&&(i*=-1,r-=i),t.beginPath(),t.moveTo(e+a,r),t.lineTo(e+n-a,r),t.quadraticCurveTo(e+n,r,e+n,r+a),t.lineTo(e+n,r+i-a),t.quadraticCurveTo(e+n,r+i,e+n-a,r+i),t.lineTo(e+a,r+i),t.quadraticCurveTo(e,r+i,e,r+i-a),t.lineTo(e,r+a),t.quadraticCurveTo(e,r,e+a,r),t.closePath(),t.fill())}},{key:"drawLines",value:function(t,e,r,n,i,a){this.drawLineToContext(this.waveCtx,t,e,r,n,i,a),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,t,e,r,n,i,a)}},{key:"drawLineToContext",value:function(t,e,r,n,i,a,s){if(t){var o,u,l=e.length/2,h=Math.round(l*this.start),c=Math.round(l*this.end)+1,f=this.wave.width/(c-h-1),d=n+i,p=r/n;for(t.beginPath(),t.moveTo((h-h)*f,d),t.lineTo((h-h)*f,d-Math.round((e[2*h]||0)/p)),o=h;o<c;o++)u=Math.round((e[2*o]||0)/p),t.lineTo((o-h)*f+this.halfPixel,d-u);for(var m=c-1;m>=h;m--)u=Math.round((e[2*m+1]||0)/p),t.lineTo((m-h)*f+this.halfPixel,d-u);t.lineTo((h-h)*f,d-Math.round((e[2*h+1]||0)/p)),t.closePath(),t.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(t,e,r){var n=this;return"blob"===r?new Promise(function(r){n.wave.toBlob(r,t,e)}):"dataURL"===r?this.wave.toDataURL(t,e):void 0}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==s(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==s(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===s(e)?e:String(e)}(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();e.default=o,t.exports=e.default},"./src/drawer.js":/*!***********************!*\
  !*** ./src/drawer.js ***!
  \***********************/(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var r=a(void 0);if(r&&r.has(t))return r.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var u=s?Object.getOwnPropertyDescriptor(t,o):null;u&&(u.get||u.set)?Object.defineProperty(i,o,u):i[o]=t[o]}return i.default=t,r&&r.set(t,i),i}(r(/*! ./util */"./src/util/index.js"));function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(a=function(t){return t?r:e})(t)}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=/*#__PURE__*/function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(u,t);var e,r,a=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=o(u);return t=e?Reflect.construct(r,arguments,o(this).constructor):r.apply(this,arguments),function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),(r=a.call(this)).container=i.withOrientation(t,e.vertical),r.params=e,r.width=0,r.height=e.height*r.params.pixelRatio,r.lastPos=0,r.wrapper=null,r}return r=[{key:"style",value:function(t,e){return i.style(t,e)}},{key:"createWrapper",value:function(){this.wrapper=i.withOrientation(this.container.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",cursor:this.params.hideCursor?"none":"auto",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(t,e){e||t.preventDefault();var r,n=i.withOrientation(t.targetTouches?t.targetTouches[0]:t,this.params.vertical).clientX,a=this.wrapper.getBoundingClientRect(),s=this.width,o=this.getWidth(),u=this.getProgressPixels(a,n);return r=!this.params.fillParent&&s<o?u*(this.params.pixelRatio/s)||0:(u+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,i.clamp(r,0,1)}},{key:"getProgressPixels",value:function(t,e){return this.params.rtl?t.right-e:e-t.left}},{key:"setupWrapperEvents",value:function(){var t=this;this.wrapper.addEventListener("click",function(e){var r=i.withOrientation(e,t.params.vertical),n=t.wrapper.offsetHeight-t.wrapper.clientHeight;if(0!==n){var a=t.wrapper.getBoundingClientRect();if(r.clientY>=a.bottom-n)return}t.params.interact&&t.fireEvent("click",e,t.handleEvent(e))}),this.wrapper.addEventListener("dblclick",function(e){t.params.interact&&t.fireEvent("dblclick",e,t.handleEvent(e))}),this.wrapper.addEventListener("scroll",function(e){return t.fireEvent("scroll",e)})}},{key:"drawPeaks",value:function(t,e,r,n){this.setWidth(e)||this.clearWave(),this.params.barWidth?this.drawBars(t,0,r,n):this.drawWave(t,0,r,n)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(t){var e=this.wrapper.scrollWidth*t;this.recenterOnPosition(e,!0)}},{key:"recenterOnPosition",value:function(t,e){var r=this.wrapper.scrollLeft,n=~~(this.wrapper.clientWidth/2),i=this.wrapper.scrollWidth-this.wrapper.clientWidth,a=t-n,s=a-r;if(0!=i){if(!e&&-n<=s&&s<n){var o=this.params.autoCenterRate;o/=n,o*=i,a=r+(s=Math.max(-o,Math.min(o,s)))}(a=Math.max(0,Math.min(i,a)))!=r&&(this.wrapper.scrollLeft=a)}}},{key:"getScrollX",value:function(){var t=0;if(this.wrapper){var e=this.params.pixelRatio;t=Math.round(this.wrapper.scrollLeft*e),this.params.scrollParent&&(t=Math.min(~~(this.wrapper.scrollWidth*e-this.getWidth()),Math.max(0,t)))}return t}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(t){if(this.width==t)return!1;if(this.width=t,this.params.fillParent||this.params.scrollParent)this.style(this.wrapper,{width:""});else{var e=~~(this.width/this.params.pixelRatio)+"px";this.style(this.wrapper,{width:e})}return this.updateSize(),!0}},{key:"setHeight",value:function(t){return t!=this.height&&(this.height=t,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(t){var e=1/this.params.pixelRatio,r=Math.round(t*this.width)*e;if(r<this.lastPos||r-this.lastPos>=e){if(this.lastPos=r,this.params.scrollParent&&this.params.autoCenter){var n=~~(this.wrapper.scrollWidth*t);this.recenterOnPosition(n,this.params.autoCenterImmediately)}this.updateProgress(r)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container.domElement&&this.container.removeChild(this.wrapper.domElement),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(t,e,r,n){}},{key:"drawWave",value:function(t,e,r,n){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(t){}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}(i.key),i)}}(u.prototype,r),Object.defineProperty(u,"prototype",{writable:!1}),u}(i.Observer);e.default=u,t.exports=e.default},"./src/drawer.multicanvas.js":/*!***********************************!*\
  !*** ./src/drawer.multicanvas.js ***!
  \***********************************/(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(r(/*! ./drawer */"./src/drawer.js")),a=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var r=o(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=a?Object.getOwnPropertyDescriptor(t,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(r(/*! ./util */"./src/util/index.js")),s=u(r(/*! ./drawer.canvasentry */"./src/drawer.canvasentry.js"));function o(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(o=function(t){return t?r:e})(t)}function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=/*#__PURE__*/function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(o,t);var e,r,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=h(o);return t=e?Reflect.construct(r,arguments,h(this).constructor):r.apply(this,arguments),function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t,e)).maxCanvasWidth=e.maxCanvasWidth,r.maxCanvasElementWidth=Math.round(e.maxCanvasWidth/e.pixelRatio),r.hasProgressCanvas=e.waveColor!=e.progressColor,r.halfPixel=.5/e.pixelRatio,r.canvases=[],r.progressWave=null,r.EntryClass=s.default,r.canvasContextAttributes=e.drawingContextAttributes,r.overlap=2*Math.ceil(e.pixelRatio/2),r.barRadius=e.barRadius||0,r.vertical=e.vertical,r}return r=[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=a.withOrientation(this.wrapper.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.progressWave,{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"}),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var t=this,e=Math.ceil(Math.round(this.width/this.params.pixelRatio)/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<e;)this.addCanvas();for(;this.canvases.length>e;)this.removeCanvas();var r=this.maxCanvasWidth+this.overlap,n=this.canvases.length-1;this.canvases.forEach(function(e,i){i==n&&(r=t.width-t.maxCanvasWidth*n),t.updateDimensions(e,r,t.height),e.clearWave()})}},{key:"addCanvas",value:function(){var t=new this.EntryClass;t.canvasContextAttributes=this.canvasContextAttributes,t.hasProgressCanvas=this.hasProgressCanvas,t.halfPixel=this.halfPixel;var e=this.maxCanvasElementWidth*this.canvases.length,r=a.withOrientation(this.wrapper.appendChild(document.createElement("canvas")),this.params.vertical);if(this.style(r,{position:"absolute",zIndex:2,left:e+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}),t.initWave(r),this.hasProgressCanvas){var n=a.withOrientation(this.progressWave.appendChild(document.createElement("canvas")),this.params.vertical);this.style(n,{position:"absolute",left:e+"px",top:0,bottom:0,height:"100%"}),t.initProgress(n)}this.canvases.push(t)}},{key:"removeCanvas",value:function(){var t=this.canvases[this.canvases.length-1];t.wave.parentElement.removeChild(t.wave.domElement),this.hasProgressCanvas&&t.progress.parentElement.removeChild(t.progress.domElement),t&&(t.destroy(),t=null),this.canvases.pop()}},{key:"updateDimensions",value:function(t,e,r){var n=Math.round(e/this.params.pixelRatio),i=Math.round(this.width/this.params.pixelRatio);t.updateDimensions(n,i,e,r),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var t=this;a.frame(function(){t.canvases.forEach(function(t){return t.clearWave()})})()}},{key:"drawBars",value:function(t,e,r,n){var i=this;return this.prepareDraw(t,e,r,n,function(t){var e=t.absmax,a=t.hasMinVals,s=(t.height,t.offsetY),o=t.halfH,u=t.peaks,l=t.channelIndex;if(void 0!==r)for(var h=a?2:1,c=u.length/h,f=i.params.barWidth*i.params.pixelRatio,d=null===i.params.barGap?Math.max(i.params.pixelRatio,~~(f/2)):Math.max(i.params.pixelRatio,i.params.barGap*i.params.pixelRatio),p=f+d,m=c/i.width,v=r;v<n;v+=p){var g=0,y=Math.floor(v*m)*h,b=Math.floor((v+p)*m)*h;do{var w=Math.abs(u[y]);w>g&&(g=w),y+=h}while(y<b)var k=Math.round(g/e*o);i.params.barMinHeight&&(k=Math.max(k,i.params.barMinHeight)),i.fillRect(v+i.halfPixel,o-k+s,f+i.halfPixel,2*k,i.barRadius,l)}})}},{key:"drawWave",value:function(t,e,r,n){var i=this;return this.prepareDraw(t,e,r,n,function(t){var e=t.absmax,a=t.hasMinVals,s=(t.height,t.offsetY),o=t.halfH,u=t.peaks,l=t.channelIndex;if(!a){for(var h=[],c=u.length,f=0;f<c;f++)h[2*f]=u[f],h[2*f+1]=-u[f];u=h}void 0!==r&&i.drawLine(u,e,o,s,r,n,l),i.fillRect(0,o+s-i.halfPixel,i.width,i.halfPixel,i.barRadius,l)})}},{key:"drawLine",value:function(t,e,r,n,i,a,s){var o=this,u=this.params.splitChannelsOptions.channelColors[s]||{},l=u.waveColor,h=u.progressColor;this.canvases.forEach(function(s,u){o.setFillStyles(s,l,h),o.applyCanvasTransforms(s,o.params.vertical),s.drawLines(t,e,r,n,i,a)})}},{key:"fillRect",value:function(t,e,r,n,i,a){for(var s=Math.floor(t/this.maxCanvasWidth),o=Math.min(Math.ceil((t+r)/this.maxCanvasWidth)+1,this.canvases.length),u=s;u<o;u++){var l=this.canvases[u],h=u*this.maxCanvasWidth,c={x1:Math.max(t,u*this.maxCanvasWidth),y1:e,x2:Math.min(t+r,u*this.maxCanvasWidth+l.wave.width),y2:e+n};if(c.x1<c.x2){var f=this.params.splitChannelsOptions.channelColors[a]||{},d=f.waveColor,p=f.progressColor;this.setFillStyles(l,d,p),this.applyCanvasTransforms(l,this.params.vertical),l.fillRects(c.x1-h,c.y1,c.x2-c.x1,c.y2-c.y1,i)}}}},{key:"hideChannel",value:function(t){return this.params.splitChannels&&this.params.splitChannelsOptions.filterChannels.includes(t)}},{key:"prepareDraw",value:function(t,e,r,n,i,s,o){var u=this;return a.frame(function(){if(t[0]instanceof Array){var l=t;if(u.params.splitChannels){var h,c=l.filter(function(t,e){return!u.hideChannel(e)});return u.params.splitChannelsOptions.overlay||u.setHeight(Math.max(c.length,1)*u.params.height*u.params.pixelRatio),u.params.splitChannelsOptions&&u.params.splitChannelsOptions.relativeNormalization&&(h=a.max(l.map(function(t){return a.absMax(t)}))),l.forEach(function(t,e){return u.prepareDraw(t,e,r,n,i,c.indexOf(t),h)})}t=l[0]}if(!u.hideChannel(e)){var f=1/u.params.barHeight;u.params.normalize&&(f=void 0===o?a.absMax(t):o);var d=[].some.call(t,function(t){return t<0}),p=u.params.height*u.params.pixelRatio,m=p*s||0;return u.params.splitChannelsOptions&&u.params.splitChannelsOptions.overlay&&(m=0),i({absmax:f,hasMinVals:d,height:p,offsetY:m,halfH:p/2,peaks:t,channelIndex:e})}})()}},{key:"setFillStyles",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.params.waveColor,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.progressColor;t.setFillStyles(e,r)}},{key:"applyCanvasTransforms",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.applyCanvasTransforms(e)}},{key:"getImage",value:function(t,e,r){if("blob"===r)return Promise.all(this.canvases.map(function(n){return n.getImage(t,e,r)}));if("dataURL"===r){var n=this.canvases.map(function(n){return n.getImage(t,e,r)});return n.length>1?n:n[0]}}},{key:"updateProgress",value:function(t){this.style(this.progressWave,{width:t+"px"})}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}(i.key),i)}}(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o}(i.default);e.default=c,t.exports=e.default},"./src/mediaelement-webaudio.js":/*!**************************************!*\
  !*** ./src/mediaelement-webaudio.js ***!
  \**************************************/(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function a(t,e){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,u=/*#__PURE__*/function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,t);var e,r,o=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=s(u);return t=e?Reflect.construct(r,arguments,s(this).constructor):r.apply(this,arguments),function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),(e=o.call(this,t)).params=t,e.sourceMediaElement=null,e}return r=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(t,e,r){i(s(u.prototype),"_load",this).call(this,t,e,r),this.createMediaElementSource(t)}},{key:"createMediaElementSource",value:function(t){this.sourceMediaElement=this.ac.createMediaElementSource(t),this.sourceMediaElement.connect(this.analyser)}},{key:"play",value:function(t,e){return this.resumeAudioContext(),i(s(u.prototype),"play",this).call(this,t,e)}},{key:"destroy",value:function(){i(s(u.prototype),"destroy",this).call(this),this.destroyWebAudio()}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}(i.key),i)}}(u.prototype,r),Object.defineProperty(u,"prototype",{writable:!1}),u}(((o=r(/*! ./mediaelement */"./src/mediaelement.js"))&&o.__esModule?o:{default:o}).default);e.default=u,t.exports=e.default},"./src/mediaelement.js":/*!*****************************!*\
  !*** ./src/mediaelement.js ***!
  \*****************************/(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,a=(i=r(/*! ./webaudio */"./src/webaudio.js"))&&i.__esModule?i:{default:i},s=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var r=o(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var u=a?Object.getOwnPropertyDescriptor(t,s):null;u&&(u.get||u.set)?Object.defineProperty(i,s,u):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(r(/*! ./util */"./src/util/index.js"));function o(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(o=function(t){return t?r:e})(t)}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=/*#__PURE__*/function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(a,t);var e,r,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=h(a);return t=e?Reflect.construct(r,arguments,h(this).constructor):r.apply(this,arguments),function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).params=t,e.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},e.mediaType=t.mediaType.toLowerCase(),e.elementPosition=t.elementPosition,e.peaks=null,e.playbackRate=1,e.volume=1,e.isMuted=!1,e.buffer=null,e.onPlayEnd=null,e.mediaListeners={},e}return r=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var t=this;this.mediaListeners.error=function(){t.fireEvent("error","Error loading media element")},this.mediaListeners.waiting=function(){t.fireEvent("waiting")},this.mediaListeners.canplay=function(){t.fireEvent("canplay")},this.mediaListeners.ended=function(){t.fireEvent("finish")},this.mediaListeners.play=function(){t.fireEvent("play")},this.mediaListeners.pause=function(){t.fireEvent("pause")},this.mediaListeners.seeked=function(e){t.fireEvent("seek")},this.mediaListeners.volumechange=function(e){t.isMuted=t.media.muted,t.isMuted?t.volume=0:t.volume=t.media.volume,t.fireEvent("volume")},Object.keys(this.mediaListeners).forEach(function(e){t.media.removeEventListener(e,t.mediaListeners[e]),t.media.addEventListener(e,t.mediaListeners[e])})}},{key:"createTimer",value:function(){var t=this;this.on("play",function e(){t.isPaused()||(t.fireEvent("audioprocess",t.getCurrentTime()),s.frame(e)())}),this.on("pause",function(){t.fireEvent("audioprocess",t.getCurrentTime())})}},{key:"load",value:function(t,e,r,n){var i=document.createElement(this.mediaType);i.controls=this.params.mediaControls,i.autoplay=this.params.autoplay||!1,i.preload=null==n?"auto":n,i.src=t,i.style.width="100%";var a=e.querySelector(this.mediaType);a&&e.removeChild(a),e.appendChild(i),this._load(i,r,n)}},{key:"loadElt",value:function(t,e){t.controls=this.params.mediaControls,t.autoplay=this.params.autoplay||!1,this._load(t,e,t.preload)}},{key:"_load",value:function(t,e,r){if(!(t instanceof HTMLMediaElement)||void 0===t.addEventListener)throw Error("media parameter is not a valid media element");"function"!=typeof t.load||e&&"none"==r||t.load(),this.media=t,this._setupMediaListeners(),this.peaks=e,this.onPlayEnd=null,this.buffer=null,this.isMuted=t.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var t=(this.buffer||this.media).duration;return t>=1/0&&(t=this.media.seekable.end(0)),t}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(t){this.playbackRate=t||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(t){null==t||isNaN(t)||(this.media.currentTime=t),this.clearPlayEnd()}},{key:"play",value:function(t,e){this.seekTo(t);var r=this.media.play();return e&&this.setPlayEnd(e),r}},{key:"pause",value:function(){var t;return this.media&&(t=this.media.pause()),this.clearPlayEnd(),t}},{key:"setPlayEnd",value:function(t){var e=this;this.clearPlayEnd(),this._onPlayEnd=function(r){r>=t&&(e.pause(),e.seekTo(t))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(t,e,r){return this.buffer?u(h(a.prototype),"getPeaks",this).call(this,t,e,r):this.peaks||[]}},{key:"setSinkId",value:function(t){return t?this.media.setSinkId?this.media.setSinkId(t):Promise.reject(Error("setSinkId is not supported in your browser")):Promise.reject(Error("Invalid deviceId: "+t))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(t){this.volume=t,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"setMute",value:function(t){this.isMuted=this.media.muted=t}},{key:"destroy",value:function(){var t=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach(function(e){t.media&&t.media.removeEventListener(e,t.mediaListeners[e])}),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}(i.key),i)}}(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(a.default);e.default=c,t.exports=e.default},"./src/peakcache.js":/*!**************************!*\
  !*** ./src/peakcache.js ***!
  \**************************/(t,e)=>{function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=/*#__PURE__*/function(){var t;function e(){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.clearPeakCache()}return t=[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(t,e,r){t!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=t);for(var n=[],i=0;i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<e;)i++;for(i%2==0&&n.push(e);i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<=r;)n.push(this.peakCacheRanges[i]),i++;i%2==0&&n.push(r),n=n.filter(function(t,e,r){return 0==e?t!=r[e+1]:e==r.length-1?t!=r[e-1]:t!=r[e-1]&&t!=r[e+1]}),this.peakCacheRanges=this.peakCacheRanges.concat(n),this.peakCacheRanges=this.peakCacheRanges.sort(function(t,e){return t-e}).filter(function(t,e,r){return 0==e?t!=r[e+1]:e==r.length-1?t!=r[e-1]:t!=r[e-1]&&t!=r[e+1]});var a=[];for(i=0;i<n.length;i+=2)a.push([n[i],n[i+1]]);return a}},{key:"getCacheRanges",value:function(){var t,e=[];for(t=0;t<this.peakCacheRanges.length;t+=2)e.push([this.peakCacheRanges[t],this.peakCacheRanges[t+1]]);return e}}],function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}(i.key),i)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();e.default=n,t.exports=e.default},"./src/util/absMax.js":/*!****************************!*\
  !*** ./src/util/absMax.js ***!
  \****************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=(0,n.default)(t),r=(0,i.default)(t);return-r>e?-r:e};var n=a(r(/*! ./max */"./src/util/max.js")),i=a(r(/*! ./min */"./src/util/min.js"));function a(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default},"./src/util/clamp.js":/*!***************************!*\
  !*** ./src/util/clamp.js ***!
  \***************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){return Math.min(Math.max(e,t),r)},t.exports=e.default},"./src/util/fetch.js":/*!***************************!*\
  !*** ./src/util/fetch.js ***!
  \***************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(t){if(!t.url)throw Error("fetch url missing")}else throw Error("fetch options missing");var e=new i.default,r=new Headers,n=new Request(t.url);e.controller=new AbortController,t&&t.requestHeaders&&t.requestHeaders.forEach(function(t){r.append(t.key,t.value)});var a=t.responseType||"json",o={method:t.method||"GET",headers:r,mode:t.mode||"cors",credentials:t.credentials||"same-origin",cache:t.cache||"default",redirect:t.redirect||"follow",referrer:t.referrer||"client",signal:e.controller.signal};return fetch(n,o).then(function(t){e.response=t;var r=!0;t.body||(r=!1);var n=t.headers.get("content-length");return(null===n&&(r=!1),r)?(e.onProgress=function(t){e.fireEvent("progress",t)},new Response(new ReadableStream(new s(e,n,t)),o)):t}).then(function(t){var e;if(t.ok)switch(a){case"arraybuffer":return t.arrayBuffer();case"json":return t.json();case"blob":return t.blob();case"text":return t.text();default:e="Unknown responseType: "+a}throw e||(e="HTTP error status: "+t.status),Error(e)}).then(function(t){e.fireEvent("success",t)}).catch(function(t){e.fireEvent("error",t)}),e.fetchRequest=n,e};var n,i=(n=r(/*! ./observer */"./src/util/observer.js"))&&n.__esModule?n:{default:n};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=/*#__PURE__*/function(){var t;function e(t,r,n){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.instance=t,this.instance._reader=n.body.getReader(),this.total=parseInt(r,10),this.loaded=0}return t=[{key:"start",value:function(t){var e=this;!function r(){e.instance._reader.read().then(function(n){var i=n.done,a=n.value;if(i){0===e.total&&e.instance.onProgress.call(e.instance,{loaded:e.loaded,total:e.total,lengthComputable:!1}),t.close();return}e.loaded+=a.byteLength,e.instance.onProgress.call(e.instance,{loaded:e.loaded,total:e.total,lengthComputable:0!==e.total}),t.enqueue(a),r()}).catch(function(e){t.error(e)})}()}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.exports=e.default},"./src/util/frame.js":/*!***************************!*\
  !*** ./src/util/frame.js ***!
  \***************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0,i.default)(function(){return t.apply(void 0,r)})}};var n,i=(n=r(/*! ./request-animation-frame */"./src/util/request-animation-frame.js"))&&n.__esModule?n:{default:n};t.exports=e.default},"./src/util/get-id.js":/*!****************************!*\
  !*** ./src/util/get-id.js ***!
  \****************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return void 0===t&&(t="wavesurfer_"),t+Math.random().toString(32).substring(2)},t.exports=e.default},"./src/util/index.js":/*!***************************!*\
  !*** ./src/util/index.js ***!
  \***************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Observer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"absMax",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"clamp",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"debounce",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"fetchFile",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"frame",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"getId",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"ignoreSilenceMode",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(e,"max",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"min",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"preventClick",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"requestAnimationFrame",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"style",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"withOrientation",{enumerable:!0,get:function(){return m.default}});var n=g(r(/*! ./get-id */"./src/util/get-id.js")),i=g(r(/*! ./max */"./src/util/max.js")),a=g(r(/*! ./min */"./src/util/min.js")),s=g(r(/*! ./absMax */"./src/util/absMax.js")),o=g(r(/*! ./observer */"./src/util/observer.js")),u=g(r(/*! ./style */"./src/util/style.js")),l=g(r(/*! ./request-animation-frame */"./src/util/request-animation-frame.js")),h=g(r(/*! ./frame */"./src/util/frame.js")),c=g(r(/*! debounce */"./node_modules/debounce/index.js")),f=g(r(/*! ./prevent-click */"./src/util/prevent-click.js")),d=g(r(/*! ./fetch */"./src/util/fetch.js")),p=g(r(/*! ./clamp */"./src/util/clamp.js")),m=g(r(/*! ./orientation */"./src/util/orientation.js")),v=g(r(/*! ./silence-mode */"./src/util/silence-mode.js"));function g(t){return t&&t.__esModule?t:{default:t}}},"./src/util/max.js":/*!*************************!*\
  !*** ./src/util/max.js ***!
  \*************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=-1/0;return Object.keys(t).forEach(function(r){t[r]>e&&(e=t[r])}),e},t.exports=e.default},"./src/util/min.js":/*!*************************!*\
  !*** ./src/util/min.js ***!
  \*************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=Number(1/0);return Object.keys(t).forEach(function(r){t[r]<e&&(e=t[r])}),e},t.exports=e.default},"./src/util/observer.js":/*!******************************!*\
  !*** ./src/util/observer.js ***!
  \******************************/(t,e)=>{function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=/*#__PURE__*/function(){var t;function e(){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this._disabledEventEmissions=[],this.handlers=null}return t=[{key:"on",value:function(t,e){var r=this;this.handlers||(this.handlers={});var n=this.handlers[t];return n||(n=this.handlers[t]=[]),n.push(e),{name:t,callback:e,un:function(t,e){return r.un(t,e)}}}},{key:"un",value:function(t,e){if(this.handlers){var r,n=this.handlers[t];if(n){if(e)for(r=n.length-1;r>=0;r--)n[r]==e&&n.splice(r,1);else n.length=0}}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(t,e){var r=this;return this.on(t,function n(){for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];e.apply(r,a),setTimeout(function(){r.un(t,n)},0)})}},{key:"setDisabledEventEmissions",value:function(t){this._disabledEventEmissions=t}},{key:"_isDisabledEventEmission",value:function(t){return this._disabledEventEmissions&&this._disabledEventEmissions.includes(t)}},{key:"fireEvent",value:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!(!this.handlers||this._isDisabledEventEmission(t))){var i=this.handlers[t];i&&i.forEach(function(t){t.apply(void 0,r)})}}}],function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}(i.key),i)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();e.default=n,t.exports=e.default},"./src/util/orientation.js":/*!*********************************!*\
  !*** ./src/util/orientation.js ***!
  \*********************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(e,r){return e[i]?e:new Proxy(e,{get:function(e,a,s){if(a===i)return!0;if("domElement"===a)return e;if("style"===a)return t(e.style,r);if("canvas"===a)return t(e.canvas,r);if("getBoundingClientRect"===a)return function(){return t(e.getBoundingClientRect.apply(e,arguments),r)};if("getContext"===a)return function(){return t(e.getContext.apply(e,arguments),r)};var o=e[n(a,r)];return"function"==typeof o?o.bind(e):o},set:function(t,e,i){return t[n(e,r)]=i,!0}})};var r={width:"height",height:"width",overflowX:"overflowY",overflowY:"overflowX",clientWidth:"clientHeight",clientHeight:"clientWidth",clientX:"clientY",clientY:"clientX",scrollWidth:"scrollHeight",scrollLeft:"scrollTop",offsetLeft:"offsetTop",offsetTop:"offsetLeft",offsetHeight:"offsetWidth",offsetWidth:"offsetHeight",left:"top",right:"bottom",top:"left",bottom:"right",borderRightStyle:"borderBottomStyle",borderRightWidth:"borderBottomWidth",borderRightColor:"borderBottomColor"};function n(t,e){return Object.prototype.hasOwnProperty.call(r,t)&&e?r[t]:t}var i=Symbol("isProxy");t.exports=e.default},"./src/util/prevent-click.js":/*!***********************************!*\
  !*** ./src/util/prevent-click.js ***!
  \***********************************/(t,e)=>{function r(t){t.stopPropagation(),document.body.removeEventListener("click",r,!0)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){document.body.addEventListener("click",r,!0)},t.exports=e.default},"./src/util/request-animation-frame.js":/*!*********************************************!*\
  !*** ./src/util/request-animation-frame.js ***!
  \*********************************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return setTimeout(t,1e3/60)}).bind(window);e.default=r,t.exports=e.default},"./src/util/silence-mode.js":/*!**********************************!*\
  !*** ./src/util/silence-mode.js ***!
  \**********************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=new AudioContext,e=t.createBufferSource();e.buffer=t.createBuffer(1,1,44100),e.connect(t.destination),e.start();var r=document.createElement("div");r.innerHTML='<audio x-webkit-airplay="deny"></audio>';var n=r.children.item(0);n.src="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADgnABGiAAQBCqgCRMAAgEAH///////////////7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq//////////////////9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",n.preload="auto",n.type="audio/mpeg",n.disableRemotePlayback=!0,n.play(),n.remove(),r.remove()},t.exports=e.default},"./src/util/style.js":/*!***************************!*\
  !*** ./src/util/style.js ***!
  \***************************/(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return Object.keys(e).forEach(function(r){t.style[r]!==e[r]&&(t.style[r]=e[r])}),t},t.exports=e.default},"./src/wavesurfer.js":/*!***************************!*\
  !*** ./src/wavesurfer.js ***!
  \***************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==v(t)&&"function"!=typeof t)return{default:t};var r=h(void 0);if(r&&r.has(t))return r.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=i?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=t[a]}return n.default=t,r&&r.set(t,n),n}(r(/*! ./util */"./src/util/index.js")),i=l(r(/*! ./drawer.multicanvas */"./src/drawer.multicanvas.js")),a=l(r(/*! ./webaudio */"./src/webaudio.js")),s=l(r(/*! ./mediaelement */"./src/mediaelement.js")),o=l(r(/*! ./peakcache */"./src/peakcache.js")),u=l(r(/*! ./mediaelement-webaudio */"./src/mediaelement-webaudio.js"));function l(t){return t&&t.__esModule?t:{default:t}}function h(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(h=function(t){return t?r:e})(t)}function c(t,e){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function f(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return d(t)}function d(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function y(t){var e=function(t,e){if("object"!==v(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==v(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===v(e)?e:String(e)}var b=/*#__PURE__*/function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(v,t);var e,r,l,h=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=p(v);return t=e?Reflect.construct(r,arguments,p(this).constructor):r.apply(this,arguments),f(this,t)});function v(t){if(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,v),m(d(e=h.call(this)),"defaultParams",{audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,hideCursor:!1,ignoreSilenceMode:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:i.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,splitChannelsOptions:{overlay:!1,channelColors:{},filterChannels:[],relativeNormalization:!1,splitDragSelection:!1},vertical:!1,waveColor:"#999",xhr:{}}),m(d(e),"backends",{MediaElement:s.default,WebAudio:a.default,MediaElementWebAudio:u.default}),m(d(e),"util",n),e.params=Object.assign({},e.defaultParams,t),e.params.splitChannelsOptions=Object.assign({},e.defaultParams.splitChannelsOptions,t.splitChannelsOptions),e.container="string"==typeof t.container?document.querySelector(e.params.container):e.params.container,!e.container)throw Error("Container element not found");if(null==e.params.mediaContainer?e.mediaContainer=e.container:"string"==typeof e.params.mediaContainer?e.mediaContainer=document.querySelector(e.params.mediaContainer):e.mediaContainer=e.params.mediaContainer,!e.mediaContainer)throw Error("Media Container element not found");if(e.params.maxCanvasWidth<=1)throw Error("maxCanvasWidth must be greater than 1");if(e.params.maxCanvasWidth%2==1)throw Error("maxCanvasWidth must be an even number");if(!0===e.params.rtl&&(!0===e.params.vertical?n.style(e.container,{transform:"rotateX(180deg)"}):n.style(e.container,{transform:"rotateY(180deg)"})),e.params.backgroundColor&&e.setBackgroundColor(e.params.backgroundColor),e.savedVolume=0,e.isMuted=!1,e.tmpEvents=[],e.currentRequest=null,e.arraybuffer=null,e.drawer=null,e.backend=null,e.peakCache=null,"function"!=typeof e.params.renderer)throw Error("Renderer parameter is invalid");e.Drawer=e.params.renderer,"AudioElement"==e.params.backend&&(e.params.backend="MediaElement"),"WebAudio"!=e.params.backend&&"MediaElementWebAudio"!==e.params.backend||a.default.prototype.supportsWebAudio.call(null)||(e.params.backend="MediaElement"),e.Backend=e.backends[e.params.backend],e.initialisedPluginList={},e.isDestroyed=!1,e.isReady=!1;var e,r=0;return e._onResize=n.debounce(function(){e.drawer.wrapper&&r!=e.drawer.wrapper.clientWidth&&!e.params.scrollParent&&(r=e.drawer.wrapper.clientWidth)&&e.drawer.fireEvent("redraw")},"number"==typeof e.params.responsive?e.params.responsive:100),f(e,d(e))}return r=[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(t){var e=this;return t.forEach(function(t){return e.addPlugin(t)}),t.forEach(function(t){t.deferInit||e.initPlugin(t.name)}),this.fireEvent("plugins-registered",t),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(t){var e=this;if(!t.name)throw Error("Plugin does not have a name!");if(!t.instance)throw Error("Plugin ".concat(t.name," does not have an instance property!"));t.staticProps&&Object.keys(t.staticProps).forEach(function(r){e[r]=t.staticProps[r]});var r=t.instance;return Object.getOwnPropertyNames(n.Observer.prototype).forEach(function(t){r.prototype[t]=n.Observer.prototype[t]}),this[t.name]=new r(t.params||{},this),this.fireEvent("plugin-added",t.name),this}},{key:"initPlugin",value:function(t){if(!this[t])throw Error("Plugin ".concat(t," has not been added yet!"));return this.initialisedPluginList[t]&&this.destroyPlugin(t),this[t].init(),this.initialisedPluginList[t]=!0,this.fireEvent("plugin-initialised",t),this}},{key:"destroyPlugin",value:function(t){if(!this[t])throw Error("Plugin ".concat(t," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[t])throw Error("Plugin ".concat(t," is not active and cannot be destroyed!"));if("function"!=typeof this[t].destroy)throw Error("Plugin ".concat(t," does not have a destroy function!"));return this[t].destroy(),delete this.initialisedPluginList[t],this.fireEvent("plugin-destroyed",t),this}},{key:"destroyAllPlugins",value:function(){var t=this;Object.keys(this.initialisedPluginList).forEach(function(e){return t.destroyPlugin(e)})}},{key:"createDrawer",value:function(){var t=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",function(){t.drawBuffer(),t.drawer.progress(t.backend.getPlayedPercents())}),this.drawer.on("click",function(e,r){setTimeout(function(){return t.seekTo(r)},0)}),this.drawer.on("scroll",function(e){t.params.partialRender&&t.drawBuffer(),t.fireEvent("scroll",e)}),this.drawer.on("dblclick",function(e,r){t.fireEvent("dblclick",e,r)})}},{key:"createBackend",value:function(){var t=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",function(){t.drawer.progress(t.backend.getPlayedPercents()),t.fireEvent("finish")}),this.backend.on("play",function(){return t.fireEvent("play")}),this.backend.on("pause",function(){return t.fireEvent("pause")}),this.backend.on("audioprocess",function(e){t.drawer.progress(t.backend.getPlayedPercents()),t.fireEvent("audioprocess",e)}),("MediaElement"===this.params.backend||"MediaElementWebAudio"===this.params.backend)&&(this.backend.on("seek",function(){t.drawer.progress(t.backend.getPlayedPercents())}),this.backend.on("volume",function(){var e=t.getVolume();t.fireEvent("volume",e),t.backend.isMuted!==t.isMuted&&(t.isMuted=t.backend.isMuted,t.fireEvent("mute",t.isMuted))}))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new o.default)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(t){t>=this.getDuration()?this.seekTo(1):this.seekTo(t/this.getDuration())}},{key:"play",value:function(t,e){var r=this;return this.params.ignoreSilenceMode&&n.ignoreSilenceMode(),this.fireEvent("interaction",function(){return r.play(t,e)}),this.backend.play(t,e)}},{key:"setPlayEnd",value:function(t){this.backend.setPlayEnd(t)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(t){this.skip(-t||-this.params.skipLength)}},{key:"skipForward",value:function(t){this.skip(t||this.params.skipLength)}},{key:"skip",value:function(t){var e=this.getDuration()||1,r=this.getCurrentTime()||0;r=Math.max(0,Math.min(e,r+(t||0))),this.seekAndCenter(r/e)}},{key:"seekAndCenter",value:function(t){this.seekTo(t),this.drawer.recenter(t)}},{key:"seekTo",value:function(t){var e=this;if("number"!=typeof t||!isFinite(t)||t<0||t>1)throw Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",function(){return e.seekTo(t)});var r="WebAudio"===this.params.backend,n=this.backend.isPaused();r&&!n&&this.backend.pause();var i=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(t*this.getDuration()),this.drawer.progress(t),r&&!n&&this.backend.play(),this.params.scrollParent=i,this.fireEvent("seek",t)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(t){return this.backend.setSinkId(t)}},{key:"setVolume",value:function(t){if(!0===this.isMuted){this.savedVolume=t;return}this.backend.setVolume(t),this.fireEvent("volume",t)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(t){this.backend.setPlaybackRate(t)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(t){if(t===this.isMuted){this.fireEvent("mute",this.isMuted);return}this.backend.setMute?(this.backend.setMute(t),this.isMuted=t):t?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].waveColor:this.params.waveColor}},{key:"setWaveColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].waveColor=t:this.params.waveColor=t,this.drawBuffer()}},{key:"getProgressColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].progressColor:this.params.progressColor}},{key:"setProgressColor",value:function(t,e){this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].progressColor=t:this.params.progressColor=t,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(t){this.params.backgroundColor=t,n.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(t){this.params.cursorColor=t,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(t){this.params.height=t,this.drawer.setHeight(t*this.params.pixelRatio),this.drawBuffer()}},{key:"setFilteredChannels",value:function(t){this.params.splitChannelsOptions.filterChannels=t,this.drawBuffer()}},{key:"drawBuffer",value:function(){var t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),e=this.drawer.getWidth(),r=t,n=0,i=Math.max(0+e,r);if(this.params.fillParent&&(!this.params.scrollParent||t<e)&&(n=0,i=r=e),this.params.partialRender){var a,s,o=this.peakCache.addRangeToPeakCache(r,n,i);for(s=0;s<o.length;s++)a=this.backend.getPeaks(r,o[s][0],o[s][1]),this.drawer.drawPeaks(a,r,o[s][0],o[s][1])}else a=this.backend.getPeaks(r,n,i),this.drawer.drawPeaks(a,r,n,i);this.fireEvent("redraw",a,r)}},{key:"zoom",value:function(t){t?(this.params.minPxPerSec=t,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",t)}},{key:"loadArrayBuffer",value:function(t){var e=this;this.decodeArrayBuffer(t,function(t){e.isDestroyed||e.loadDecodedBuffer(t)})}},{key:"loadDecodedBuffer",value:function(t){this.backend.load(t),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(t){var e=this,r=new FileReader;r.addEventListener("progress",function(t){return e.onProgress(t)}),r.addEventListener("load",function(t){return e.loadArrayBuffer(t.target.result)}),r.addEventListener("error",function(){return e.fireEvent("error","Error reading file")}),r.readAsArrayBuffer(t),this.empty()}},{key:"load",value:function(t,e,r,n){if(!t)throw Error("url parameter cannot be empty");if(this.empty(),r){var i={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(r),"Peaks are not provided":!e,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof t},a=Object.keys(i).filter(function(t){return i[t]});a.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n	- "+a.join("\n	- ")),r=null)}switch("WebAudio"===this.params.backend&&t instanceof HTMLMediaElement&&(t=t.src),this.params.backend){case"WebAudio":return this.loadBuffer(t,e,n);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(t,e,r,n)}}},{key:"loadBuffer",value:function(t,e,r){var n=this,i=function(e){return e&&n.tmpEvents.push(n.once("ready",e)),n.getArrayBuffer(t,function(t){return n.loadArrayBuffer(t)})};if(!e)return i();this.backend.setPeaks(e,r),this.drawBuffer(),this.fireEvent("waveform-ready"),this.tmpEvents.push(this.once("interaction",i))}},{key:"loadMediaElement",value:function(t,e,r,n){var i=this,a=t;"string"==typeof t?this.backend.load(a,this.mediaContainer,e,r):(this.backend.loadElt(t,e),a=t.src),this.tmpEvents.push(this.backend.once("canplay",function(){i.backend.destroyed||(i.drawBuffer(),i.isReady=!0,i.fireEvent("ready"))}),this.backend.once("error",function(t){return i.fireEvent("error",t)})),e&&(this.backend.setPeaks(e,n),this.drawBuffer(),this.fireEvent("waveform-ready")),(!e||this.params.forceDecode)&&this.backend.supportsWebAudio()&&this.getArrayBuffer(a,function(t){i.decodeArrayBuffer(t,function(t){i.backend.buffer=t,i.backend.setPeaks(null),i.drawBuffer(),i.fireEvent("waveform-ready")})})}},{key:"decodeArrayBuffer",value:function(t,e){var r=this;this.isDestroyed||(this.arraybuffer=t,this.backend.decodeArrayBuffer(t,function(n){r.isDestroyed||r.arraybuffer!=t||(e(n),r.arraybuffer=null)},function(){return r.fireEvent("error","Error decoding audiobuffer")}))}},{key:"getArrayBuffer",value:function(t,e){var r=this,i=Object.assign({url:t,responseType:"arraybuffer"},this.params.xhr),a=n.fetchFile(i);return this.currentRequest=a,this.tmpEvents.push(a.on("progress",function(t){r.onProgress(t)}),a.on("success",function(t){e(t),r.currentRequest=null}),a.on("error",function(t){r.fireEvent("error",t),r.currentRequest=null})),a}},{key:"onProgress",value:function(t){var e;e=t.lengthComputable?t.loaded/t.total:t.loaded/(t.loaded+1e6),this.fireEvent("loading",Math.round(100*e),t.target)}},{key:"exportPCM",value:function(t,e,r,n,i){t=t||1024,n=n||0,e=e||1e4,r=r||!1;var a=this.backend.getPeaks(t,n,i),s=[].map.call(a,function(t){return Math.round(t*e)/e});return new Promise(function(t,e){if(!r){var n=new Blob([JSON.stringify(s)],{type:"application/json;charset=utf-8"}),i=URL.createObjectURL(n);window.open(i),URL.revokeObjectURL(i)}t(s)})}},{key:"exportImage",value:function(t,e,r){return t||(t="image/png"),e||(e=1),r||(r="dataURL"),this.drawer.getImage(t,e,r)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest._reader&&this.currentRequest._reader.cancel().catch(function(t){}),this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach(function(t){return t.un()})}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&(this.backend.destroy(),this.backend=null),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}],l=[{key:"create",value:function(t){return new v(t).init()}}],r&&g(v.prototype,r),l&&g(v,l),Object.defineProperty(v,"prototype",{writable:!1}),v}(n.Observer);e.default=b,m(b,"VERSION","6.6.4"),m(b,"util",n),t.exports=e.default},"./src/webaudio.js":/*!*************************!*\
  !*** ./src/webaudio.js ***!
  \*************************/(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var r=i(void 0);if(r&&r.has(t))return r.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var u=s?Object.getOwnPropertyDescriptor(t,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=t[o]}return n.default=t,r&&r.set(t,n),n}(r(/*! ./util */"./src/util/index.js"));function i(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(i=function(t){return t?r:e})(t)}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return(e=h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){var e=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a(e)?e:String(e)}var c="playing",f="paused",d="finished",p=/*#__PURE__*/function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(p,t);var e,r,i=(e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,r=u(p);return t=e?Reflect.construct(r,arguments,u(this).constructor):r.apply(this,arguments),function(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return o(t)}(this,t)});function p(t){var e,r,n;return function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,p),l(o(n=i.call(this)),"audioContext",null),l(o(n),"stateBehaviors",(l(e={},c,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var t=this.getDuration();return this.getCurrentTime()/t||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),l(e,f,{init:function(){},getPlayedPercents:function(){var t=this.getDuration();return this.getCurrentTime()/t||0},getCurrentTime:function(){return this.startPosition}}),l(e,d,{init:function(){this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),e)),n.params=t,n.ac=t.audioContext||(n.supportsWebAudio()?n.getAudioContext():{}),n.lastPlay=n.ac.currentTime,n.startPosition=0,n.scheduledPause=null,n.states=(l(r={},c,Object.create(n.stateBehaviors[c])),l(r,f,Object.create(n.stateBehaviors[f])),l(r,d,Object.create(n.stateBehaviors[d])),r),n.buffer=null,n.filters=[],n.gainNode=null,n.mergedPeaks=null,n.offlineAc=null,n.peaks=null,n.playbackRate=1,n.analyser=null,n.scriptNode=null,n.source=null,n.splitPeaks=[],n.state=null,n.explicitDuration=t.duration,n.sinkStreamDestination=null,n.sinkAudioElement=null,n.destroyed=!1,n}return r=[{key:"supportsWebAudio",value:function(){return!!(window.AudioContext||window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(t){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,t)),window.WaveSurferOfflineAudioContext}},{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(f),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach(function(t){t&&t.disconnect()}),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(t){this.state!==this.states[t]&&(this.state=this.states[t],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.setFilters(e)}},{key:"setFilters",value:function(t){this.disconnectFilters(),t&&t.length&&(this.filters=t,this.analyser.disconnect(),t.reduce(function(t,e){return t.connect(e),e},this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor&&(this.scriptNode=this.params.audioScriptProcessor,this.scriptNode.connect(this.ac.destination))}},{key:"addOnAudioProcess",value:function(){var t=this;!function e(){var r=t.getCurrentTime();r>=t.getDuration()&&t.state!==t.states[d]?(t.setState(d),t.fireEvent("pause")):r>=t.scheduledPause&&t.state!==t.states[f]?t.pause():t.state===t.states[c]&&(t.fireEvent("audioprocess",r),n.frame(e)())}()}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(t){return t?(this.sinkAudioElement||(this.sinkAudioElement=new window.Audio,this.sinkAudioElement.autoplay=!0),this.sinkAudioElement.setSinkId)?(this.sinkStreamDestination||(this.sinkStreamDestination=this.ac.createMediaStreamDestination()),this.gainNode.disconnect(),this.gainNode.connect(this.sinkStreamDestination),this.sinkAudioElement.srcObject=this.sinkStreamDestination.stream,this.sinkAudioElement.setSinkId(t)):Promise.reject(Error("setSinkId is not supported in your browser")):Promise.reject(Error("Invalid deviceId: "+t))}},{key:"setVolume",value:function(t){this.gainNode.gain.setValueAtTime(t,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(t,e,r){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),"webkitAudioContext"in window?this.offlineAc.decodeAudioData(t,function(t){return e(t)},r):this.offlineAc.decodeAudioData(t).then(function(t){return e(t)}).catch(function(t){return r(t)})}},{key:"setPeaks",value:function(t,e){null!=e&&(this.explicitDuration=e),this.peaks=t}},{key:"setLength",value:function(t){if(!this.mergedPeaks||t!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var e,r=this.buffer?this.buffer.numberOfChannels:1;for(e=0;e<r;e++)this.splitPeaks[e]=[],this.splitPeaks[e][2*(t-1)]=0,this.splitPeaks[e][2*(t-1)+1]=0;this.mergedPeaks[2*(t-1)]=0,this.mergedPeaks[2*(t-1)+1]=0}}},{key:"getPeaks",value:function(t,e,r){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(e=e||0,r=r||t-1,this.setLength(t),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var n,i=this.createBuffer(1,4096,this.sampleRate);this.buffer=i.buffer}var a=this.buffer.length/t,s=~~(a/10)||1,o=this.buffer.numberOfChannels;for(n=0;n<o;n++){var u=this.splitPeaks[n],l=this.buffer.getChannelData(n),h=void 0;for(h=e;h<=r;h++){var c=~~(h*a),f=~~(c+a),d=l[c],p=d,m=void 0;for(m=c;m<f;m+=s){var v=l[m];v>p&&(p=v),v<d&&(d=v)}u[2*h]=p,u[2*h+1]=d,(0==n||p>this.mergedPeaks[2*h])&&(this.mergedPeaks[2*h]=p),(0==n||d<this.mergedPeaks[2*h+1])&&(this.mergedPeaks[2*h+1]=d)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroyWebAudio",value:function(){this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode&&this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null),this.sinkStreamDestination&&(this.sinkAudioElement.pause(),this.sinkAudioElement.srcObject=null,this.sinkStreamDestination.disconnect(),this.sinkStreamDestination=null)}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.destroyWebAudio()}},{key:"load",value:function(t){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=t,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.setPlaybackRate(this.playbackRate),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"resumeAudioContext",value:function(){"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume()}},{key:"isPaused",value:function(){return this.state!==this.states[c]}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(t,e){if(this.buffer)return this.scheduledPause=null,null==t&&(t=this.getCurrentTime())>=this.getDuration()&&(t=0),null==e&&(e=this.getDuration()),this.startPosition=t,this.lastPlay=this.ac.currentTime,this.state===this.states[d]&&this.setState(f),{start:t,end:e}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(t,e){if(this.buffer){this.createSource();var r=this.seekTo(t,e);t=r.start,e=r.end,this.scheduledPause=e,this.source.start(0,t),this.resumeAudioContext(),this.setState(c),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime();try{this.source&&this.source.stop(0)}catch(t){}this.setState(f),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(t){this.playbackRate=t||1,this.source&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime)}},{key:"setPlayEnd",value:function(t){this.scheduledPause=t}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}(p.prototype,r),Object.defineProperty(p,"prototype",{writable:!1}),p}(n.Observer);e.default=p,t.exports=e.default},"./node_modules/debounce/index.js":/*!****************************************!*\
  !*** ./node_modules/debounce/index.js ***!
  \****************************************/t=>{function e(t,e,r){function n(){var l=Date.now()-o;l<e&&l>=0?i=setTimeout(n,e-l):(i=null,r||(u=t.apply(s,a),s=a=null))}null==e&&(e=100);var i,a,s,o,u,l=function(){s=this,a=arguments,o=Date.now();var l=r&&!i;return i||(i=setTimeout(n,e)),l&&(u=t.apply(s,a),s=a=null),u};return l.clear=function(){i&&(clearTimeout(i),i=null)},l.flush=function(){i&&(u=t.apply(s,a),s=a=null,clearTimeout(i),i=null)},l}e.debounce=e,t.exports=e}},e={},u=function r(n){var i=e[n];if(void 0!==i)return i.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}("./src/wavesurfer.js");class l{static create(t){return{name:"markers",deferInit:!!t&&!!t.deferInit&&t.deferInit,params:t,staticProps:{addMarker(t){return this.initialisedPluginList.markers||this.initPlugin("markers"),this.markers.add(t)},getMarkers(){return this.markers},clearMarkers(){this.markers&&this.markers.clear()}},instance:l}}constructor(t,e){this.params=t,this.wavesurfer=e,this.util=e.util,this.style=this.util.style,this.markerLineWidth=1,this.markerWidth=11,this.markerHeight=22,this.dragging=!1,this._onResize=()=>{this._updateMarkerPositions()},this._onBackendCreated=()=>{this.wrapper=this.wavesurfer.drawer.wrapper,this.params.markers&&this.params.markers.forEach(t=>this.add(t)),window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0),this.wavesurfer.on("zoom",this._onResize),this.markers.find(t=>t.draggable)&&(this.onMouseMove=t=>this._onMouseMove(t),window.addEventListener("mousemove",this.onMouseMove),this.onMouseUp=t=>this._onMouseUp(t),window.addEventListener("mouseup",this.onMouseUp))},this.markers=[],this._onReady=()=>{this.wrapper=this.wavesurfer.drawer.wrapper,this._updateMarkerPositions()}}init(){this.wavesurfer.isReady?(this._onBackendCreated(),this._onReady()):(this.wavesurfer.once("ready",this._onReady),this.wavesurfer.once("backend-created",this._onBackendCreated))}destroy(){this.wavesurfer.un("ready",this._onReady),this.wavesurfer.un("backend-created",this._onBackendCreated),this.wavesurfer.un("zoom",this._onResize),window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0),this.onMouseMove&&window.removeEventListener("mousemove",this.onMouseMove),this.onMouseUp&&window.removeEventListener("mouseup",this.onMouseUp),this.clear()}add(t){let e={time:t.time,label:t.label,tooltip:t.tooltip,color:t.color||"#D8D8D8",position:t.position||"bottom",draggable:!!t.draggable,preventContextMenu:!!t.preventContextMenu};return e.el=this._createMarkerElement(e,t.markerElement),this.wrapper.appendChild(e.el),this.markers.push(e),this._updateMarkerPositions(),this._registerEvents(),e}remove(t){let e=t;isNaN(e)&&(e=this.markers.findIndex(e=>e===t));let r=this.markers[e];if(!r)return;let n=r.el.getElementsByClassName("marker-label")[0];n&&(n._onContextMenu&&n.removeEventListener("contextmenu",n._onContextMenu),n._onClick&&n.removeEventListener("click",n._onClick),n._onMouseDown&&n.removeEventListener("mousedown",n._onMouseDown)),this.wrapper.removeChild(r.el),this.markers.splice(e,1),this._unregisterEvents()}_createPointerSVG(t,e){let r="http://www.w3.org/2000/svg",n=document.createElementNS(r,"svg"),i=document.createElementNS(r,"polygon");return n.setAttribute("viewBox","0 0 40 80"),i.setAttribute("id","polygon"),i.setAttribute("stroke","#979797"),i.setAttribute("fill",t),i.setAttribute("points","20 0 40 30 40 80 0 80 0 30"),"top"==e&&i.setAttribute("transform","rotate(180, 20 40)"),n.appendChild(i),this.style(n,{width:this.markerWidth+"px",height:this.markerHeight+"px","min-width":this.markerWidth+"px","margin-right":"5px","z-index":4}),n}_createMarkerElement(t,e){let r=t.label,n=t.tooltip,i=document.createElement("marker");i.className="wavesurfer-marker",this.style(i,{position:"absolute",height:"100%",display:"flex",overflow:"hidden","flex-direction":"top"==t.position?"column-reverse":"column"});let a=document.createElement("div"),s=e?e.width:this.markerWidth;t.offset=(s-this.markerLineWidth)/2,this.style(a,{"flex-grow":1,"margin-left":t.offset+"px",background:"black",width:this.markerLineWidth+"px",opacity:.1}),i.appendChild(a);let o=document.createElement("div"),u=e||this._createPointerSVG(t.color,t.position);if(t.draggable&&(u.draggable=!1),o.appendChild(u),r){let t=document.createElement("span");t.innerText=r,t.setAttribute("title",n),this.style(t,{"font-family":"inherit","font-size":"90%"}),o.appendChild(t)}return this.style(o,{display:"flex","align-items":"center",cursor:"pointer"}),o.classList.add("marker-label"),i.appendChild(o),o._onClick=e=>{e.stopPropagation(),this.dragging||(this.wavesurfer.setCurrentTime(t.time),this.wavesurfer.fireEvent("marker-click",t,e))},o.addEventListener("click",o._onClick),o._onContextMenu=e=>{t.preventContextMenu&&e.preventDefault(),this.wavesurfer.fireEvent("marker-contextmenu",t,e)},o.addEventListener("contextmenu",o._onContextMenu),t.draggable&&(o._onMouseDown=()=>{this.selectedMarker=t},o.addEventListener("mousedown",o._onMouseDown)),i}_updateMarkerPositions(){for(let t=0;t<this.markers.length;t++){let e=this.markers[t];this._updateMarkerPosition(e)}}_updateMarkerPosition(t){let e=this.wavesurfer.getDuration(),r=this.wavesurfer.drawer.width/this.wavesurfer.params.pixelRatio,n=r*Math.min(t.time/e,1)-t.offset;this.style(t.el,{left:n+"px","max-width":r-n+"px"})}_onMouseMove(t){this.selectedMarker&&(this.dragging||(this.dragging=!0,this.wavesurfer.fireEvent("marker-drag",this.selectedMarker,t)),this.selectedMarker.time=this.wavesurfer.drawer.handleEvent(t)*this.wavesurfer.getDuration(),this._updateMarkerPositions())}_onMouseUp(t){if(this.selectedMarker&&setTimeout(()=>{this.selectedMarker=!1,this.dragging=!1},0),!this.dragging)return;t.stopPropagation();let e=this.wavesurfer.getDuration();this.selectedMarker.time=this.wavesurfer.drawer.handleEvent(t)*e,this._updateMarkerPositions(),this.wavesurfer.fireEvent("marker-drop",this.selectedMarker,t)}_registerEvents(){this.markers.find(t=>t.draggable)&&(this.onMouseMove||(this.onMouseMove=t=>this._onMouseMove(t),window.addEventListener("mousemove",this.onMouseMove)),this.onMouseUp||(this.onMouseUp=t=>this._onMouseUp(t),window.addEventListener("mouseup",this.onMouseUp)))}_unregisterEvents(){!this.markers.find(t=>t.draggable)&&(this.onMouseMove&&(window.removeEventListener("mousemove",this.onMouseMove),this.onMouseMove=null),this.onMouseUp&&(window.removeEventListener("mouseup",this.onMouseUp),this.onMouseUp=null))}clear(){for(;this.markers.length>0;)this.remove(0)}}class h{constructor(t,e,r){this.wavesurfer=r,this.wrapper=r.drawer.wrapper,this.util=r.util,this.style=this.util.style,this.regionsUtil=e,this.vertical=r.drawer.params.vertical,this.id=null==t.id?r.util.getId():t.id,this.start=Number(t.start)||0,this.end=null==t.end?this.start+4/this.wrapper.scrollWidth*this.wavesurfer.getDuration():Number(t.end),this.resize=void 0===t.resize||!!t.resize,this.drag=void 0===t.drag||!!t.drag,this.contentEditable=!!t.contentEditable,this.removeButton=!!t.removeButton,this.isResizing=!1,this.isDragging=!1,this.loop=!!t.loop,this.color=t.color||"rgba(0, 0, 0, 0.1)",this.handleStyle=t.handleStyle||{left:{},right:{}},this.handleLeftEl=null,this.handleRightEl=null,this.data=t.data||{},this.attributes=t.attributes||{},this.showTooltip=t.showTooltip??!0,this.maxLength=t.maxLength,this.minLength=t.minLength,this._onRedraw=()=>this.updateRender(),this.scroll=!1!==t.scroll&&r.params.scrollParent,this.scrollSpeed=t.scrollSpeed||1,this.scrollThreshold=t.scrollThreshold||10,this.preventContextMenu=void 0!==t.preventContextMenu&&!!t.preventContextMenu;let n=null==t.channelIdx?-1:parseInt(t.channelIdx);if(this.channelIdx=n,this.regionHeight="100%",this.marginTop="0px",-1!==n){let t=null!=this.wavesurfer.backend.buffer?this.wavesurfer.backend.buffer.numberOfChannels:-1;t>=0&&n<t&&(this.regionHeight=Math.floor(1/t*100)+"%",this.marginTop=this.wavesurfer.getHeight()*n+"px")}this.formatTimeCallback=t.formatTimeCallback,this.edgeScrollWidth=t.edgeScrollWidth,this.bindInOut(),this.render(),this.wavesurfer.on("zoom",this._onRedraw),this.wavesurfer.on("redraw",this._onRedraw),this.wavesurfer.fireEvent("region-created",this)}update(t,e){null!=t.start&&(this.start=Number(t.start)),null!=t.end&&(this.end=Number(t.end)),null!=t.loop&&(this.loop=!!t.loop),null!=t.color&&(this.color=t.color),null!=t.handleStyle&&(this.handleStyle=t.handleStyle),null!=t.data&&(this.data=t.data),null!=t.resize&&(this.resize=!!t.resize,this.updateHandlesResize(this.resize)),null!=t.drag&&(this.drag=!!t.drag),null!=t.maxLength&&(this.maxLength=Number(t.maxLength)),null!=t.minLength&&(this.minLength=Number(t.minLength)),null!=t.attributes&&(this.attributes=t.attributes),this.updateRender(),this.fireEvent("update"),this.wavesurfer.fireEvent("region-updated",this,e)}remove(){this.element&&(this.element.remove(),this.element=null,this.fireEvent("remove"),this.wavesurfer.un("zoom",this._onRedraw),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.fireEvent("region-removed",this))}play(t){let e=t||this.start;this.wavesurfer.play(e,this.end),this.fireEvent("play"),this.wavesurfer.fireEvent("region-play",this)}playLoop(t){this.loop=!0,this.play(t)}setLoop(t){this.loop=t}render(){for(let t in this.element=this.util.withOrientation(this.wrapper.appendChild(document.createElement("region")),this.vertical),this.element.className="wavesurfer-region",this.showTooltip&&(this.element.title=this.formatTime(this.start,this.end)),this.element.setAttribute("data-id",this.id),this.attributes)this.element.setAttribute("data-region-"+t,this.attributes[t]);if(this.style(this.element,{position:"absolute",zIndex:3,height:this.regionHeight,top:this.marginTop}),this.removeButton){let t=document.createElement("div");t.className="remove-region-button",t.textContent="⨯",this.removeButtonEl=this.element.appendChild(t),this.style(this.removeButtonEl,{zIndex:4,position:"absolute",bottom:0,right:"4px",cursor:"pointer",fontSize:"20px",lineHeight:"21px",color:"grey"})}if(this.contentEditable){let t=document.createElement("div");t.className="region-content",t.contentEditable="true",t.innerText=this.data.text||"",this.contentEl=this.element.appendChild(t),this.style(this.contentEl,{zIndex:4,padding:"2px 5px",cursor:"text"})}if(this.resize){this.handleLeftEl=this.util.withOrientation(this.element.appendChild(document.createElement("handle")),this.vertical),this.handleRightEl=this.util.withOrientation(this.element.appendChild(document.createElement("handle")),this.vertical),this.handleLeftEl.className="wavesurfer-handle wavesurfer-handle-start",this.handleRightEl.className="wavesurfer-handle wavesurfer-handle-end";let t={cursor:this.vertical?"row-resize":"col-resize",position:"absolute",top:"0px",width:"2px",height:"100%",backgroundColor:"rgba(0, 0, 0, 1)"},e="none"!==this.handleStyle.left?Object.assign({left:"0px"},t,this.handleStyle.left):null,r="none"!==this.handleStyle.right?Object.assign({right:"0px"},t,this.handleStyle.right):null;e&&this.style(this.handleLeftEl,e),r&&this.style(this.handleRightEl,r)}this.updateRender(),this.bindEvents()}formatTime(t,e){return this.formatTimeCallback?this.formatTimeCallback(t,e):(t==e?[t]:[t,e]).map(t=>[Math.floor(t%3600/60),("00"+Math.floor(t%60)).slice(-2)].join(":")).join("-")}getWidth(){return this.wavesurfer.drawer.width/this.wavesurfer.params.pixelRatio}updateRender(){let t=this.wavesurfer.getDuration(),e=this.getWidth(),r=this.start,n=this.end;if(r<0&&(n-=r=0),n>t&&(n=t,r=t-(n-r)),null!=this.minLength&&(n=Math.max(r+this.minLength,n)),null!=this.maxLength&&(n=Math.min(r+this.maxLength,n)),null!=this.element){let i=Math.round(r/t*e),a=Math.round(n/t*e)-i;for(let t in this.style(this.element,{left:i+"px",width:a+"px",backgroundColor:this.color,cursor:this.drag?"move":"default"}),this.attributes)this.element.setAttribute("data-region-"+t,this.attributes[t]);this.showTooltip&&(this.element.title=this.formatTime(this.start,this.end))}}bindInOut(){this.firedIn=!1,this.firedOut=!1;let t=t=>{let e=Math.round(10*this.start)/10,r=Math.round(10*this.end)/10;t=Math.round(10*t)/10,!this.firedOut&&this.firedIn&&(e>t||r<=t)&&(this.firedOut=!0,this.firedIn=!1,this.fireEvent("out"),this.wavesurfer.fireEvent("region-out",this)),!this.firedIn&&e<=t&&r>t&&(this.firedIn=!0,this.firedOut=!1,this.fireEvent("in"),this.wavesurfer.fireEvent("region-in",this))};this.wavesurfer.backend.on("audioprocess",t),this.on("remove",()=>{this.wavesurfer.backend.un("audioprocess",t)}),this.on("out",()=>{if(this.loop){let t=this.wavesurfer.getCurrentTime();t>=this.start&&t<=this.end&&this.wavesurfer.play(this.start)}})}bindEvents(){let t=this.preventContextMenu;this.element.addEventListener("mouseenter",t=>{this.fireEvent("mouseenter",t),this.wavesurfer.fireEvent("region-mouseenter",this,t)}),this.element.addEventListener("mouseleave",t=>{this.fireEvent("mouseleave",t),this.wavesurfer.fireEvent("region-mouseleave",this,t)}),this.element.addEventListener("click",t=>{t.preventDefault(),this.fireEvent("click",t),this.wavesurfer.fireEvent("region-click",this,t)}),this.element.addEventListener("dblclick",t=>{t.stopPropagation(),t.preventDefault(),this.fireEvent("dblclick",t),this.wavesurfer.fireEvent("region-dblclick",this,t)}),this.element.addEventListener("contextmenu",e=>{t&&e.preventDefault(),this.fireEvent("contextmenu",e),this.wavesurfer.fireEvent("region-contextmenu",this,e)}),(this.drag||this.resize)&&this.bindDragEvents(),this.contentEditable&&(this.contentEl.addEventListener("blur",this.onContentBlur.bind(this)),this.contentEl.addEventListener("click",this.onContentClick.bind(this))),this.removeButton&&this.removeButtonEl.addEventListener("click",this.onRemove.bind(this))}bindDragEvents(){let t,e,r,n,i,a,s,o,u;let l=this.wavesurfer.drawer.container,h=this.scrollSpeed,c=!1,f=e=>{let l=this.util.withOrientation(e,this.vertical),c=this.wavesurfer.getDuration();if(!a||!r&&!i)return;let d=l.clientX,p=0,m=0,v=0,g=this.regionsUtil.getRegionSnapToGridValue(this.wavesurfer.drawer.handleEvent(e)*c);if(r)-1===a?(m=o*this.wavesurfer.params.minPxPerSec,p=d-s.left):(m=u*this.wavesurfer.params.minPxPerSec,p=s.right-d);else{let t=this.minLength;t||(t=0),"start"===i?(g>this.end-t&&(g=this.end-t,v=h*a),g<0&&(g=0)):"end"===i&&(g<this.start+t&&(g=this.start+t,v=h*a),g>c&&(g=c))}let y=this.wrapper.scrollLeft;if(-1===a){if(0===Math.round(y)||0>=Math.round(y-m+p))return}else if(Math.round(y)===n||Math.round(y+m-p)>=n)return;let b=y-v+h*a;if(-1===a){let t=Math.max(0+m-p,b);this.wrapper.scrollLeft=b=t}else{let t=Math.min(n-m+p,b);this.wrapper.scrollLeft=b=t}let w=g-t;t=g,r?this.onDrag(w):this.onResize(w,i),window.requestAnimationFrame(()=>{f(e)})},d=a=>{let l=this.wavesurfer.getDuration();a.touches&&a.touches.length>1||(e=a.targetTouches?a.targetTouches[0].identifier:null,(this.drag||this.resize)&&a.stopPropagation(),o=(t=this.regionsUtil.getRegionSnapToGridValue(this.wavesurfer.drawer.handleEvent(a,!0)*l))-this.start,u=this.end-t,n=this.wrapper.scrollWidth-this.wrapper.clientWidth,s=this.util.withOrientation(this.wrapper.getBoundingClientRect(),this.vertical),this.isResizing=!1,this.isDragging=!1,"handle"===a.target.tagName.toLowerCase()?(this.isResizing=!0,i=a.target.classList.contains("wavesurfer-handle-start")?"start":"end"):(this.isDragging=!0,r=!0,i=!1))},p=t=>{t.touches&&t.touches.length>1||((r||i)&&(this.isDragging=!1,this.isResizing=!1,r=!1,a=null,i=!1),c&&(c=!1,this.util.preventClick(),this.fireEvent("update-end",t),this.wavesurfer.fireEvent("region-update-end",this,t)))},m=n=>{let h=this.wavesurfer.getDuration(),d=this.util.withOrientation(n,this.vertical),p=null;if(n.touches&&n.touches.length>1||n.targetTouches&&n.targetTouches[0].identifier!=e||!r&&!i)return;let m=this.regionsUtil.getRegionSnapToGridValue(this.wavesurfer.drawer.handleEvent(n)*h);if(r){let t=this.wavesurfer.getDuration();m>t-u&&(m=t-u),m-o<0&&(m=o)}if(i){let e=this.minLength;e||(e=0),"start"===i?(m>this.end-e&&(m=this.end-e),m<0&&(m=0)):"end"===i&&(m<this.start+e&&(p=(m=this.start+e)-(this.end+(m-t))),m>h&&(m=h))}if(p||(p=m-t),t=m,this.drag&&r&&(c=c||!!p,this.onDrag(p)),this.resize&&i&&(c=c||!!p,this.onResize(p,i)),this.scroll&&l.clientWidth<this.wrapper.scrollWidth){let t=d.clientX;(a=t<s.left+this.edgeScrollWidth?-1:t>s.right-this.edgeScrollWidth?1:null)&&f(n)}};this.element.addEventListener("mousedown",d),this.element.addEventListener("touchstart",d),document.body.addEventListener("mousemove",m),document.body.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("mouseup",p),document.body.addEventListener("touchend",p),this.on("remove",()=>{document.removeEventListener("mouseup",p),document.body.removeEventListener("touchend",p),document.body.removeEventListener("mousemove",m),document.body.removeEventListener("touchmove",m)}),this.wavesurfer.on("destroy",()=>{document.removeEventListener("mouseup",p),document.body.removeEventListener("touchend",p)})}onDrag(t){let e=this.wavesurfer.getDuration();this.end+t>e&&(t=e-this.end),this.start+t<0&&(t=-1*this.start);let r={direction:this._getDragDirection(t),action:"drag"};this.update({start:this.start+t,end:this.end+t},r)}_getDragDirection(t){return t<0?"left":t>0?"right":null}onResize(t,e){let r=this.wavesurfer.getDuration(),n={action:"resize",direction:"start"===e?"left":"right"};"start"===e?(t>0&&this.end-(this.start+t)<this.minLength&&(t=this.end-this.minLength-this.start),t<0&&this.end-(this.start+t)>this.maxLength&&(t=this.end-this.start-this.maxLength),t<0&&this.start+t<0&&(t=-1*this.start),this.update({start:Math.min(this.start+t,this.end),end:Math.max(this.start+t,this.end)},n)):(t<0&&this.end+t-this.start<this.minLength&&(t=this.start+this.minLength-this.end),t>0&&this.end+t-this.start>this.maxLength&&(t=this.maxLength-(this.end-this.start)),t>0&&this.end+t>r&&(t=r-this.end),this.update({start:Math.min(this.end+t,this.start),end:Math.max(this.end+t,this.start)},n))}onContentBlur(t){let{text:e}=this.data||{},r=t.target.innerText,n={...this.data,text:r};this.update({data:n},{action:"contentEdited",oldText:e,text:r})}onContentClick(t){t.stopPropagation()}onRemove(t){t.stopPropagation(),this.remove()}updateHandlesResize(t){let e;e=t?this.vertical?"row-resize":"col-resize":"auto",this.handleLeftEl&&this.style(this.handleLeftEl,{cursor:e}),this.handleRightEl&&this.style(this.handleRightEl,{cursor:e})}}class c{static create(t){return{name:"regions",deferInit:!!t&&!!t.deferInit&&t.deferInit,params:t,staticProps:{addRegion(t){return this.initialisedPluginList.regions||this.initPlugin("regions"),this.regions.add(t)},clearRegions(){this.regions&&this.regions.clear()},enableDragSelection(t){this.initialisedPluginList.regions||this.initPlugin("regions"),this.regions.enableDragSelection(t)},disableDragSelection(){this.regions.disableDragSelection()}},instance:c}}constructor(t,e){this.params=t,this.wavesurfer=e,this.util={...e.util,getRegionSnapToGridValue:e=>this.getRegionSnapToGridValue(e,t)},this.maxRegions=t.maxRegions,this.regionsMinLength=t.regionsMinLength||null,Object.getOwnPropertyNames(this.util.Observer.prototype).forEach(t=>{h.prototype[t]=this.util.Observer.prototype[t]}),this.wavesurfer.Region=h,this._onBackendCreated=()=>{this.wrapper=this.wavesurfer.drawer.wrapper,this.orientation=this.wavesurfer.drawer.orientation,this.defaultEdgeScrollWidth=.05*this.wrapper.clientWidth,this.params.regions&&this.params.regions.forEach(t=>{this.add(t)})},this.list={},this._onReady=()=>{this.wrapper=this.wavesurfer.drawer.wrapper,this.vertical=this.wavesurfer.drawer.params.vertical,this.params.dragSelection&&this.enableDragSelection(this.params),Object.keys(this.list).forEach(t=>{this.list[t].updateRender()})}}init(){this.wavesurfer.isReady?(this._onBackendCreated(),this._onReady()):(this.wavesurfer.once("ready",this._onReady),this.wavesurfer.once("backend-created",this._onBackendCreated))}destroy(){this.wavesurfer.un("ready",this._onReady),this.wavesurfer.un("backend-created",this._onBackendCreated),this.wavesurfer.setDisabledEventEmissions(["region-removed"]),this.disableDragSelection(),this.clear()}wouldExceedMaxRegions(){return this.maxRegions&&Object.keys(this.list).length>=this.maxRegions}add(t){if(this.wouldExceedMaxRegions())return null;!(t={edgeScrollWidth:this.params.edgeScrollWidth||this.defaultEdgeScrollWidth,contentEditable:this.params.contentEditable,removeButton:this.params.removeButton,...t}).formatTimeCallback&&this.params.formatTimeCallback&&(t={...t,formatTimeCallback:this.params.formatTimeCallback}),!t.minLength&&this.regionsMinLength&&(t={...t,minLength:this.regionsMinLength});let e=new this.wavesurfer.Region(t,this.util,this.wavesurfer);return this.list[e.id]=e,e.on("remove",()=>{delete this.list[e.id]}),e}clear(){Object.keys(this.list).forEach(t=>{this.list[t].remove()})}enableDragSelection(t){let e,r,n,i,a,s,o;this.disableDragSelection();let u=t.slop||2,l=this.wavesurfer.drawer.container,h=!1!==t.scroll&&this.wavesurfer.params.scrollParent,c=t.scrollSpeed||1,f=t.scrollThreshold||10,d=this.wavesurfer.getDuration(),p=0,m=t=>{if(!i||!s)return;let e=this.wrapper.scrollLeft+c*s;this.wrapper.scrollLeft=e=Math.min(r,Math.max(0,e));let a=this.wavesurfer.drawer.handleEvent(t);i.update({start:Math.min(a*d,n*d),end:Math.max(a*d,n*d)}),e<r&&e>0&&window.requestAnimationFrame(()=>{m(t)})},v=u=>{if(!u.touches||!(u.touches.length>1)){if(d=this.wavesurfer.getDuration(),a=u.targetTouches?u.targetTouches[0].identifier:null,r=this.wrapper.scrollWidth-this.wrapper.clientWidth,o=this.util.withOrientation(this.wrapper.getBoundingClientRect(),this.vertical),this.wavesurfer.params.splitChannels&&this.wavesurfer.params.splitChannelsOptions.splitDragSelection){let e=(u.touches?u.touches[0].clientY:u.clientY)-o.top,r=null!=this.wavesurfer.backend.buffer?this.wavesurfer.backend.buffer.numberOfChannels:1,n=Math.floor(e/(this.wrapper.clientHeight/r));t.channelIdx=n;let i=this.wavesurfer.params.splitChannelsOptions.channelColors[n];i&&i.dragColor&&(t.color=i.dragColor)}e=!0,n=this.wavesurfer.drawer.handleEvent(u,!0),i=null,s=null}};this.wrapper.addEventListener("mousedown",v),this.wrapper.addEventListener("touchstart",v),this.on("disable-drag-selection",()=>{this.wrapper.removeEventListener("touchstart",v),this.wrapper.removeEventListener("mousedown",v)});let g=t=>{t.touches&&t.touches.length>1||(e=!1,p=0,s=null,i&&(this.util.preventClick(),i.fireEvent("update-end",t),this.wavesurfer.fireEvent("region-update-end",i,t)),i=null)};this.wrapper.addEventListener("mouseleave",g),this.wrapper.addEventListener("mouseup",g),this.wrapper.addEventListener("touchend",g),document.body.addEventListener("mouseup",g),document.body.addEventListener("touchend",g),this.on("disable-drag-selection",()=>{document.body.removeEventListener("mouseup",g),document.body.removeEventListener("touchend",g),this.wrapper.removeEventListener("touchend",g),this.wrapper.removeEventListener("mouseup",g),this.wrapper.removeEventListener("mouseleave",g)});let y=r=>{if(!e||++p<=u||r.touches&&r.touches.length>1||r.targetTouches&&r.targetTouches[0].identifier!=a||!i&&!(i=this.add(t||{})))return;let c=this.wavesurfer.drawer.handleEvent(r),v=this.wavesurfer.regions.util.getRegionSnapToGridValue(n*d),g=this.wavesurfer.regions.util.getRegionSnapToGridValue(c*d);i.update({start:Math.min(g,v),end:Math.max(g,v)});let y=this.util.withOrientation(r,this.vertical);if(h&&l.clientWidth<this.wrapper.scrollWidth){let t=y.clientX-o.left;(s=t<=f?-1:t>=o.right-f?1:null)&&m(r)}};this.wrapper.addEventListener("mousemove",y),this.wrapper.addEventListener("touchmove",y),this.on("disable-drag-selection",()=>{this.wrapper.removeEventListener("touchmove",y),this.wrapper.removeEventListener("mousemove",y)}),this.wavesurfer.on("region-created",t=>{this.regionsMinLength&&(t.minLength=this.regionsMinLength)})}disableDragSelection(){this.fireEvent("disable-drag-selection")}getCurrentRegion(){let t=this.wavesurfer.getCurrentTime(),e=null;return Object.keys(this.list).forEach(r=>{let n=this.list[r];n.start<=t&&n.end>=t&&(!e||n.end-n.start<e.end-e.start)&&(e=n)}),e}getRegionSnapToGridValue(t,e){if(e.snapToGridInterval){let r=e.snapToGridOffset||0;return Math.round((t-r)/e.snapToGridInterval)*e.snapToGridInterval+r}return t}}class f{static create(t){return{name:"timeline",deferInit:!!t&&!!t.deferInit&&t.deferInit,params:t,instance:f}}_onScroll=()=>{this.wrapper&&this.drawer.wrapper&&(this.wrapper.scrollLeft=this.drawer.wrapper.scrollLeft)};_onRedraw=()=>this.render();_onReady=()=>{let t=this.wavesurfer;this.drawer=t.drawer,this.pixelRatio=t.drawer.params.pixelRatio,this.maxCanvasWidth=t.drawer.maxCanvasWidth||t.drawer.width,this.maxCanvasElementWidth=t.drawer.maxCanvasElementWidth||Math.round(this.maxCanvasWidth/this.pixelRatio),t.drawer.wrapper.addEventListener("scroll",this._onScroll),t.on("redraw",this._onRedraw),t.on("zoom",this._onZoom),this.render()};_onWrapperClick=t=>{t.preventDefault();let e="offsetX"in t?t.offsetX:t.layerX;this.fireEvent("click",e/this.wrapper.scrollWidth||0)};constructor(t,e){if(this.container="string"==typeof t.container?document.querySelector(t.container):t.container,!this.container)throw Error("No container for wavesurfer timeline");this.wavesurfer=e,this.util=e.util,this.params=Object.assign({},{height:20,notchPercentHeight:90,labelPadding:5,unlabeledNotchColor:"#c0c0c0",primaryColor:"#000",secondaryColor:"#c0c0c0",primaryFontColor:"#000",secondaryFontColor:"#000",fontFamily:"Arial",fontSize:10,duration:null,zoomDebounce:!1,formatTimeCallback:this.defaultFormatTimeCallback,timeInterval:this.defaultTimeInterval,primaryLabelInterval:this.defaultPrimaryLabelInterval,secondaryLabelInterval:this.defaultSecondaryLabelInterval,offset:0},t),this.canvases=[],this.wrapper=null,this.drawer=null,this.pixelRatio=null,this.maxCanvasWidth=null,this.maxCanvasElementWidth=null,this._onZoom=this.params.zoomDebounce?this.wavesurfer.util.debounce(()=>this.render(),this.params.zoomDebounce):()=>this.render()}init(){this.wavesurfer.isReady?this._onReady():this.wavesurfer.once("ready",this._onReady)}destroy(){this.unAll(),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.un("zoom",this._onZoom),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.removeEventListener("click",this._onWrapperClick),this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}createWrapper(){let t=this.wavesurfer.params;this.container.innerHTML="",this.wrapper=this.container.appendChild(document.createElement("timeline")),this.util.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:`${this.params.height}px`}),(t.fillParent||t.scrollParent)&&this.util.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this.wrapper.addEventListener("click",this._onWrapperClick)}render(){this.wrapper||this.createWrapper(),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}addCanvas(){let t=this.wrapper.appendChild(document.createElement("canvas"));this.canvases.push(t),this.util.style(t,{position:"absolute",zIndex:4})}removeCanvas(){let t=this.canvases.pop();t.parentElement.removeChild(t)}updateCanvases(){let t=Math.ceil(Math.round(this.drawer.wrapper.scrollWidth)/this.maxCanvasElementWidth);for(;this.canvases.length<t;)this.addCanvas();for(;this.canvases.length>t;)this.removeCanvas()}updateCanvasesPositioning(){let t=this.canvases.length;this.canvases.forEach((e,r)=>{let n=r===t-1?this.drawer.wrapper.scrollWidth-this.maxCanvasElementWidth*(t-1):this.maxCanvasElementWidth;e.width=n*this.pixelRatio,e.height=(this.params.height+1)*this.pixelRatio,this.util.style(e,{width:`${n}px`,height:`${this.params.height}px`,left:`${r*this.maxCanvasElementWidth}px`})})}renderCanvases(){let t;let e=this.params.duration||this.wavesurfer.backend.getDuration();if(e<=0)return;let r=this.wavesurfer.params,n=this.params.fontSize*r.pixelRatio,i=parseInt(e,10)+1,a=r.fillParent&&!r.scrollParent?this.drawer.getWidth():this.drawer.wrapper.scrollWidth*r.pixelRatio,s=this.params.height*this.pixelRatio,o=this.params.height*(this.params.notchPercentHeight/100)*this.pixelRatio,u=a/e,l=this.params.formatTimeCallback,h=t=>"function"==typeof t?t(u):t,c=h(this.params.timeInterval),f=h(this.params.primaryLabelInterval),d=h(this.params.secondaryLabelInterval),p=u*this.params.offset,m=0,v=[],g=this.params.offset<0?i-this.params.offset:i;for(t=0;t<g/c;t++)v.push([t,m,p]),m+=c,p+=u*c;let y=t=>{v.forEach(e=>{t(e[0],e[1],e[2])})};this.setFillStyles(this.params.primaryColor),this.setFonts(`${n}px ${this.params.fontFamily}`),this.setFillStyles(this.params.primaryFontColor),y((t,e,r)=>{t%f==0&&(this.fillRect(r,0,1,s),this.fillText(l(e,u),r+this.params.labelPadding*this.pixelRatio,s))}),this.setFillStyles(this.params.secondaryColor),this.setFonts(`${n}px ${this.params.fontFamily}`),this.setFillStyles(this.params.secondaryFontColor),y((t,e,r)=>{t%d==0&&(this.fillRect(r,0,1,s),this.fillText(l(e,u),r+this.params.labelPadding*this.pixelRatio,s))}),this.setFillStyles(this.params.unlabeledNotchColor),y((t,e,r)=>{t%d!=0&&t%f!=0&&this.fillRect(r,0,1,o)})}setFillStyles(t){this.canvases.forEach(e=>{let r=e.getContext("2d");r&&(r.fillStyle=t)})}setFonts(t){this.canvases.forEach(e=>{let r=e.getContext("2d");r&&(r.font=t)})}fillRect(t,e,r,n){this.canvases.forEach((i,a)=>{let s=a*this.maxCanvasWidth,o={x1:Math.max(t,a*this.maxCanvasWidth),y1:e,x2:Math.min(t+r,a*this.maxCanvasWidth+i.width),y2:e+n};if(o.x1<o.x2){let t=i.getContext("2d");t&&t.fillRect(o.x1-s,o.y1,o.x2-o.x1,o.y2-o.y1)}})}fillText(t,e,r){let n;let i=0;this.canvases.forEach(a=>{let s=a.getContext("2d");if(s){let a=s.canvas.width;if(i>e+n)return;i+a>e&&s&&(n=s.measureText(t).width,s.fillText(t,e-i,r)),i+=a}})}defaultFormatTimeCallback(t,e){if(t/60>1){let e=parseInt(t/60,10);return t=(t=parseInt(t%60,10))<10?"0"+t:t,`${e}:${t}`}return Math.round(1e3*t)/1e3}defaultTimeInterval(t){return t>=25?1:5*t>=25?5:15*t>=25?15:60*Math.ceil(.5/t)}defaultPrimaryLabelInterval(t){return t>=25?10:5*t>=25?6:4}defaultSecondaryLabelInterval(t){return t>=25?5:2}}class d{static create(t){return{name:"cursor",deferInit:!!t&&!!t.deferInit&&t.deferInit,params:t,staticProps:{},instance:d}}defaultParams={hideOnBlur:!0,width:"1px",color:"black",opacity:"0.25",style:"solid",zIndex:4,customStyle:{},customShowTimeStyle:{},showTime:!1,followCursorY:!1,formatTimeCallback:null};_onMousemove=t=>{let e=this.util.withOrientation(t,this.wavesurfer.params.vertical),r=this.wrapper.getBoundingClientRect(),n=0,i=this.wrapper.scrollLeft+e.clientX-r.left,a=this.displayTime?this.displayTime.getBoundingClientRect().width:0,s=r.right<e.clientX+a;this.params.showTime&&this.params.followCursorY&&(n=e.clientY-(r.top+r.height/2)),this.updateCursorPosition(i,n,s)};_onMouseenter=()=>this.showCursor();_onMouseleave=()=>this.hideCursor();constructor(t,e){this.wavesurfer=e,this.style=e.util.style,this.util=e.util,this.cursor=null,this.showTime=null,this.displayTime=null,this.isDestroyCalled=!1,this.params=Object.assign({},this.defaultParams,t)}_onReady(){!this.isDestroyCalled&&(this.wrapper=this.wavesurfer.drawer.wrapper,this.cursor=this.util.withOrientation(this.wrapper.appendChild(document.createElement("cursor")),this.wavesurfer.params.vertical),this.style(this.cursor,Object.assign({position:"absolute",zIndex:this.params.zIndex,left:0,top:0,bottom:0,width:"0",display:"flex",borderRightStyle:this.params.style,borderRightWidth:this.params.width,borderRightColor:this.params.color,opacity:this.params.opacity,pointerEvents:"none"},this.params.customStyle)),this.params.showTime&&(this.showTime=this.util.withOrientation(this.wrapper.appendChild(document.createElement("showTitle")),this.wavesurfer.params.vertical),this.style(this.showTime,Object.assign({position:"absolute",zIndex:this.params.zIndex,left:0,top:0,bottom:0,width:"auto",display:"flex",opacity:this.params.opacity,pointerEvents:"none",height:"100%"},this.params.customStyle)),this.displayTime=this.util.withOrientation(this.showTime.appendChild(document.createElement("div")),this.wavesurfer.params.vertical),this.style(this.displayTime,Object.assign({display:"inline",pointerEvents:"none",margin:"auto",visibility:"hidden"},this.params.customShowTimeStyle)),this.displayTime.innerHTML=this.formatTime(0)),this.wrapper.addEventListener("mousemove",this._onMousemove),this.params.hideOnBlur&&(this.hideCursor(),this.wrapper.addEventListener("mouseenter",this._onMouseenter),this.wrapper.addEventListener("mouseleave",this._onMouseleave)))}init(){this.wavesurfer.isReady?this._onReady():this.wavesurfer.once("ready",()=>this._onReady())}destroy(){if(!this.cursorTime||!this.showTime){this.isDestroyCalled=!0;return}this.params.showTime&&this.showTime&&this.showTime.remove(),this.cursor&&this.cursor.remove(),this.wrapper.removeEventListener("mousemove",this._onMousemove),this.params.hideOnBlur&&(this.wrapper.removeEventListener("mouseenter",this._onMouseenter),this.wrapper.removeEventListener("mouseleave",this._onMouseleave))}updateCursorPosition(t,e,r=!1){if(this.style(this.cursor,{left:`${t}px`}),this.params.showTime){let n=this.wavesurfer.getDuration(),i=this.wavesurfer.drawer.width/this.wavesurfer.params.pixelRatio,a=this.wavesurfer.drawer.getScrollX(),s=n/this.wavesurfer.drawer.width*a,o=Math.max(0,(t-this.wrapper.scrollLeft)/i*n)+s,u=this.formatTime(o);if(r){let e=this.displayTime.getBoundingClientRect().width;t-=e}this.style(this.showTime,{left:`${t}px`,top:`${e}px`}),this.style(this.displayTime,{visibility:"visible"}),this.displayTime.innerHTML=`${u}`}}showCursor(){this.style(this.cursor,{display:"flex"}),this.params.showTime&&this.style(this.showTime,{display:"flex"})}hideCursor(){this.style(this.cursor,{display:"none"}),this.params.showTime&&this.style(this.showTime,{display:"none"})}formatTime(t){return(t=isNaN(t)?0:t,this.params.formatTimeCallback)?this.params.formatTimeCallback(t):[t].map(t=>[Math.floor(t%3600/60),("00"+Math.floor(t%60)).slice(-2),("000"+Math.floor(t%1*1e3)).slice(-3)].join(":"))}}var p={};"undefined"!=typeof self&&self,p=(()=>{var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var n,i,a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,(n=s.key,i=void 0,i=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n,"string"),"symbol"===r(i)?i:String(i)),s)}}t.r(e),t.d(e,{default:()=>s});var s=function(){var t,e;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.sampleRate;(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,r),this._context=this._createContext(e),e||(e=this._context.sampleRate),this._sampleRate=e}return t=[{key:"_createContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:44100;return window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,new AudioContext({sampleRate:t})}},{key:"context",get:function(){return this._context}},{key:"fetchAudio",value:async function(){for(var t=this,e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return await Promise.all(r.map(async function(e){var r;return r=e instanceof File||e instanceof Blob?await e.arrayBuffer():await fetch(e).then(function(t){return t.headers.has("Content-Type")&&!t.headers.get("Content-Type").includes("audio/")&&console.warn("Crunker: Attempted to fetch an audio file, but its MIME type is `".concat(t.headers.get("Content-Type").split(";")[0],"`. We'll try and continue anyway. (file: \"").concat(e,'")')),t.arrayBuffer()}),await t._context.decodeAudioData(r)}))}},{key:"mergeAudio",value:function(t){var e=this._context.createBuffer(this._maxNumberOfChannels(t),this._sampleRate*this._maxDuration(t),this._sampleRate);return t.forEach(function(t){for(var r=0;r<t.numberOfChannels;r++){for(var n=e.getChannelData(r),i=t.getChannelData(r),a=t.getChannelData(r).length-1;a>=0;a--)n[a]+=i[a];e.getChannelData(r).set(n)}}),e}},{key:"concatAudio",value:function(t){var e=this._context.createBuffer(this._maxNumberOfChannels(t),this._totalLength(t),this._sampleRate),r=0;return t.forEach(function(t){for(var n=0;n<t.numberOfChannels;n++)e.getChannelData(n).set(t.getChannelData(n),r);r+=t.length}),e}},{key:"padAudio",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===r)return t;if(e<0)throw Error('Crunker: Parameter "padStart" in padAudio must be positive');if(r<0)throw Error('Crunker: Parameter "seconds" in padAudio must be positive');for(var n=this._context.createBuffer(t.numberOfChannels,Math.ceil(t.length+r*t.sampleRate),t.sampleRate),i=0;i<t.numberOfChannels;i++){var a=t.getChannelData(i);n.getChannelData(i).set(a.subarray(0,Math.ceil(e*t.sampleRate)+1),0),n.getChannelData(i).set(a.subarray(Math.ceil(e*t.sampleRate)+2,n.length+1),Math.ceil((e+r)*t.sampleRate))}return n}},{key:"sliceAudio",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(e>=r)throw Error('Crunker: "start" time should be less than "end" time in sliceAudio method');for(var a=Math.round((r-e)*this._sampleRate),s=Math.round(e*this._sampleRate),o=this._context.createBuffer(t.numberOfChannels,a,this._sampleRate),u=0;u<t.numberOfChannels;u++)for(var l=t.getChannelData(u),h=o.getChannelData(u),c=0;c<a;c++)h[c]=l[s+c],c<n*this._sampleRate&&(h[c]*=c/(n*this._sampleRate)),c>a-i*this._sampleRate&&(h[c]*=(a-c)/(i*this._sampleRate));return o}},{key:"play",value:function(t){var e=this._context.createBufferSource();return e.buffer=t,e.connect(this._context.destination),e.start(),e}},{key:"export",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio/wav",r=this._interleave(t),n=new Blob([this._writeHeaders(r,t.numberOfChannels,t.sampleRate)],{type:e});return{blob:n,url:this._renderURL(n),element:this._renderAudioElement(n)}}},{key:"download",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"crunker",r=document.createElement("a");return r.style.display="none",r.href=this._renderURL(t),r.download="".concat(e,".").concat(t.type.split("/")[1]),r.click(),r}},{key:"notSupported",value:function(t){return this._isSupported()?void 0:t()}},{key:"close",value:function(){return this._context.close(),this}},{key:"_maxDuration",value:function(t){return Math.max.apply(Math,n(t.map(function(t){return t.duration})))}},{key:"_maxNumberOfChannels",value:function(t){return Math.max.apply(Math,n(t.map(function(t){return t.numberOfChannels})))}},{key:"_totalLength",value:function(t){return t.map(function(t){return t.length}).reduce(function(t,e){return t+e},0)}},{key:"_isSupported",value:function(){return"AudioContext"in window||"webkitAudioContext"in window||"mozAudioContext"in window}},{key:"_writeHeaders",value:function(t,e,r){var n=2*e,i=2*t.length,a=36+i,s=new DataView(new ArrayBuffer(8+a));return this._writeString(s,0,"RIFF"),s.setUint32(4,a,!0),this._writeString(s,8,"WAVE"),this._writeString(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,e,!0),s.setUint32(24,r,!0),s.setUint32(28,r*n,!0),s.setUint16(32,n,!0),s.setUint16(34,16,!0),this._writeString(s,36,"data"),s.setUint32(40,i,!0),this._floatTo16BitPCM(s,t,44)}},{key:"_floatTo16BitPCM",value:function(t,e,r){for(var n=0;n<e.length;n++,r+=2){var i=Math.max(-1,Math.min(1,e[n]));t.setInt16(r,i<0?32768*i:32767*i,!0)}return t}},{key:"_writeString",value:function(t,e,r){for(var n=0;n<r.length;n++)t.setUint8(e+n,r.charCodeAt(n))}},{key:"_interleave",value:function(t){if(1===t.numberOfChannels)return t.getChannelData(0);for(var e=[],r=0;r<t.numberOfChannels;r++)e.push(t.getChannelData(r));for(var n=e.reduce(function(t,e){return t+e.length},0),i=new Float32Array(n),a=0,s=0;a<n;)e.forEach(function(t){i[a++]=t[s]}),s++;return i}},{key:"_renderAudioElement",value:function(t){var e=document.createElement("audio");return e.controls=!0,e.src=this._renderURL(t),e}},{key:"_renderURL",value:function(t){return(window.URL||window.webkitURL).createObjectURL(t)}}],a(r.prototype,t),e&&a(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}();return e})();class m{constructor(t){this.morphaweb=t,this.overlay=document.getElementById("overlay"),this.messageOverlay=document.getElementById("message-overlay"),this.messageText=document.getElementById("message-text"),this.crunker=null,document.addEventListener("dragover",this.allowDrop.bind(this)),document.addEventListener("drop",this.onDrop.bind(this))}allowDrop(t){this.overlayShow(),t.preventDefault()}showMessage(t,e=1e4){this.messageText.textContent=t,this.messageOverlay.classList.add("show"),setTimeout(()=>{this.messageOverlay.classList.remove("show")},e)}showTruncationDialog(t,e,r){return new Promise(n=>{let i=Math.round(e/60*10)/10,a=Math.round(r/60*10)/10;n(confirm(`The file "${t}" is ${i} minutes long, which exceeds the recommended maximum of ${a} minutes for Makenoise Morphagene.

Do you want to:
- Truncate to ${a} minutes (recommended)
- Keep the full file (may cause performance issues)

Click OK to truncate, Cancel to keep full file.`))})}getOriginalSampleRate(t){try{let e=new DataView(t),r=String.fromCharCode(e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3));if("RIFF"!==r)return console.log("Not a WAV file, cannot detect original sample rate"),null;let n=String.fromCharCode(e.getUint8(8),e.getUint8(9),e.getUint8(10),e.getUint8(11));if("WAVE"!==n)return console.log("Not a valid WAV file"),null;return e.getUint32(24,!0)}catch(t){return console.error("Error reading WAV header:",t),null}}async loadFiles(t){let e;let r=[],n=[],a=0,s=null,o=[...t].map(async t=>{console.log(t),await t.arrayBuffer().then(async o=>(e=new AudioContext({sampleRate:(s=this.getOriginalSampleRate(o))||44100}),await e.decodeAudioData(o).then(async o=>{if(console.log("=== LOAD DEBUG INFO ==="),console.log("Loaded file:",t.name),console.log(`Sample rate (from header): ${s} Hz`),console.log(`AudioContext decoded sample rate: ${o.sampleRate} Hz`),console.log(`Audio channels: ${o.numberOfChannels}`),console.log(`Buffer length: ${o.length}`),console.log(`Audio duration: ${o.duration} seconds`),console.log(`AudioContext sample rate: ${e.sampleRate}`),0===r.length){let t=s||o.sampleRate;this.morphaweb.wavHandler.setOriginalSampleRate(t),this.crunker=new/*@__PURE__*/(i(p))({sampleRate:t}),console.log(`Crunker initialized with sample rate: ${t}`)}if(console.log("========================"),o.duration>174){if(await this.showTruncationDialog(t.name,o.duration,174)){let r=e.createBuffer(o.numberOfChannels,Math.floor(174*o.sampleRate),o.sampleRate);for(let t=0;t<o.numberOfChannels;t++)r.copyToChannel(o.getChannelData(t).slice(0,Math.floor(174*o.sampleRate)),t);this.showMessage(`Audio file "${t.name}" has been truncated to 2.9 minutes.`),o=r}else this.showMessage(`Loading full file "${t.name}" (${Math.round(o.duration/60*10)/10} minutes). This may not work on Morphagene.`,5e3)}let u=await this.morphaweb.wavHandler.getMarkersFromFile(t);u=u.map((t,e)=>(t.position+=a,t)),n.push(...u),n.push({position:1e3*o.duration}),a+=1e3*o.duration,r.push(o)},()=>{this.morphaweb.track("ErrorFileUploadMarkers")})),()=>{this.morphaweb.track("ErrorFileUpload")})});await Promise.all(o),n.pop(),this.crunker||(this.crunker=new/*@__PURE__*/(i(p))({sampleRate:44100}),console.log("Fallback: Crunker initialized with 44100 Hz"));let u=this.crunker.concatAudio(r);return{blob:this.crunker.export(u,"audio/wav").blob,markers:n,sampleRate:s}}onDrop(t){t.preventDefault(),this.overlayHide(),this.morphaweb.wavesurfer.clearMarkers(),this.loadFiles(t.dataTransfer.files).then(t=>{this.morphaweb.wavesurfer.loadBlob(t.blob),this.morphaweb.wavesurfer.sampleRate=t.sampleRate,this.morphaweb.wavHandler.markers=t.markers})}loadFilesFromInput(t){return this.overlayHide(),this.loadFiles(t)}overlayShow(){this.overlay.style.display="block"}overlayHide(){this.overlay.style.display="none"}}var v=o("1WSnx");class g{constructor(t){this.morphaweb=t,this.playButton=document.getElementById("play"),this.zoomSlider=document.querySelector('input[type="range"]'),this.exportButton=document.getElementById("export"),this.resetButton=document.getElementById("reset"),this.exportFormatDropdown=document.getElementById("export-format-dropdown"),this.exportFormatOptions=document.getElementById("export-format-options"),this.exportFormatDisplay=document.getElementById("export-format-display"),this.sliceButton=document.getElementById("auto-slice"),this.sliceCountInput=document.getElementById("slice-count"),this.detectOnsetsButton=document.getElementById("detect-onsets"),this.divideMarkersButton=document.getElementById("divide-markers"),this.createCropRegionButton=document.getElementById("create-crop-region"),this.cropAudioButton=document.getElementById("crop-audio"),this.clearCropRegionButton=document.getElementById("clear-crop-region"),this.createFadeInRegionButton=document.getElementById("create-fade-in-region"),this.createFadeOutRegionButton=document.getElementById("create-fade-out-region"),this.applyFadesButton=document.getElementById("apply-fades"),this.clearFadeRegionsButton=document.getElementById("clear-fade-regions"),this.waveform=document.getElementById("waveform"),this.waveformLoadOverlay=document.getElementById("waveform-load-overlay"),this.waveformFileInput=document.getElementById("waveform-file-input"),this.cropRegion=null,this.fadeInRegion=null,this.fadeOutRegion=null,this.selectedExportFormat="stereo-32-48000",this.messageTimeout=null,this.setButtonsState(!0),this.exportButton.addEventListener("click",this.exportWavFile),this.resetButton.addEventListener("click",this.resetAudio),this.exportFormatDropdown.addEventListener("click",this.toggleExportFormatDropdown),this.playButton.addEventListener("click",this.playToggle),this.sliceButton.addEventListener("click",this.handleAutoSlice),this.detectOnsetsButton.addEventListener("click",this.handleOnsetDetection),this.divideMarkersButton.addEventListener("click",this.divideMarkersByTwo),this.sliceCountInput.addEventListener("input",this.validateSliceCount),this.createCropRegionButton.addEventListener("click",this.createCropRegion),this.cropAudioButton.addEventListener("click",this.cropToSelection),this.clearCropRegionButton.addEventListener("click",this.clearCropRegion),this.createFadeInRegionButton.addEventListener("click",this.createFadeInRegion),this.createFadeOutRegionButton.addEventListener("click",this.createFadeOutRegion),this.applyFadesButton.addEventListener("click",this.applyFades),this.clearFadeRegionsButton.addEventListener("click",this.clearFadeRegions),this.zoomSlider.addEventListener("input",t=>{let e=t.target.valueAsNumber;this.morphaweb.wavesurfer.zoom(e),this.morphaweb.updateZoomDisplay()}),this.exportFormatOptions.addEventListener("click",t=>{t.target.classList.contains("dropdown-item")&&this.selectExportFormat(t.target.dataset.format)}),document.addEventListener("click",t=>{t.target.closest(".dropdown")||this.closeExportFormatDropdown()}),document.addEventListener("keydown",this.onKeydown.bind(this)),this.morphaweb.wavesurfer.on("seek",this.onSeek.bind(this)),this.morphaweb.wavesurfer.on("finish",this.onFinish.bind(this)),this.morphaweb.wavesurfer.on("ready",()=>{this.setButtonsState(!1),this.clearCropRegion(),this.clearFadeRegions(),this.morphaweb.updateAllDisplays()}),window.addEventListener("wheel",(0,v.throttle)(this.onWheel.bind(this),10),{passive:!1}),window.addEventListener("keydown",function(t){"Space"===t.code&&t.target==document.body&&t.preventDefault()}),document.addEventListener("markers-changed",this.updateDivideButton.bind(this)),this.updateDivideButton(),this.validateSliceCount(),this.waveformLoadOverlay.addEventListener("click",()=>{this.waveformFileInput.click()}),this.waveformFileInput.addEventListener("change",t=>{t.target.files&&t.target.files.length>0&&(this.morphaweb.dropHandler.overlayHide(),this.morphaweb.dropHandler.loadFiles(t.target.files).then(t=>{this.morphaweb.wavesurfer.loadBlob(t.blob),this.morphaweb.wavHandler.markers=t.markers}))}),this.morphaweb.wavesurfer.on("ready",()=>{this.hideWaveformLoadOverlay()}),this.morphaweb.wavesurfer.on("destroy",()=>{this.showWaveformLoadOverlay()}),this.morphaweb.wavesurfer.backend&&this.morphaweb.wavesurfer.backend.buffer||this.showWaveformLoadOverlay(),this.updateExportFormatDisplay(),this.updateDropdownSelection()}setButtonsState=t=>{this.playButton.disabled=t,this.exportButton.disabled=t,this.sliceButton.disabled=t,this.detectOnsetsButton.disabled=t,this.sliceCountInput.disabled=t,this.createCropRegionButton.disabled=t,this.createFadeInRegionButton.disabled=t,this.createFadeOutRegionButton.disabled=t,this.resetButton.disabled=t,this.exportFormatDropdown.disabled=t};toggleExportFormatDropdown=t=>{t.stopPropagation(),"block"===this.exportFormatOptions.style.display?this.closeExportFormatDropdown():this.openExportFormatDropdown()};openExportFormatDropdown=()=>{this.exportFormatOptions.style.display="block",this.updateDropdownSelection()};closeExportFormatDropdown=()=>{this.exportFormatOptions.style.display="none"};selectExportFormat=t=>{this.selectedExportFormat=t,this.updateExportFormatDisplay(),this.updateDropdownSelection(),this.closeExportFormatDropdown()};updateExportFormatDisplay=()=>{let t=this.selectedExportFormat||"stereo-32-48000";this.exportFormatDisplay.textContent=({"stereo-32-48000":"(stereo, 32-bit, 48KHz)","stereo-16-48000":"(stereo, 16-bit, 48KHz)","stereo-16-44100":"(stereo, 16-bit, 44.1KHz)","mono-16-48000":"(mono, 16-bit, 48KHz)","mono-16-44100":"(mono, 16-bit, 44.1KHz)","stereo-24-48000":"(stereo, 24-bit, 48KHz)","stereo-24-44100":"(stereo, 24-bit, 44.1KHz)"})[t]||"(stereo, 32-bit, 48KHz)"};updateDropdownSelection=()=>{this.exportFormatOptions.querySelectorAll(".dropdown-item").forEach(t=>{t.classList.remove("selected")});let t=this.selectedExportFormat||"stereo-32-48000",e=this.exportFormatOptions.querySelector(`[data-format="${t}"]`);e&&e.classList.add("selected")};parseExportFormat=t=>{let e=(t||this.selectedExportFormat||"stereo-32-48000").split("-");return{channels:"mono"===e[0]?1:2,bitDepth:parseInt(e[1]),sampleRate:parseInt(e[2])}};validateSliceCount=()=>{let t=parseInt(this.sliceCountInput.value),e=parseInt(this.sliceCountInput.min);(isNaN(t)||t<e)&&(this.sliceCountInput.value=e),this.sliceButton.disabled=isNaN(t)||t<e||0===this.morphaweb.wavesurfer.getDuration()};exportWavFile=async()=>{try{if(0===this.morphaweb.wavesurfer.getDuration())return!1;this.showMessage("Processing export... Please wait.",1e4);let t=this.exportButton.querySelector(".text-2xl");t.textContent,t.textContent="exporting...",this.exportButton.disabled=!0,this.exportFormatDropdown.disabled=!0,await new Promise(t=>setTimeout(t,100));let e=this.morphaweb.wavesurfer.backend.buffer;this.morphaweb.wavHandler.setOriginalSampleRate(e.sampleRate);let r=[e.getChannelData(0)];try{r.push(e.getChannelData(1))}catch(t){r.push(e.getChannelData(0)),console.log("No second channel")}let n=this.morphaweb.wavesurfer.markers.markers,i=this.parseExportFormat(this.selectedExportFormat);await this.morphaweb.wavHandler.createFileFromBuffer(r,n,i),await new Promise(t=>setTimeout(t,500)),this.showMessage("Export completed successfully!",3e3)}catch(t){console.log(t),this.morphaweb.track("ErrorExportWavFile"),this.showMessage("Error exporting file. Please try again.")}finally{this.exportButton.querySelector(".text-2xl").textContent="export reel",this.exportButton.disabled=!1,this.exportFormatDropdown.disabled=!1}};playToggle=()=>{let t=document.getElementById("play");this.morphaweb.wavesurfer.isPlaying()?(this.morphaweb.wavesurfer.pause(),t.textContent="⏸ play/pause"):(this.morphaweb.wavesurfer.play(),t.textContent="⏵ play/pause")};onSeek=t=>{this.morphaweb.playOffset=t,this.morphaweb.markerHandler.removeTopMarker("top"),this.morphaweb.markerHandler.createMarker(this.morphaweb.playOffset*this.morphaweb.wavesurfer.getDuration(),"top")};onFinish=()=>{this.morphaweb.wavesurfer.seekTo(0),this.morphaweb.wavesurfer.play()};onWheel=t=>{let e=document.getElementById("waveform"),r=!1;if(e&&(r=e.contains(t.target)||t.target===e||null!==t.target.closest("#waveform")),r)return t.preventDefault(),t.stopPropagation(),this.morphaweb.scrollPos+t.deltaY>=this.morphaweb.scrollMin&&(this.morphaweb.scrollPos=this.morphaweb.scrollPos+t.deltaY,this.morphaweb.wavesurfer.zoom(this.morphaweb.scrollPos),this.zoomSlider&&(this.zoomSlider.value=this.morphaweb.scrollPos),this.morphaweb.updateZoomDisplay()),!1};onKeydown=t=>{switch(t.key){case"j":case"J":this.morphaweb.markerHandler.createMarkerAtCurrentPosition();break;case"k":case"K":this.morphaweb.markerHandler.removeSelectedMarker();break;case" ":this.playToggle();break;case"c":case"C":this.createCropRegionButton.disabled||this.createCropRegion();break;case"x":case"X":this.cropAudioButton.disabled||this.cropToSelection();break;case"Escape":this.clearCropRegionButton.disabled||this.clearCropRegion();break;case"f":case"F":this.createFadeInRegionButton.disabled||this.createFadeInRegion();break;case"g":case"G":this.createFadeOutRegionButton.disabled||this.createFadeOutRegion();break;case"a":case"A":this.applyFadesButton.disabled||this.applyFades();break;case"\\":this.resetButton.disabled||this.resetAudio()}};handleAutoSlice=()=>{if(0===this.morphaweb.wavesurfer.getDuration())return!1;let t=parseInt(this.sliceCountInput.value);this.morphaweb.markerHandler.clearAllMarkers(),this.morphaweb.markerHandler.createAutoSlices(t),this.morphaweb.track("AutoSlice")};handleOnsetDetection=()=>{try{if(0===this.morphaweb.wavesurfer.getDuration())return!1;this.morphaweb.detectOnsets(),this.morphaweb.track("OnsetDetection")}catch(t){this.morphaweb.track("ErrorOnsetDetection")}};updateDivideButton=t=>{let e=this.morphaweb.markerHandler.getBottomMarkers().length;this.divideMarkersButton.disabled=e<2};divideMarkersByTwo=()=>{try{if(!this.morphaweb.markerHandler.hasEnoughMarkers())return;this.morphaweb.markerHandler.divideMarkersByTwo(),this.morphaweb.track("DivideMarkersByTwo")}catch(t){this.morphaweb.track("ErrorDivideMarkersByTwo")}};createCropRegion=()=>{try{if(0===this.morphaweb.wavesurfer.getDuration())return!1;this.clearCropRegion();let t=this.morphaweb.wavesurfer.getDuration();this.cropRegion=this.morphaweb.wavesurfer.addRegion({start:.25*t,end:.75*t,color:"rgba(255, 208, 0, 0.3)",drag:!0,resize:!0,id:"crop-region"}),this.cropAudioButton.disabled=!1,this.clearCropRegionButton.disabled=!1,this.createCropRegionButton.disabled=!0,this.cropRegion.on("update-end",()=>{this.showMessage(`Crop region: ${this.formatTime(this.cropRegion.start)} - ${this.formatTime(this.cropRegion.end)}`),this.morphaweb.updateRegionDisplays()}),this.showMessage("Crop region created. Drag edges to adjust selection."),this.morphaweb.updateRegionDisplays(),this.morphaweb.track("CreateCropRegion")}catch(t){this.morphaweb.track("ErrorCreateCropRegion"),console.error("Error creating crop region:",t)}};cropToSelection=()=>{try{if(!this.cropRegion||0===this.morphaweb.wavesurfer.getDuration())return!1;let t=this.cropRegion.start,e=this.cropRegion.end;if(t>=e){this.showMessage("Invalid crop region: start time must be before end time");return}let r=this.morphaweb.wavesurfer.backend.buffer,n=r.sampleRate,i=r.numberOfChannels,a=r.getChannelData(0),s=Math.floor(t*n),o=Math.floor(e*n),u=this.findNearestZeroCrossing(a,s),l=this.findNearestZeroCrossing(a,o),h=l-u,c=Math.abs(u-s)/n*1e3,f=Math.abs(l-o)/n*1e3;console.log(`Zero crossing adjustments - Start: ${c.toFixed(2)}ms, End: ${f.toFixed(2)}ms`);let d=this.morphaweb.wavesurfer.backend.ac.createBuffer(i,h,n);for(let t=0;t<i;t++){let e=r.getChannelData(t),n=d.getChannelData(t);for(let t=0;t<h;t++)n[t]=e[u+t]}this.morphaweb.wavesurfer.loadDecodedBuffer(d);let p=u/n,m=l/n;this.adjustMarkersForCrop(p,m),this.clearCropRegion();let v=c>1||f>1?` (adjusted ${c.toFixed(1)}ms/${f.toFixed(1)}ms to prevent clicks)`:" (snapped to zero crossings)";this.showMessage(`Audio cropped from ${this.formatTime(p)} to ${this.formatTime(m)}${v}`),this.morphaweb.updateDurationDisplay(),this.morphaweb.track("CropAudio")}catch(t){this.morphaweb.track("ErrorCropAudio"),console.error("Error cropping audio:",t),this.showMessage("Error cropping audio. Please try again.")}};clearCropRegion=()=>{try{this.cropRegion&&(this.cropRegion.remove(),this.cropRegion=null),this.cropAudioButton.disabled=!0,this.clearCropRegionButton.disabled=!0,this.createCropRegionButton.disabled=!1,this.morphaweb.updateRegionDisplays(),this.morphaweb.track("ClearCropRegion")}catch(t){this.morphaweb.track("ErrorClearCropRegion"),console.error("Error clearing crop region:",t)}};findNearestZeroCrossing(t,e,r=1e3){let n=Math.max(0,e-r),i=Math.min(t.length-1,e+r);for(let a=0;a<=r;a++){let r=e+a;if(r<=i&&this.isZeroCrossing(t,r))return r;let s=e-a;if(s>=n&&this.isZeroCrossing(t,s))return s}return e}isZeroCrossing(t,e){if(e>=t.length-1)return!1;let r=t[e],n=t[e+1];return r<=0&&n>0||r>=0&&n<0}adjustMarkersForCrop=(t,e)=>{try{this.morphaweb.markerHandler.getBottomMarkers().forEach(r=>{if(r.time<t||r.time>e)this.morphaweb.markerHandler.removeMarker(r.time);else{let e=r.time-t;this.morphaweb.markerHandler.removeMarker(r.time),this.morphaweb.markerHandler.createMarker(e,r.position)}})}catch(t){console.error("Error adjusting markers:",t)}};formatTime=t=>{let e=Math.floor(t/60),r=(t%60).toFixed(2);return`${e}:${r.padStart(5,"0")}`};showMessage=(t,e=3e3)=>{let r=document.getElementById("message-overlay");document.getElementById("message-text").textContent=t,r.style.display="block",this.messageTimeout&&clearTimeout(this.messageTimeout),this.messageTimeout=setTimeout(()=>{r.style.display="none"},e)};interleaveChannels=t=>{let e=t.numberOfChannels,r=t.length,n=new Float32Array(r*e);for(let i=0;i<e;i++){let a=t.getChannelData(i);for(let t=0;t<r;t++)n[t*e+i]=a[t]}return n};createFadeInRegion=()=>{try{if(0===this.morphaweb.wavesurfer.getDuration())return!1;this.fadeInRegion&&this.fadeInRegion.remove();let t=this.morphaweb.wavesurfer.getDuration(),e=Math.min(.1*t,2);this.fadeInRegion=this.morphaweb.wavesurfer.addRegion({start:0,end:e,color:"rgba(0, 255, 0, 0.3)",drag:!0,resize:!0,id:"fade-in-region"}),this.updateFadeButtonStates(),this.fadeInRegion.on("update-end",()=>{this.showMessage(`Fade-in region: ${this.formatTime(this.fadeInRegion.start)} - ${this.formatTime(this.fadeInRegion.end)}`),this.morphaweb.updateRegionDisplays()}),this.showMessage("Fade-in region created. Drag edges to adjust fade length."),this.morphaweb.updateRegionDisplays(),this.morphaweb.track("CreateFadeInRegion")}catch(t){this.morphaweb.track("ErrorCreateFadeInRegion"),console.error("Error creating fade-in region:",t)}};createFadeOutRegion=()=>{try{if(0===this.morphaweb.wavesurfer.getDuration())return!1;this.fadeOutRegion&&this.fadeOutRegion.remove();let t=this.morphaweb.wavesurfer.getDuration(),e=Math.min(.1*t,2);this.fadeOutRegion=this.morphaweb.wavesurfer.addRegion({start:t-e,end:t,color:"rgba(255, 0, 0, 0.3)",drag:!0,resize:!0,id:"fade-out-region"}),this.updateFadeButtonStates(),this.fadeOutRegion.on("update-end",()=>{this.showMessage(`Fade-out region: ${this.formatTime(this.fadeOutRegion.start)} - ${this.formatTime(this.fadeOutRegion.end)}`),this.morphaweb.updateRegionDisplays()}),this.showMessage("Fade-out region created. Drag edges to adjust fade length."),this.morphaweb.updateRegionDisplays(),this.morphaweb.track("CreateFadeOutRegion")}catch(t){this.morphaweb.track("ErrorCreateFadeOutRegion"),console.error("Error creating fade-out region:",t)}};applyFades=()=>{try{if(0===this.morphaweb.wavesurfer.getDuration())return!1;if(!this.fadeInRegion&&!this.fadeOutRegion){this.showMessage("No fade regions to apply. Create fade-in or fade-out regions first.");return}let t=this.morphaweb.wavesurfer.backend.buffer,e=t.sampleRate,r=t.numberOfChannels,n=t.length,i=this.morphaweb.wavesurfer.backend.ac.createBuffer(r,n,e);for(let a=0;a<r;a++){let r=t.getChannelData(a),s=i.getChannelData(a);for(let t=0;t<n;t++)s[t]=r[t];if(this.fadeInRegion){let t=Math.floor(this.fadeInRegion.start*e),r=Math.floor(this.fadeInRegion.end*e),n=r-t;for(let e=t;e<r;e++){let r=(e-t)/n,i=r*r;s[e]*=i}}if(this.fadeOutRegion){let t=Math.floor(this.fadeOutRegion.start*e),r=Math.floor(this.fadeOutRegion.end*e),n=r-t;for(let e=t;e<r;e++){let r=(e-t)/n,i=1-r*r;s[e]*=i}}}this.morphaweb.wavesurfer.loadDecodedBuffer(i),this.clearFadeRegions(),this.showMessage("Fade effects applied successfully!"),this.morphaweb.updateDurationDisplay(),this.morphaweb.track("ApplyFades")}catch(t){this.morphaweb.track("ErrorApplyFades"),console.error("Error applying fades:",t),this.showMessage("Error applying fade effects. Please try again.")}};clearFadeRegions=()=>{try{this.fadeInRegion&&(this.fadeInRegion.remove(),this.fadeInRegion=null),this.fadeOutRegion&&(this.fadeOutRegion.remove(),this.fadeOutRegion=null),this.updateFadeButtonStates(),this.morphaweb.updateRegionDisplays(),this.morphaweb.track("ClearFadeRegions")}catch(t){this.morphaweb.track("ErrorClearFadeRegions"),console.error("Error clearing fade regions:",t)}};updateFadeButtonStates=()=>{let t=this.fadeInRegion||this.fadeOutRegion;this.applyFadesButton.disabled=!t,this.clearFadeRegionsButton.disabled=!t};showWaveformLoadOverlay=()=>{this.waveformLoadOverlay&&(this.waveformLoadOverlay.style.display="flex")};hideWaveformLoadOverlay=()=>{this.waveformLoadOverlay&&(this.waveformLoadOverlay.style.display="none")};resetAudio=()=>{window.location.reload()}}class y{constructor(t){this.color="#ff990a",this.colorHighlight="#ff1111",this.colorTopMarker="#ff00bb",this.markers=t.wavesurfer.markers,this.morphaweb=t,this.morphaweb.wavesurfer.on("marker-click",this.onClick.bind(this)),this.morphaweb.wavesurfer.on("marker-drag",this.onMarkersChanged.bind(this)),this.morphaweb.wavesurfer.on("marker-remove",this.onMarkersChanged.bind(this)),this.morphaweb.wavesurfer.on("marker-update",this.onMarkersChanged.bind(this))}addMarkers=t=>{for(let e of t)this.createMarker(e.position/1e3)};removeTopMarker(){let t=this.markers.markers.map(t=>t.position).indexOf("top");this.morphaweb.wavesurfer.markers.remove(t)}removeSelectedMarker(){let t=this.getSelectedMarkerIndex();this.markers.remove(t),this.onMarkersChanged()}highlightMarker(t){this.markers.markers.map(e=>{"bottom"==e.position&&(e.time==t?e.el.children[1].children[0].children[0].setAttribute("fill",this.colorHighlight):e.el.children[1].children[0].children[0].setAttribute("fill",this.color))})}getBottomMarkers(){return this.markers.markers.filter(t=>"bottom"===t.position)}getTopMarkers(){return this.markers.markers.filter(t=>"top"===t.position)}getSelectedMarker(){return this.markers.markers.filter(t=>t.el.children[1].children[0].children[0].getAttribute("fill")===this.colorHighlight)[0]}getSelectedMarkerIndex(){let t=this.getSelectedMarker();return this.markers.markers.findIndex(e=>e===t)}getMarkerAtTime(t){return this.getBottomMarkers().indexOf(t)}createMarker(t,e="bottom"){if("bottom"==e&&-1!=this.getMarkerAtTime(t))return!1;let r=this.morphaweb.wavesurfer.backend.buffer.getChannelData(0),n=this.morphaweb.wavesurfer.backend.buffer.sampleRate,i=Math.round(t*n),a=t;"bottom"===e&&this.morphaweb.onsetHandler&&(a=this.morphaweb.onsetHandler.findNearestZeroCrossing(r,i)/n);let s={time:a,position:"bottom",color:this.color,draggable:!0};"top"==e&&(s.position="top",s.color=this.colorTopMarker),this.morphaweb.wavesurfer.addMarker(s),this.onMarkersChanged()}createMarkerAtCurrentPosition(){this.createMarker(this.morphaweb.playOffset*this.morphaweb.wavesurfer.getDuration(),"bottom")}onClick(t){this.highlightMarker(t.time)}createAutoSlices(t){let e=this.morphaweb.wavesurfer.getDuration()/t;this.createMarker(0,"bottom");for(let r=1;r<t;r++)this.createMarker(e*r,"bottom")}clearAllMarkers(){this.morphaweb.wavesurfer.clearMarkers(),this.onMarkersChanged()}getMarkers(){return this.markers.markers.sort((t,e)=>t.time-e.time)}createOnsetMarkers(t){this.clearAllMarkers(),t.forEach(t=>{this.createMarker(t,"bottom")})}getOnsetTimes(){return this.getTopMarkers().map(t=>t.time).sort((t,e)=>t-e)}updateMarkerPosition(t,e){let r=this.markers.markers[t];r&&(r.time=e,this.morphaweb.wavesurfer.updateMarkerPosition(t,e))}onMarkersChanged(){let t=new CustomEvent("markers-changed",{detail:{markerCount:this.getBottomMarkers().length}});document.dispatchEvent(t)}hasEnoughMarkers(){return this.getBottomMarkers().length>=2}divideMarkersByTwo(){if(!this.hasEnoughMarkers())return;let t=this.getBottomMarkers().sort((t,e)=>t.time-e.time).filter((t,e)=>e%2==0);this.clearAllMarkers(),t.forEach(t=>{this.createMarker(t.time,"bottom")})}}let b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function w(t,e){return t=t>0?parseInt(t/e.oldMax*e.newMax,10):parseInt(t/e.oldMin*e.newMin,10)}function k(t,e){return parseInt(t>0?t*e.newMax:t*e.newMin,10)}function _(t,e){return t>0?t/e.oldMax:t/e.oldMin}function C(t){if("32f"!=t&&"64"!=t&&("8">parseInt(t,10)||parseInt(t,10)>"53"))throw Error("Invalid bit depth.")}function x(t,e,r){if("8"==t){let t=r?-128:128;for(let r=0,n=e.length;r<n;r++)e[r]=e[r]+=t}}let A=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],S=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767];function E(t,e){var r,n;let i=t-e.predicted,a=0;i>=0?a=0:(a=8,i=-i);let s=S[e.index],o=s>>3;return i>s&&(a|=4,i-=s,o+=s),i>(s>>=1)&&(a|=2,i-=s,o+=s),i>(s>>=1)&&(a|=1,o+=s),r=a,n=o,8&r?e.predicted-=n:e.predicted+=n,e.predicted<-32768?e.predicted=-32768:e.predicted>32767&&(e.predicted=32767),e.index+=A[7&r],e.index<0?e.index=0:e.index>88&&(e.index=88),a}function I(t,e){let r=0;return 4&t&&(r+=e.step),2&t&&(r+=e.step>>1),1&t&&(r+=e.step>>2),r+=e.step>>3,8&t&&(r=-r),e.predicted+=r,e.predicted>32767?e.predicted=32767:e.predicted<-32767&&(e.predicted=-32767),e.index+=A[t],e.index<0?e.index=0:e.index>88&&(e.index=88),e.step=S[e.index],e.predicted}let P=[1,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],M=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],R=[0,132,396,924,1980,4092,8316,16764];function O(t,e,r=0,n=t.length){for(let i=r;i<n;i+=e)!function(t,e,r){e--;for(let n=0;n<e;n++){let i=t[r+n];t[r+n]=t[r+e],t[r+e]=i,e--}}(t,e,i)}function T(t,e,r=0){let n=0,i=t.length;for(;n<i;){let i=t.codePointAt(n);if(i<128)e[r]=i,r++;else{let t=0,a=0;for(i<=2047?(t=1,a=192):i<=65535?(t=2,a=224):i<=1114111&&(t=3,a=240,n++),e[r]=(i>>6*t)+a,r++;t>0;)e[r]=128|i>>6*(t-1)&63,r++,t--}n++}return r}class L{constructor(t,e=!1){this.bits=t,this.offset=Math.ceil(t/8),this.max=Math.pow(2,t)-1,this.min=0,this.unpack=this.unpack_,e&&(this.max=Math.pow(2,t)/2-1,this.min=-this.max-1,this.unpack=this.unpackSigned_)}pack(t,e,r=0){e=this.clamp_(Math.round(e));for(let n=0,i=this.offset;n<i;n++)t[r]=255&Math.floor(e/Math.pow(2,8*n)),r++;return r}unpack_(t,e=0){let r=0;for(let n=0;n<this.offset;n++)r+=t[e+n]*Math.pow(256,n);return r}unpackSigned_(t,e=0){return this.sign_(this.unpack_(t,e))}clamp_(t){return t>this.max?this.max:t<this.min?this.min:t}sign_(t){return t>this.max&&(t-=2*this.max+2),t}}class D{constructor(t,e){this.offset=Math.ceil((t+e)/8),this.ebits=t,this.fbits=e,this.bias=(1<<t-1)-1,this.biasP2=Math.pow(2,this.bias+1),this.ebitsFbits=t+e,this.fbias=Math.pow(2,-(8*this.offset-1-t))}pack(t,e,r){Math.abs(e)>this.biasP2-2*this.ebitsFbits&&(e=e<0?-1/0:1/0);let n=0>((e=+e)||1/e)?1:e<0?1:0,i=Math.min(Math.floor(Math.log(e=Math.abs(e))/Math.LN2),1023),a=j(e/Math.pow(2,i)*Math.pow(2,this.fbits));return e!=e?(a=Math.pow(2,this.fbits-1),i=(1<<this.ebits)-1):0!==e&&(e>=Math.pow(2,1-this.bias)?(a/Math.pow(2,this.fbits)>=2&&(i+=1,a=1),i>this.bias?(i=(1<<this.ebits)-1,a=0):(i+=this.bias,a=j(a)-Math.pow(2,this.fbits))):(a=j(e/Math.pow(2,1-this.bias-this.fbits)),i=0)),this.packFloatBits_(t,r,n,i,a)}unpack(t,e){let r,n=(1<<this.ebits)-1,i="";for(let r=this.offset-1;r>=0;r--){let n=t[r+e].toString(2);i+="00000000".substring(n.length)+n}let a="1"==i.charAt(0)?-1:1,s=parseInt((i=i.substring(1)).substring(0,this.ebits),2);return(i=i.substring(this.ebits),s==n)?0!==parseInt(i,2)?NaN:1/0*a:(0===s?(s+=1,r=parseInt(i,2)):r=parseInt("1"+i,2),a*r*this.fbias*Math.pow(2,s-this.bias))}packFloatBits_(t,e,r,n,i){let a=[];a.push(r);for(let t=this.ebits;t>0;t-=1)a[t]=n%2?1:0,n=Math.floor(n/2);let s=a.length;for(let t=this.fbits;t>0;t-=1)a[s+t]=i%2?1:0,i=Math.floor(i/2);let o=a.join(""),u=this.offset+e-1,l=e;for(;u>=e;)t[u]=parseInt(o.substring(0,8),2),o=o.substring(8),u--,l++;return l}}function j(t){let e=Math.floor(t),r=t-e;return r<.5?e:r>.5?e+1:e%2?e+1:e}function B(t,e=0,r=t.length){return function(t,e=0,r=t.length){let n="";for(let i=e;i<r;){let e=128,r=191,a=!1,s=t[i++];if(s>=0&&s<=127)n+=String.fromCharCode(s);else{let o=0;s>=194&&s<=223?o=1:s>=224&&s<=239?(o=2,224===t[i]&&(e=160),237===t[i]&&(r=159)):s>=240&&s<=244?(o=3,240===t[i]&&(e=144),244===t[i]&&(r=143)):a=!0,s&=(1<<8-o-1)-1;for(let n=0;n<o;n++)(t[i]<e||t[i]>r)&&(a=!0),s=s<<6|63&t[i],i++;a?n+=String.fromCharCode(65533):s<=65535?n+=String.fromCharCode(s):(s-=65536,n+=String.fromCharCode((s>>10&1023)+55296,(1023&s)+56320))}}return n}(t,e,r)}function F(t){let e=[];return T(t,e),e}function z(t,e,r=0){return T(t,e,r)}function W(t,e,r,n=0){let i=X((e=e||{}).bits,e.fp,e.signed),a=Math.ceil(e.bits/8),s=0,o=n;for(let e=t.length;s<e;s++)n=i.pack(r,t[s],n);return e.be&&O(r,a,o,n),n}function U(t,e,r,n=0,i=t.length){var a;let s=X((e=e||{}).bits,e.fp,e.signed);if(i=(a=i)-(a-n)%s.offset,e.be){let a=new Uint8Array(t);e.be&&O(a,s.offset,n,i),$(a,r,n,i,s)}else $(t,r,n,i,s)}function N(t,e,r,n=0){return W([t],e,r,n)}function H(t,e){let r=[];return N(t,e,r,0),r}function V(t,e,r=0){let n=[];return U(t,e,n,r,r+Math.ceil(e.bits/8)),n[0]}function $(t,e,r,n,i){let a=i.offset;for(let s=0,o=r;o<n;o+=a,s++)e[s]=i.unpack(t,o)}function X(t,e,r){return e&&32==t?new D(8,23):e&&64==t?new D(11,52):new L(t,r)}class q{constructor(){this.container="",this.chunkSize=0,this.format="",this.signature=null,this.head=0,this.uInt32={bits:32,be:!1},this.supported_containers=["RIFF","RIFX"]}setSignature(t){if(this.head=0,this.container=this.readString(t,4),-1===this.supported_containers.indexOf(this.container))throw Error("Not a supported format.");this.uInt32.be="RIFX"===this.container,this.chunkSize=this.readUInt32(t),this.format=this.readString(t,4),this.signature={chunkId:this.container,chunkSize:this.chunkSize,format:this.format,subChunks:this.getSubChunksIndex_(t)}}findChunk(t,e=!1){let r=this.signature.subChunks,n=[];for(let i=0;i<r.length;i++)if(r[i].chunkId==t){if(!e)return r[i];n.push(r[i])}return"LIST"==t&&n.length?n:null}readString(t,e){let r="";return r=B(t,this.head,this.head+e),this.head+=e,r}readUInt32(t){let e=V(t,this.uInt32,this.head);return this.head+=4,e}getSubChunksIndex_(t){let e=[],r=this.head;for(;r<=t.length-8;)e.push(this.getSubChunkIndex_(t,r)),r+=8+e[e.length-1].chunkSize,r=r%2?r+1:r;return e}getSubChunkIndex_(t,e){let r={chunkId:this.getChunkId_(t,e),chunkSize:this.getChunkSize_(t,e)};if("LIST"==r.chunkId)r.format=B(t,e+8,e+12),this.head+=4,r.subChunks=this.getSubChunksIndex_(t);else{let t=r.chunkSize%2?r.chunkSize+1:r.chunkSize;this.head=e+8+t,r.chunkData={start:e+8,end:this.head}}return r}getChunkId_(t,e){return this.head+=4,B(t,e,e+4)}getChunkSize_(t,e){return this.head+=4,V(t,this.uInt32,e+4)}}class G extends q{constructor(){super(),this.supported_containers.push("RF64"),this.fmt={chunkId:"",chunkSize:0,audioFormat:0,numChannels:0,sampleRate:0,byteRate:0,blockAlign:0,bitsPerSample:0,cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]},this.fact={chunkId:"",chunkSize:0,dwSampleLength:0},this.cue={chunkId:"",chunkSize:0,dwCuePoints:0,points:[]},this.smpl={chunkId:"",chunkSize:0,dwManufacturer:0,dwProduct:0,dwSamplePeriod:0,dwMIDIUnityNote:0,dwMIDIPitchFraction:0,dwSMPTEFormat:0,dwSMPTEOffset:0,dwNumSampleLoops:0,dwSamplerData:0,loops:[]},this.bext={chunkId:"",chunkSize:0,description:"",originator:"",originatorReference:"",originationDate:"",originationTime:"",timeReference:[0,0],version:0,UMID:"",loudnessValue:0,loudnessRange:0,maxTruePeakLevel:0,maxMomentaryLoudness:0,maxShortTermLoudness:0,reserved:"",codingHistory:""},this.iXML={chunkId:"",chunkSize:0,value:""},this.ds64={chunkId:"",chunkSize:0,riffSizeHigh:0,riffSizeLow:0,dataSizeHigh:0,dataSizeLow:0,originationTime:0,sampleCountHigh:0,sampleCountLow:0},this.data={chunkId:"",chunkSize:0,samples:new Uint8Array(0)},this.LIST=[],this.junk={chunkId:"",chunkSize:0,chunkData:[]},this._PMX={chunkId:"",chunkSize:0,value:""},this.uInt16={bits:16,be:!1,signed:!1,fp:!1}}fromBuffer(t,e=!0){if(this.clearHeaders(),this.setSignature(t),this.uInt16.be=this.uInt32.be,"WAVE"!=this.format)throw Error('Could not find the "WAVE" format identifier');this.readDs64Chunk_(t),this.readFmtChunk_(t),this.readFactChunk_(t),this.readBextChunk_(t),this.readiXMLChunk_(t),this.readCueChunk_(t),this.readSmplChunk_(t),this.readDataChunk_(t,e),this.readJunkChunk_(t),this.readLISTChunk_(t),this.read_PMXChunk_(t)}clearHeaders(){let t=new G;Object.assign(this.fmt,t.fmt),Object.assign(this.fact,t.fact),Object.assign(this.cue,t.cue),Object.assign(this.smpl,t.smpl),Object.assign(this.bext,t.bext),Object.assign(this.iXML,t.iXML),Object.assign(this.ds64,t.ds64),Object.assign(this.data,t.data),this.LIST=[],Object.assign(this.junk,t.junk),Object.assign(this._PMX,t._PMX)}readFmtChunk_(t){let e=this.findChunk("fmt ");if(e)this.head=e.chunkData.start,this.fmt.chunkId=e.chunkId,this.fmt.chunkSize=e.chunkSize,this.fmt.audioFormat=this.readUInt16_(t),this.fmt.numChannels=this.readUInt16_(t),this.fmt.sampleRate=this.readUInt32(t),this.fmt.byteRate=this.readUInt32(t),this.fmt.blockAlign=this.readUInt16_(t),this.fmt.bitsPerSample=this.readUInt16_(t),this.readFmtExtension_(t);else throw Error('Could not find the "fmt " chunk')}readFmtExtension_(t){this.fmt.chunkSize>16&&(this.fmt.cbSize=this.readUInt16_(t),this.fmt.chunkSize>18&&(this.fmt.validBitsPerSample=this.readUInt16_(t),this.fmt.chunkSize>20&&(this.fmt.dwChannelMask=this.readUInt32(t),this.fmt.subformat=[this.readUInt32(t),this.readUInt32(t),this.readUInt32(t),this.readUInt32(t)])))}readFactChunk_(t){let e=this.findChunk("fact");e&&(this.head=e.chunkData.start,this.fact.chunkId=e.chunkId,this.fact.chunkSize=e.chunkSize,this.fact.dwSampleLength=this.readUInt32(t))}readCueChunk_(t){let e=this.findChunk("cue ");if(e){this.head=e.chunkData.start,this.cue.chunkId=e.chunkId,this.cue.chunkSize=e.chunkSize,this.cue.dwCuePoints=this.readUInt32(t);for(let e=0;e<this.cue.dwCuePoints;e++)this.cue.points.push({dwName:this.readUInt32(t),dwPosition:this.readUInt32(t),fccChunk:this.readString(t,4),dwChunkStart:this.readUInt32(t),dwBlockStart:this.readUInt32(t),dwSampleOffset:this.readUInt32(t)})}}readSmplChunk_(t){let e=this.findChunk("smpl");if(e){this.head=e.chunkData.start,this.smpl.chunkId=e.chunkId,this.smpl.chunkSize=e.chunkSize,this.smpl.dwManufacturer=this.readUInt32(t),this.smpl.dwProduct=this.readUInt32(t),this.smpl.dwSamplePeriod=this.readUInt32(t),this.smpl.dwMIDIUnityNote=this.readUInt32(t),this.smpl.dwMIDIPitchFraction=this.readUInt32(t),this.smpl.dwSMPTEFormat=this.readUInt32(t),this.smpl.dwSMPTEOffset=this.readUInt32(t),this.smpl.dwNumSampleLoops=this.readUInt32(t),this.smpl.dwSamplerData=this.readUInt32(t);for(let e=0;e<this.smpl.dwNumSampleLoops;e++)this.smpl.loops.push({dwName:this.readUInt32(t),dwType:this.readUInt32(t),dwStart:this.readUInt32(t),dwEnd:this.readUInt32(t),dwFraction:this.readUInt32(t),dwPlayCount:this.readUInt32(t)})}}readDataChunk_(t,e){let r=this.findChunk("data");if(r)this.data.chunkId="data",this.data.chunkSize=r.chunkSize,e&&(this.data.samples=t.slice(r.chunkData.start,r.chunkData.end));else throw Error('Could not find the "data" chunk')}readBextChunk_(t){let e=this.findChunk("bext");e&&(this.head=e.chunkData.start,this.bext.chunkId=e.chunkId,this.bext.chunkSize=e.chunkSize,this.bext.description=this.readString(t,256),this.bext.originator=this.readString(t,32),this.bext.originatorReference=this.readString(t,32),this.bext.originationDate=this.readString(t,10),this.bext.originationTime=this.readString(t,8),this.bext.timeReference=[this.readUInt32(t),this.readUInt32(t)],this.bext.version=this.readUInt16_(t),this.bext.UMID=this.readString(t,64),this.bext.loudnessValue=this.readUInt16_(t),this.bext.loudnessRange=this.readUInt16_(t),this.bext.maxTruePeakLevel=this.readUInt16_(t),this.bext.maxMomentaryLoudness=this.readUInt16_(t),this.bext.maxShortTermLoudness=this.readUInt16_(t),this.bext.reserved=this.readString(t,180),this.bext.codingHistory=this.readString(t,this.bext.chunkSize-602))}readiXMLChunk_(t){let e=this.findChunk("iXML");e&&(this.head=e.chunkData.start,this.iXML.chunkId=e.chunkId,this.iXML.chunkSize=e.chunkSize,this.iXML.value=B(t,this.head,this.head+this.iXML.chunkSize))}readDs64Chunk_(t){let e=this.findChunk("ds64");if(e)this.head=e.chunkData.start,this.ds64.chunkId=e.chunkId,this.ds64.chunkSize=e.chunkSize,this.ds64.riffSizeHigh=this.readUInt32(t),this.ds64.riffSizeLow=this.readUInt32(t),this.ds64.dataSizeHigh=this.readUInt32(t),this.ds64.dataSizeLow=this.readUInt32(t),this.ds64.originationTime=this.readUInt32(t),this.ds64.sampleCountHigh=this.readUInt32(t),this.ds64.sampleCountLow=this.readUInt32(t);else if("RF64"==this.container)throw Error('Could not find the "ds64" chunk')}readLISTChunk_(t){let e=this.findChunk("LIST",!0);if(null!==e)for(let r=0;r<e.length;r++){let n=e[r];this.LIST.push({chunkId:n.chunkId,chunkSize:n.chunkSize,format:n.format,subChunks:[]});for(let e=0;e<n.subChunks.length;e++)this.readLISTSubChunks_(n.subChunks[e],n.format,t)}}readLISTSubChunks_(t,e,r){"adtl"==e?["labl","note","ltxt"].indexOf(t.chunkId)>-1&&this.readLISTadtlSubChunks_(r,t):"INFO"==e&&this.readLISTINFOSubChunks_(r,t)}readLISTadtlSubChunks_(t,e){this.head=e.chunkData.start;let r={chunkId:e.chunkId,chunkSize:e.chunkSize,dwName:this.readUInt32(t)};"ltxt"==e.chunkId?(r.dwSampleLength=this.readUInt32(t),r.dwPurposeID=this.readUInt32(t),r.dwCountry=this.readUInt16_(t),r.dwLanguage=this.readUInt16_(t),r.dwDialect=this.readUInt16_(t),r.dwCodePage=this.readUInt16_(t),r.value=""):r.value=this.readZSTR_(t,this.head),this.LIST[this.LIST.length-1].subChunks.push(r)}readLISTINFOSubChunks_(t,e){this.head=e.chunkData.start,this.LIST[this.LIST.length-1].subChunks.push({chunkId:e.chunkId,chunkSize:e.chunkSize,value:this.readZSTR_(t,this.head)})}readJunkChunk_(t){let e=this.findChunk("junk");e&&(this.junk={chunkId:e.chunkId,chunkSize:e.chunkSize,chunkData:[].slice.call(t.slice(e.chunkData.start,e.chunkData.end))})}read_PMXChunk_(t){let e=this.findChunk("_PMX");e&&(this.head=e.chunkData.start,this._PMX.chunkId=e.chunkId,this._PMX.chunkSize=e.chunkSize,this._PMX.value=B(t,this.head,this.head+this._PMX.chunkSize))}readZSTR_(t,e=0){for(let r=e;r<t.length&&(this.head++,0!==t[r]);r++);return B(t,e,this.head-1)}readUInt16_(t){let e=V(t,this.uInt16,this.head);return this.head+=2,e}}function Z(t,e){let r=F(t);for(let t=r.length;t<e;t++)r.push(0);return r}class K extends G{toBuffer(){this.uInt16.be="RIFX"===this.container,this.uInt32.be=this.uInt16.be;let t=[this.getJunkBytes_(),this.getDs64Bytes_(),this.getBextBytes_(),this.getiXMLBytes_(),this.getFmtBytes_(),this.getFactBytes_(),F(this.data.chunkId),H(this.data.samples.length,this.uInt32),this.data.samples,this.getCueBytes_(),this.getSmplBytes_(),this.getLISTBytes_(),this.get_PMXBytes_()],e=0;for(let r=0;r<t.length;r++)e+=t[r].length;let r=new Uint8Array(e+12),n=0;n=z(this.container,r,n),n=N(e+4,this.uInt32,r,n),n=z(this.format,r,n);for(let e=0;e<t.length;e++)r.set(t[e],n),n+=t[e].length;return r}getBextBytes_(){let t=[];return this.enforceBext_(),this.bext.chunkId&&(this.bext.chunkSize=602+this.bext.codingHistory.length,t=t.concat(F(this.bext.chunkId),H(602+this.bext.codingHistory.length,this.uInt32),Z(this.bext.description,256),Z(this.bext.originator,32),Z(this.bext.originatorReference,32),Z(this.bext.originationDate,10),Z(this.bext.originationTime,8),H(this.bext.timeReference[0],this.uInt32),H(this.bext.timeReference[1],this.uInt32),H(this.bext.version,this.uInt16),Z(this.bext.UMID,64),H(this.bext.loudnessValue,this.uInt16),H(this.bext.loudnessRange,this.uInt16),H(this.bext.maxTruePeakLevel,this.uInt16),H(this.bext.maxMomentaryLoudness,this.uInt16),H(this.bext.maxShortTermLoudness,this.uInt16),Z(this.bext.reserved,180),Z(this.bext.codingHistory,this.bext.codingHistory.length))),this.enforceByteLen_(t),t}enforceBext_(){for(let t in this.bext)if(this.bext.hasOwnProperty(t)&&this.bext[t]&&"timeReference"!=t){this.bext.chunkId="bext";break}(this.bext.timeReference[0]||this.bext.timeReference[1])&&(this.bext.chunkId="bext")}getiXMLBytes_(){let t=[];if(this.iXML.chunkId){let e=F(this.iXML.value);this.iXML.chunkSize=e.length,t=t.concat(F(this.iXML.chunkId),H(this.iXML.chunkSize,this.uInt32),e)}return this.enforceByteLen_(t),t}getDs64Bytes_(){let t=[];return this.ds64.chunkId&&(t=t.concat(F(this.ds64.chunkId),H(this.ds64.chunkSize,this.uInt32),H(this.ds64.riffSizeHigh,this.uInt32),H(this.ds64.riffSizeLow,this.uInt32),H(this.ds64.dataSizeHigh,this.uInt32),H(this.ds64.dataSizeLow,this.uInt32),H(this.ds64.originationTime,this.uInt32),H(this.ds64.sampleCountHigh,this.uInt32),H(this.ds64.sampleCountLow,this.uInt32))),this.enforceByteLen_(t),t}getCueBytes_(){let t=[];if(this.cue.chunkId){let e=this.getCuePointsBytes_();t=t.concat(F(this.cue.chunkId),H(e.length+4,this.uInt32),H(this.cue.dwCuePoints,this.uInt32),e)}return this.enforceByteLen_(t),t}getCuePointsBytes_(){let t=[];for(let e=0;e<this.cue.dwCuePoints;e++)t=t.concat(H(this.cue.points[e].dwName,this.uInt32),H(this.cue.points[e].dwPosition,this.uInt32),F(this.cue.points[e].fccChunk),H(this.cue.points[e].dwChunkStart,this.uInt32),H(this.cue.points[e].dwBlockStart,this.uInt32),H(this.cue.points[e].dwSampleOffset,this.uInt32));return t}getSmplBytes_(){let t=[];if(this.smpl.chunkId){let e=this.getSmplLoopsBytes_();t=t.concat(F(this.smpl.chunkId),H(e.length+36,this.uInt32),H(this.smpl.dwManufacturer,this.uInt32),H(this.smpl.dwProduct,this.uInt32),H(this.smpl.dwSamplePeriod,this.uInt32),H(this.smpl.dwMIDIUnityNote,this.uInt32),H(this.smpl.dwMIDIPitchFraction,this.uInt32),H(this.smpl.dwSMPTEFormat,this.uInt32),H(this.smpl.dwSMPTEOffset,this.uInt32),H(this.smpl.dwNumSampleLoops,this.uInt32),H(this.smpl.dwSamplerData,this.uInt32),e)}return this.enforceByteLen_(t),t}getSmplLoopsBytes_(){let t=[];for(let e=0;e<this.smpl.dwNumSampleLoops;e++)t=t.concat(H(this.smpl.loops[e].dwName,this.uInt32),H(this.smpl.loops[e].dwType,this.uInt32),H(this.smpl.loops[e].dwStart,this.uInt32),H(this.smpl.loops[e].dwEnd,this.uInt32),H(this.smpl.loops[e].dwFraction,this.uInt32),H(this.smpl.loops[e].dwPlayCount,this.uInt32));return t}getFactBytes_(){let t=[];return this.fact.chunkId&&(t=t.concat(F(this.fact.chunkId),H(this.fact.chunkSize,this.uInt32),H(this.fact.dwSampleLength,this.uInt32))),this.enforceByteLen_(t),t}getFmtBytes_(){if(this.fmt.chunkId){let t=[].concat(F(this.fmt.chunkId),H(this.fmt.chunkSize,this.uInt32),H(this.fmt.audioFormat,this.uInt16),H(this.fmt.numChannels,this.uInt16),H(this.fmt.sampleRate,this.uInt32),H(this.fmt.byteRate,this.uInt32),H(this.fmt.blockAlign,this.uInt16),H(this.fmt.bitsPerSample,this.uInt16),this.getFmtExtensionBytes_());return this.enforceByteLen_(t),t}throw Error('Could not find the "fmt " chunk')}getFmtExtensionBytes_(){let t=[];return this.fmt.chunkSize>16&&(t=t.concat(H(this.fmt.cbSize,this.uInt16))),this.fmt.chunkSize>18&&(t=t.concat(H(this.fmt.validBitsPerSample,this.uInt16))),this.fmt.chunkSize>20&&(t=t.concat(H(this.fmt.dwChannelMask,this.uInt32))),this.fmt.chunkSize>24&&(t=t.concat(H(this.fmt.subformat[0],this.uInt32),H(this.fmt.subformat[1],this.uInt32),H(this.fmt.subformat[2],this.uInt32),H(this.fmt.subformat[3],this.uInt32))),t}getLISTBytes_(){let t=[];for(let e=0;e<this.LIST.length;e++){let r=this.getLISTSubChunksBytes_(this.LIST[e].subChunks,this.LIST[e].format);t=t.concat(F(this.LIST[e].chunkId),H(r.length+4,this.uInt32),F(this.LIST[e].format),r)}return this.enforceByteLen_(t),t}getLISTSubChunksBytes_(t,e){let r=[];for(let n=0,i=t.length;n<i;n++)"INFO"==e?r=r.concat(this.getLISTINFOSubChunksBytes_(t[n])):"adtl"==e&&(r=r.concat(this.getLISTadtlSubChunksBytes_(t[n]))),this.enforceByteLen_(r);return r}getLISTINFOSubChunksBytes_(t){let e=[],r=Z(t.value,t.value.length);return(e=e.concat(F(t.chunkId),H(r.length+1,this.uInt32),r)).push(0),e}getLISTadtlSubChunksBytes_(t){let e=[];if(["labl","note"].indexOf(t.chunkId)>-1){let r=Z(t.value,t.value.length);(e=e.concat(F(t.chunkId),H(r.length+4+1,this.uInt32),H(t.dwName,this.uInt32),r)).push(0)}else"ltxt"==t.chunkId&&(e=e.concat(this.getLtxtChunkBytes_(t)));return e}getLtxtChunkBytes_(t){return[].concat(F(t.chunkId),H(t.value.length+20,this.uInt32),H(t.dwName,this.uInt32),H(t.dwSampleLength,this.uInt32),H(t.dwPurposeID,this.uInt32),H(t.dwCountry,this.uInt16),H(t.dwLanguage,this.uInt16),H(t.dwDialect,this.uInt16),H(t.dwCodePage,this.uInt16),Z(t.value,t.value.length))}get_PMXBytes_(){let t=[];if(this._PMX.chunkId){let e=F(this._PMX.value);this._PMX.chunkSize=e.length,t=t.concat(F(this._PMX.chunkId),H(this._PMX.chunkSize,this.uInt32),e)}return this.enforceByteLen_(t),t}getJunkBytes_(){let t=[];return this.junk.chunkId?t.concat(F(this.junk.chunkId),H(this.junk.chunkData.length,this.uInt32),this.junk.chunkData):(this.enforceByteLen_(t),t)}enforceByteLen_(t){t.length%2&&t.push(0)}}function Y(t,e,r){return!(r<1)&&!(e/8*t*r>0xffffffff)}class Q extends K{constructor(){super(),this.bitDepth="0",this.dataType={bits:0,be:!1},this.WAV_AUDIO_FORMATS={4:17,8:1,"8a":6,"8m":7,16:1,24:1,32:1,"32f":3,64:3}}fromScratch(t,e,r,n,i){i=i||{},this.clearHeaders(),this.newWavFile_(t,e,r,n,i)}fromBuffer(t,e=!0){super.fromBuffer(t,e),this.bitDepthFromFmt_(),this.updateDataType_()}toBuffer(){return this.validateWavHeader_(),super.toBuffer()}getSamples(t=!1,e=Float64Array){let r=new e(this.data.samples.length/(this.dataType.bits/8));return(U(this.data.samples,this.dataType,r,0,this.data.samples.length),!t&&this.fmt.numChannels>1)?function(t,e,r=Float64Array){let n=[];for(let i=0;i<e;i++)n[i]=new r(t.length/e);for(let r=0;r<e;r++)for(let i=r,a=0;i<t.length;i+=e,a++)n[r][a]=t[i];return n}(r,this.fmt.numChannels,e):r}getSample(t){if((t*=this.dataType.bits/8)+this.dataType.bits/8>this.data.samples.length)throw Error("Range error");return V(this.data.samples.slice(t,t+this.dataType.bits/8),this.dataType)}setSample(t,e){if((t*=this.dataType.bits/8)+this.dataType.bits/8>this.data.samples.length)throw Error("Range error");N(e,this.dataType,this.data.samples,t,!0)}getiXML(){return this.iXML.value}setiXML(t){if("string"!=typeof t)throw TypeError("iXML value must be a string.");this.iXML.value=t,this.iXML.chunkId="iXML"}get_PMX(){return this._PMX.value}set_PMX(t){if("string"!=typeof t)throw TypeError("_PMX value must be a string.");this._PMX.value=t,this._PMX.chunkId="_PMX"}newWavFile_(t,e,r,n,i){i.container||(i.container="RIFF"),this.container=i.container,this.bitDepth=r,n=function(t){let e=[];if(t.length>0){if(t[0].constructor!==Number){e=new Float64Array(t[0].length*t.length);for(let r=0,n=t[0].length,i=0;r<n;r++)for(let n=0,a=t.length;n<a;n++,i++)e[i]=t[n][r]}else e=t}return e}(n),this.updateDataType_();let a=this.dataType.bits/8;this.data.samples=new Uint8Array(n.length*a),W(n,this.dataType,this.data.samples,0,!0),this.makeWavHeader_(r,t,e,a,this.data.samples.length,i),this.data.chunkId="data",this.data.chunkSize=this.data.samples.length,this.validateWavHeader_()}makeWavHeader_(t,e,r,n,i,a){"4"==t?this.createADPCMHeader_(t,e,r,n,i,a):"8a"==t||"8m"==t?this.createALawMulawHeader_(t,e,r,n,i,a):-1==Object.keys(this.WAV_AUDIO_FORMATS).indexOf(t)||e>2?this.createExtensibleHeader_(t,e,r,n,i,a):this.createPCMHeader_(t,e,r,n,i,a)}createPCMHeader_(t,e,r,n,i,a){this.container=a.container,this.chunkSize=36+i,this.format="WAVE",this.bitDepth=t,this.fmt={chunkId:"fmt ",chunkSize:16,audioFormat:this.WAV_AUDIO_FORMATS[t]||65534,numChannels:e,sampleRate:r,byteRate:e*n*r,blockAlign:e*n,bitsPerSample:parseInt(t,10),cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]}}createADPCMHeader_(t,e,r,n,i,a){this.createPCMHeader_(t,e,r,n,i,a),this.chunkSize=40+i,this.fmt.chunkSize=20,this.fmt.byteRate=4055,this.fmt.blockAlign=256,this.fmt.bitsPerSample=4,this.fmt.cbSize=2,this.fmt.validBitsPerSample=505,this.fact={chunkId:"fact",chunkSize:4,dwSampleLength:2*i}}createExtensibleHeader_(t,e,r,n,i,a){let s;this.createPCMHeader_(t,e,r,n,i,a),this.chunkSize=60+i,this.fmt.chunkSize=40,this.fmt.bitsPerSample=(parseInt(t,10)-1|7)+1,this.fmt.cbSize=22,this.fmt.validBitsPerSample=parseInt(t,10),this.fmt.dwChannelMask=(s=0,1===e?s=4:2===e?s=3:4===e?s=51:6===e?s=63:8===e&&(s=1599),s),this.fmt.subformat=[1,1048576,0xaa000080,0x719b3800]}createALawMulawHeader_(t,e,r,n,i,a){this.createPCMHeader_(t,e,r,n,i,a),this.chunkSize=40+i,this.fmt.chunkSize=20,this.fmt.cbSize=2,this.fmt.validBitsPerSample=8,this.fact={chunkId:"fact",chunkSize:4,dwSampleLength:i}}bitDepthFromFmt_(){3===this.fmt.audioFormat&&32===this.fmt.bitsPerSample?this.bitDepth="32f":6===this.fmt.audioFormat?this.bitDepth="8a":7===this.fmt.audioFormat?this.bitDepth="8m":this.bitDepth=this.fmt.bitsPerSample.toString()}validateBitDepth_(){if(!this.WAV_AUDIO_FORMATS[this.bitDepth]){if(parseInt(this.bitDepth,10)>8&&54>parseInt(this.bitDepth,10))return!0;throw Error("Invalid bit depth.")}return!0}updateDataType_(){this.dataType={bits:(parseInt(this.bitDepth,10)-1|7)+1,fp:"32f"==this.bitDepth||"64"==this.bitDepth,signed:"8"!=this.bitDepth,be:"RIFX"==this.container},["4","8a","8m"].indexOf(this.bitDepth)>-1&&(this.dataType.bits=8,this.dataType.signed=!1)}validateWavHeader_(){var t,e;if(this.validateBitDepth_(),t=this.fmt.numChannels,e=this.fmt.bitsPerSample,t<1||t*e/8>65535)throw Error("Invalid number of channels.");if(!Y(this.fmt.numChannels,this.fmt.bitsPerSample,this.fmt.sampleRate))throw Error("Invalid sample rate.")}}class J extends Q{getTag(t){let e=this.getTagIndex_(t);return null!==e.TAG?this.LIST[e.LIST].subChunks[e.TAG].value:null}setTag(t,e){t=function(t){if(t.constructor!==String)throw Error("Invalid tag name.");if(t.length<4)for(let e=0,r=4-t.length;e<r;e++)t+=" ";return t}(t);let r=this.getTagIndex_(t);null!==r.TAG?(this.LIST[r.LIST].subChunks[r.TAG].chunkSize=e.length+1,this.LIST[r.LIST].subChunks[r.TAG].value=e):null!==r.LIST?this.LIST[r.LIST].subChunks.push({chunkId:t,chunkSize:e.length+1,value:e}):(this.LIST.push({chunkId:"LIST",chunkSize:8+e.length+1,format:"INFO",subChunks:[]}),this.LIST[this.LIST.length-1].subChunks.push({chunkId:t,chunkSize:e.length+1,value:e}))}deleteTag(t){let e=this.getTagIndex_(t);return null!==e.TAG&&(this.LIST[e.LIST].subChunks.splice(e.TAG,1),!0)}listTags(){let t=this.getLISTIndex("INFO"),e={};if(null!==t)for(let r=0,n=this.LIST[t].subChunks.length;r<n;r++)e[this.LIST[t].subChunks[r].chunkId]=this.LIST[t].subChunks[r].value;return e}getLISTIndex(t){for(let e=0,r=this.LIST.length;e<r;e++)if(this.LIST[e].format==t)return e;return null}getTagIndex_(t){let e={LIST:null,TAG:null};for(let r=0,n=this.LIST.length;r<n;r++)if("INFO"==this.LIST[r].format){e.LIST=r;for(let n=0,i=this.LIST[r].subChunks.length;n<i;n++)if(this.LIST[r].subChunks[n].chunkId==t){e.TAG=n;break}break}return e}}class tt extends J{listCuePoints(){let t=this.getCuePoints_();for(let e=0,r=t.length;e<r;e++)t[e].position=t[e].dwSampleOffset/this.fmt.sampleRate*1e3,t[e].dwSampleLength?(t[e].end=t[e].dwSampleLength/this.fmt.sampleRate*1e3,t[e].end+=t[e].position):t[e].end=null,delete t[e].value;return t}setCuePoint(t){this.cue.chunkId="cue ",t.label||(t.label="");let e=this.getCuePoints_();this.clearLISTadtl_(),this.cue.points=[],t.dwSampleOffset=t.position*this.fmt.sampleRate/1e3,t.dwSampleLength=0,t.end&&(t.dwSampleLength=t.end*this.fmt.sampleRate/1e3-t.dwSampleOffset),0===e.length?this.setCuePoint_(t,1):this.setCuePointInOrder_(e,t),this.cue.dwCuePoints=this.cue.points.length}deleteCuePoint(t){this.cue.chunkId="cue ";let e=this.getCuePoints_();this.clearLISTadtl_();let r=this.cue.points.length;this.cue.points=[];for(let n=0;n<r;n++)n+1!==t&&this.setCuePoint_(e[n],n+1);this.cue.dwCuePoints=this.cue.points.length,this.cue.dwCuePoints?this.cue.chunkId="cue ":(this.cue.chunkId="",this.clearLISTadtl_())}updateLabel(t,e){let r=this.getLISTIndex("adtl");if(null!==r)for(let n=0,i=this.LIST[r].subChunks.length;n<i;n++)this.LIST[r].subChunks[n].dwName==t&&(this.LIST[r].subChunks[n].value=e)}getCuePoints_(){let t=[];for(let e=0;e<this.cue.points.length;e++){let r=this.cue.points[e],n=this.getDataForCuePoint_(r.dwName);n.label=n.value?n.value:"",n.dwPosition=r.dwPosition,n.fccChunk=r.fccChunk,n.dwChunkStart=r.dwChunkStart,n.dwBlockStart=r.dwBlockStart,n.dwSampleOffset=r.dwSampleOffset,t.push(n)}return t}getDataForCuePoint_(t){let e=this.getLISTIndex("adtl"),r={};return null!==e&&this.getCueDataFromLIST_(r,e,t),r}getCueDataFromLIST_(t,e,r){for(let n=0,i=this.LIST[e].subChunks.length;n<i;n++)if(this.LIST[e].subChunks[n].dwName==r){let r=this.LIST[e].subChunks[n];t.value=r.value||t.value,t.dwName=r.dwName||0,t.dwSampleLength=r.dwSampleLength||0,t.dwPurposeID=r.dwPurposeID||0,t.dwCountry=r.dwCountry||0,t.dwLanguage=r.dwLanguage||0,t.dwDialect=r.dwDialect||0,t.dwCodePage=r.dwCodePage||0}}setCuePoint_(t,e){this.cue.points.push({dwName:e,dwPosition:t.dwPosition?t.dwPosition:0,fccChunk:t.fccChunk?t.fccChunk:"data",dwChunkStart:t.dwChunkStart?t.dwChunkStart:0,dwBlockStart:t.dwBlockStart?t.dwBlockStart:0,dwSampleOffset:t.dwSampleOffset}),this.setLabl_(t,e)}setCuePointInOrder_(t,e){let r=!1;for(let n=0;n<t.length;n++)t[n].dwSampleOffset>e.dwSampleOffset&&!r?(this.setCuePoint_(e,n+1),this.setCuePoint_(t[n],n+2),r=!0):this.setCuePoint_(t[n],r?n+2:n+1);r||this.setCuePoint_(e,this.cue.points.length+1)}clearLISTadtl_(){for(let t=0,e=this.LIST.length;t<e;t++)"adtl"==this.LIST[t].format&&this.LIST.splice(t)}setLabl_(t,e){let r=this.getLISTIndex("adtl");null===r&&(this.LIST.push({chunkId:"LIST",chunkSize:4,format:"adtl",subChunks:[]}),r=this.LIST.length-1),this.setLabelText_(r,t,e),t.dwSampleLength&&this.setLtxtChunk_(r,t,e)}setLabelText_(t,e,r){this.LIST[t].subChunks.push({chunkId:"labl",chunkSize:4,dwName:r,value:e.label}),this.LIST[t].chunkSize+=12}setLtxtChunk_(t,e,r){this.LIST[t].subChunks.push({chunkId:"ltxt",chunkSize:20,dwName:r,dwSampleLength:e.dwSampleLength,dwPurposeID:e.dwPurposeID||0,dwCountry:e.dwCountry||0,dwLanguage:e.dwLanguage||0,dwDialect:e.dwDialect||0,dwCodePage:e.dwCodePage||0,value:e.label}),this.LIST[t].chunkSize+=28}}class te{constructor(t,e,r){var n;this.length_=t,this.scaleFactor_=(t-1)/e,this.interpolate=this.sinc,"point"===r.method?this.interpolate=this.point:"linear"===r.method?this.interpolate=this.linear:"cubic"===r.method&&(this.interpolate=this.cubic),this.tangentFactor_=1-Math.max(0,Math.min(1,r.tension||0)),this.sincFilterSize_=r.sincFilterSize||1,this.kernel_=(n=r.sincWindow||tr,function(t){return(0===t?1:Math.sin(Math.PI*t)/(Math.PI*t))*n(t)})}point(t,e){return this.getClippedInput_(Math.round(this.scaleFactor_*t),e)}linear(t,e){let r=Math.floor(t=this.scaleFactor_*t);return(1-(t-=r))*this.getClippedInput_(r,e)+t*this.getClippedInput_(r+1,e)}cubic(t,e){let r=Math.floor(t=this.scaleFactor_*t),n=[this.getTangent_(r,e),this.getTangent_(r+1,e)],i=[this.getClippedInput_(r,e),this.getClippedInput_(r+1,e)],a=(t-=r)*t,s=t*a;return(2*s-3*a+1)*i[0]+(s-2*a+t)*n[0]+(-2*s+3*a)*i[1]+(s-a)*n[1]}sinc(t,e){let r=Math.floor(t=this.scaleFactor_*t),n=r-this.sincFilterSize_+1,i=r+this.sincFilterSize_,a=0;for(let r=n;r<=i;r++)a+=this.kernel_(t-r)*this.getClippedInput_(r,e);return a}getTangent_(t,e){return this.tangentFactor_*(this.getClippedInput_(t+1,e)-this.getClippedInput_(t-1,e))/2}getClippedInput_(t,e){return 0<=t&&t<this.length_?e[t]:0}}function tr(t){return Math.exp(-t/2*t/2)}let tn={point:!1,linear:!1,cubic:!0,sinc:!0},ti={IIR:16,FIR:71},ta={IIR:class{constructor(t,e,r){let n=[];for(let i=0;i<t;i++)n.push(this.getCoeffs_({Fs:e,Fc:r,Q:.5/Math.sin(Math.PI/(2*t)*(i+.5))}));this.stages=[];for(let t=0;t<n.length;t++)this.stages[t]={b0:n[t].b[0],b1:n[t].b[1],b2:n[t].b[2],a1:n[t].a[0],a2:n[t].a[1],k:n[t].k,z:[0,0]}}filter(t){let e=t;for(let t=0,r=this.stages.length;t<r;t++)e=this.runStage_(t,e);return e}getCoeffs_(t){let e={};e.a=[],e.b=[];let r=this.preCalc_(t,e);return e.k=1,e.b.push((1-r.cw)/(2*r.a0)),e.b.push(2*e.b[0]),e.b.push(e.b[0]),e}preCalc_(t,e){let r={},n=2*Math.PI*t.Fc/t.Fs;return r.alpha=Math.sin(n)/(2*t.Q),r.cw=Math.cos(n),r.a0=1+r.alpha,e.a0=r.a0,e.a.push(-2*r.cw/r.a0),e.k=1,e.a.push((1-r.alpha)/r.a0),r}runStage_(t,e){let r=e*this.stages[t].k-this.stages[t].a1*this.stages[t].z[0]-this.stages[t].a2*this.stages[t].z[1],n=this.stages[t].b0*r+this.stages[t].b1*this.stages[t].z[0]+this.stages[t].b2*this.stages[t].z[1];return this.stages[t].z[1]=this.stages[t].z[0],this.stages[t].z[0]=r,n}reset(){for(let t=0;t<this.stages.length;t++)this.stages[t].z=[0,0]}},FIR:class{constructor(t,e,r){let n=2*Math.PI*r/e,i=0;this.filters=[];for(let e=0;e<=t;e++)e-t/2==0?this.filters[e]=n:(this.filters[e]=Math.sin(n*(e-t/2))/(e-t/2),this.filters[e]*=.54-.46*Math.cos(2*Math.PI*e/t)),i+=this.filters[e];for(let e=0;e<=t;e++)this.filters[e]/=i;this.z=this.initZ_()}filter(t){this.z.buf[this.z.pointer]=t;let e=0;for(let t=0,r=this.z.buf.length;t<r;t++)e+=this.filters[t]*this.z.buf[(this.z.pointer+t)%this.z.buf.length];return this.z.pointer=(this.z.pointer+1)%this.z.buf.length,e}reset(){this.z=this.initZ_()}initZ_(){let t=[];for(let e=0;e<this.filters.length-1;e++)t.push(0);return{buf:t,pointer:0}}}};function ts(t,e,r,n=null){n=n||{};let i=(r-e)/e+1,a=new Float64Array(t.length*i);n.method=n.method||"cubic";let s=new te(t.length,a.length,{method:n.method,tension:n.tension||0,sincFilterSize:n.sincFilterSize||6,sincWindow:n.sincWindow||void 0,clip:n.clip||"mirror"});if(void 0===n.LPF&&(n.LPF=tn[n.method]),n.LPF){n.LPFType=n.LPFType||"IIR";let i=ta[n.LPFType];r>e?function(t,e,r,n){for(let i=0,a=e.length;i<a;i++)e[i]=n.filter(r.interpolate(i,t));n.reset();for(let t=e.length-1;t>=0;t--)e[t]=n.filter(e[t])}(t,a,s,new i(n.LPForder||ti[n.LPFType],r,e/2)):function(t,e,r,n){for(let e=0,r=t.length;e<r;e++)t[e]=n.filter(t[e]);n.reset();for(let e=t.length-1;e>=0;e--)t[e]=n.filter(t[e]);to(t,e,r)}(t,a,s,new i(n.LPForder||ti[n.LPFType],e,r/2))}else to(t,a,s);return a}function to(t,e,r){for(let n=0,i=e.length;n<i;n++)e[n]=r.interpolate(n,t)}class tu extends tt{toRIFF(){let t=new Float64Array(tl(this.data.samples.length,this.dataType.bits/8));U(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,t,{container:"RIFF"})}toRIFX(){let t=new Float64Array(tl(this.data.samples.length,this.dataType.bits/8));U(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,t,{container:"RIFX"})}toIMAADPCM(){if(8e3!==this.fmt.sampleRate)throw Error("Only 8000 Hz files can be compressed as IMA-ADPCM.");if(1!==this.fmt.numChannels)throw Error("Only mono files can be compressed as IMA-ADPCM.");{this.assure16Bit_();let t=new Int16Array(tl(this.data.samples.length,2));U(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"4",function(t){let e={index:0,predicted:0,step:7},r=new Uint8Array(t.length),n=[],i=0,a=0;for(let s=0,o=t.length;s<o;s++)s%505==0&&0!=s&&(r.set(function(t,e){let r=function(t,e){E(t,e);let r=[];return r.push(255&t),r.push(t>>8&255),r.push(e.index),r.push(0),r}(t[0],e);for(let n=3,i=t.length;n<i;n+=2){let i=E(t[n],e),a=E(t[n+1],e);r.push(a<<4|i)}return r}(n,e),i),i+=256,n=[],a++),n.push(t[s]);let s=t.length/2;return s%2&&s++,r.slice(0,s+512+4*a)}(t),{container:this.correctContainer_()})}}fromIMAADPCM(t="16"){this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",function(t,e=256){let r={index:0,predicted:0,step:7},n=new Int16Array(2*t.length),i=[],a=0;for(let s=0,o=t.length;s<o;s++){if(s%e==0&&0!=s){let t=function(t,e){var r;e.predicted=(r=t[1]<<8|t[0])>32768?r-65536:r,e.index=t[2],e.step=S[e.index];let n=[e.predicted,e.predicted];for(let r=4,i=t.length;r<i;r++){let i=t[r],a=i>>4,s=a<<4^i;n.push(I(s,e)),n.push(I(a,e))}return n}(i,r);n.set(t,a),a+=t.length,i=[]}i.push(t[s])}return n}(this.data.samples,this.fmt.blockAlign),{container:this.correctContainer_()}),"16"!=t&&this.toBitDepth(t)}toALaw(){this.assure16Bit_();let t=new Int16Array(tl(this.data.samples.length,2));U(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"8a",function(t){let e=new Uint8Array(t.length);for(let r=0,n=t.length;r<n;r++)e[r]=function(t){let e;let r=~(t=-32768==t?-32767:t)>>8&128;if(r||(t*=-1),t>32635&&(t=32635),t>=256){let r=P[t>>8&127],n=t>>r+3&15;e=r<<4|n}else e=t>>4;return 85^r^e}(t[r]);return e}(t),{container:this.correctContainer_()})}fromALaw(t="16"){this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",function(t){let e=new Int16Array(t.length);for(let r=0,n=t.length;r<n;r++)e[r]=function(t){let e=0;(128&(t^=85))!=0&&(t&=-129,e=-1);let r=((240&t)>>4)+4,n=0;return n=4!=r?1<<r|(15&t)<<r-4|1<<r-5:t<<1|1,-8*(n=0===e?n:-n)}(t[r]);return e}(this.data.samples),{container:this.correctContainer_()}),"16"!=t&&this.toBitDepth(t)}toMuLaw(){this.assure16Bit_();let t=new Int16Array(tl(this.data.samples.length,2));U(this.data.samples,this.dataType,t,0,this.data.samples.length),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"8m",function(t){let e=new Uint8Array(t.length);for(let r=0,n=t.length;r<n;r++)e[r]=function(t){let e,r,n;return 0!=(e=t>>8&128)&&(t=-t),(t+=132)>32635&&(t=32635),r=M[t>>7&255],n=t>>r+3&15,~(e|r<<4|n)}(t[r]);return e}(t),{container:this.correctContainer_()})}fromMuLaw(t="16"){this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,"16",function(t){let e=new Int16Array(t.length);for(let r=0,n=t.length;r<n;r++)e[r]=function(t){let e,r,n,i;return e=128&(t=~t),r=t>>4&7,n=15&t,i=R[r]+(n<<r+3),0!=e&&(i=-i),i}(t[r]);return e}(this.data.samples),{container:this.correctContainer_()}),"16"!=t&&this.toBitDepth(t)}toBitDepth(t,e=!0){let r=t,n=this.bitDepth;e||("32f"!=t&&(r=this.dataType.bits.toString()),n=""+this.dataType.bits),this.assureUncompressed_();let i=this.getSamples(!0),a=new Float64Array(i.length);!function(t,e,r,n){let i;if(["32f","64"].indexOf(e)>-1&&["32f","64"].indexOf(n)>-1){r.set(t);return}C(e),C(n);let a=(i=function(t){return t},e!=n&&(i=["32f","64"].includes(e)?k:["32f","64"].includes(n)?_:w),i),s={oldMin:Math.pow(2,parseInt(e,10))/2,newMin:Math.pow(2,parseInt(n,10))/2,oldMax:Math.pow(2,parseInt(e,10))/2-1,newMax:Math.pow(2,parseInt(n,10))/2-1};x(e,t,!0);for(let e=0,n=t.length;e<n;e++)r[e]=a(t[e],s);x(n,r,!1)}(i,n,a,r),this.fromExisting_(this.fmt.numChannels,this.fmt.sampleRate,t,a,{container:this.correctContainer_()})}toSampleRate(t,e){this.validateResample_(t);let r=this.getSamples(),n=[];if(r.constructor===Float64Array)n=ts(r,this.fmt.sampleRate,t,e);else for(let i=0;i<r.length;i++)n.push(ts(r[i],this.fmt.sampleRate,t,e));this.fromExisting_(this.fmt.numChannels,t,this.bitDepth,n,{container:this.correctContainer_()})}validateResample_(t){if(Y(this.fmt.numChannels,this.fmt.bitsPerSample,t)){if(["4","8a","8m"].indexOf(this.bitDepth)>-1)throw Error("wavefile can't change the sample rate of compressed files.")}else throw Error("Invalid sample rate.")}assure16Bit_(){this.assureUncompressed_(),"16"!=this.bitDepth&&this.toBitDepth("16")}assureUncompressed_(){"8a"==this.bitDepth?this.fromALaw():"8m"==this.bitDepth?this.fromMuLaw():"4"==this.bitDepth&&this.fromIMAADPCM()}correctContainer_(){return"RF64"==this.container?"RIFF":this.container}fromExisting_(t,e,r,n,i){let a=new tt;Object.assign(this.fmt,a.fmt),Object.assign(this.fact,a.fact),Object.assign(this.ds64,a.ds64),Object.assign(this.data,a.data),this.newWavFile_(t,e,r,n,i)}}function tl(t,e){let r=t/e;return r%2&&r++,r}class th extends tu{constructor(t){super(),t&&this.fromBuffer(t)}fromBase64(t){this.fromBuffer(function(t){let e=new Uint8Array(256);for(let t=0;t<b.length;t++)e[b.charCodeAt(t)]=t;let r=.75*t.length;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);let n=new Uint8Array(r);for(let r=0,i=0;r<t.length;r+=4){let a=e[t.charCodeAt(r)],s=e[t.charCodeAt(r+1)],o=e[t.charCodeAt(r+2)],u=e[t.charCodeAt(r+3)];n[i++]=a<<2|s>>4,n[i++]=(15&s)<<4|o>>2,n[i++]=(3&o)<<6|63&u}return n}(t))}toBase64(){return function(t){let e="";for(let r=0;r<t.length;r+=3)e+=b[t[r]>>2],e+=b[(3&t[r])<<4|t[r+1]>>4],e+=b[(15&t[r+1])<<2|t[r+2]>>6],e+=b[63&t[r+2]];return t.length%3==2?e=e.substring(0,e.length-1)+"=":t.length%3==1&&(e=e.substring(0,e.length-2)+"=="),e}(this.toBuffer())}toDataURI(){return"data:audio/wav;base64,"+this.toBase64()}fromDataURI(t){this.fromBase64(t.replace("data:audio/wav;base64,",""))}}var tc={};r=function(){function t(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){s(n.response,e,r)},n.onerror=function(){console.error("could not download file")},n.send()}function e(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(r){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(n,a,s){var o=i.URL||i.webkitURL,u=document.createElement("a");a=a||n.name||"download",u.download=a,u.rel="noopener","string"==typeof n?(u.href=n,u.origin===location.origin?r(u):e(u.href)?t(n,a,s):r(u,u.target="_blank")):(u.href=o.createObjectURL(n),setTimeout(function(){o.revokeObjectURL(u.href)},4e4),setTimeout(function(){r(u)},0))}:"msSaveOrOpenBlob"in navigator?function(n,i,a){if(i=i||n.name||"download","string"!=typeof n){var s;navigator.msSaveOrOpenBlob((void 0===(s=a)?s={autoBom:!1}:"object"!=typeof s&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n),i)}else if(e(n))t(n,i,a);else{var o=document.createElement("a");o.href=n,o.target="_blank",setTimeout(function(){r(o)})}}:function(e,r,n,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return t(e,r,n);var o="application/octet-stream"===e.type,u=/constructor/i.test(i.HTMLElement)||i.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&u||a)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var t=h.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=t:location=t,s=null},h.readAsDataURL(e)}else{var c=i.URL||i.webkitURL,f=c.createObjectURL(e);s?s.location=f:location.href=f,s=null,setTimeout(function(){c.revokeObjectURL(f)},4e4)}});i.saveAs=s.saveAs=s,tc=s},"function"==typeof define&&define.amd?define([],r):r();class tf{constructor(){this.markers=[],this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.originalSampleRate=null,this.targetSampleRate=48e3}setOriginalSampleRate(t){this.originalSampleRate=t}resampleBuffer(t,e,r){if(console.log("=== RESAMPLE FUNCTION DEBUG ==="),console.log("From sample rate:",e),console.log("To sample rate:",r),e===r)return console.log("No resampling needed - sample rates match"),t;let n=e/r,i=Math.round(t[0].length/n);console.log("Ratio:",n),console.log("Original length:",t[0].length),console.log("New length:",i),console.log("Original duration:",t[0].length/e,"seconds"),console.log("New duration:",i/r,"seconds"),console.log("===============================");let a=[];for(let e=0;e<t.length;e++){let r=t[e],s=new Float32Array(i);for(let t=0;t<i;t++){let e=t*n,i=Math.floor(e),a=e-i;i+1<r.length?s[t]=r[i]*(1-a)+r[i+1]*a:s[t]=r[i]||0}a.push(s)}return a}async getMarkersFromFile(t){return new Promise((e,r)=>{let n=new FileReader;n.readAsDataURL(t),n.onloadend=()=>{if("audio/wav"===t.type||"audio/wave"===t.type||"audio/x-wav"===t.type){let t=new th,r=n.result.replace("data:","").replace(/^.+,/,"");t.fromBase64(r),e(t.listCuePoints())}else e([])},n.onerror=r})}async createFileFromBuffer(t,e,r={}){let{channels:n=2,bitDepth:i=32,sampleRate:a=48e3}=r;console.log("=== EXPORT FORMAT INFO ==="),console.log("Export channels:",n),console.log("Export bit depth:",i),console.log("Export sample rate:",a),console.log("==========================");let s=this.originalSampleRate||44100;console.log("=== EXPORT DEBUG INFO ==="),console.log("Input buffer channels:",t.length),console.log("Input buffer length:",t[0].length),console.log("Original sample rate:",s),console.log("Target sample rate:",a),console.log("Original duration:",t[0].length/s,"seconds");let o=s!==a;console.log("Needs resampling:",o),console.log("========================");let u=o?this.resampleBuffer(t,s,a):t,l=u;if(1===n&&2===u.length){let t=new Float32Array(u[0].length);for(let e=0;e<u[0].length;e++)t[e]=(u[0][e]+u[1][e])/2;l=[t],console.log("Converted stereo to mono")}else 2===n&&1===u.length&&(l=[u[0],u[0]],console.log("Converted mono to stereo"));o?(console.log("=== RESAMPLE DEBUG INFO ==="),console.log("Resampled buffer length:",u[0].length),console.log("Expected resampled duration:",u[0].length/a,"seconds"),console.log("Sample rate ratio:",a/s),console.log("============================")):(console.log("=== NO RESAMPLING NEEDED ==="),console.log("Using original buffer directly"),console.log("=============================")),console.log("Exporting audio...");let h=new th;for(let t of(h.fromScratch(n,a,16===i?"16":24===i?"24":"32f",l),e))"top"!=t.position&&h.setCuePoint({position:1e3*t.time});for(let t=0;t<h.cue.points.length;t++)h.cue.points[t].dwPosition=h.cue.points[t].dwSampleOffset;let c=h.toDataURI();console.log("Saving file..."),(0,tc.saveAs)(c,"export.wav")}async createSampleDrumBuffer(t,e){let r=this.originalSampleRate||44100;console.log("Exporting audio... sample drum");let n=r!==this.targetSampleRate,i=n?this.resampleBuffer(t,r,this.targetSampleRate):t;n?console.log(`Resampling sample drum from ${r} to ${this.targetSampleRate} Hz`):console.log(`No resampling needed for sample drum - already at ${this.targetSampleRate} Hz`);let a=new th;a.fromScratch(2,this.targetSampleRate,"16",i);let s=a.toDataURI();console.log("Saving file..."),(0,tc.saveAs)(s,"export.wav")}async createCroppedBuffer(t,e,r="cropped.wav"){let n=this.originalSampleRate||44100;console.log("Exporting cropped audio...");let i=n!==this.targetSampleRate,a=i?this.resampleBuffer(t,n,this.targetSampleRate):t;i?console.log(`Resampling cropped audio from ${n} to ${this.targetSampleRate} Hz`):console.log(`No resampling needed for cropped audio - already at ${this.targetSampleRate} Hz`);let s=new th;for(let t of(s.fromScratch(2,this.targetSampleRate,"32f",a),e))"top"!=t.position&&s.setCuePoint({position:1e3*t.time});for(let t=0;t<s.cue.points.length;t++)s.cue.points[t].dwPosition=s.cue.points[t].dwSampleOffset;let o=s.toDataURI();console.log("Saving cropped file..."),(0,tc.saveAs)(o,r)}}var td={},tp={};tp=function(t,e,r){if(e===self.location.origin)return t;var n=r?"import "+JSON.stringify(t)+";":"importScripts("+JSON.stringify(t)+");";return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))};var tm=o("aNJCr");let tv=tm.getBundleURL("EVgbq")+"onset-worker.55e2dbf2.js";td=tp(tv,tm.getOrigin(tv),!1);class tg{constructor(t){this.morphaweb=t,this.worker=null,this.initWorker(),this.initKeyboardControls()}initWorker(){this.worker=new Worker(td),this.worker.onmessage=t=>{if(this.setLoadingState(!1),t.data.error){console.error("Onset detection error:",t.data.error);return}t.data.onsets&&(console.log("onsets",t.data.onsets),this.morphaweb.markerHandler.createOnsetMarkers(t.data.onsets)),null!==t.data.bpm&&this.morphaweb.updateBPM(t.data.bpm)}}setLoadingState(t){let e=this.morphaweb.wavesurfer.container;t?e.classList.add("wavesurfer-loading"):e.classList.remove("wavesurfer-loading")}detectOnsets(t,e){if(!this.worker){console.error("Worker not initialized");return}this.setLoadingState(!0);let r=new Float32Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[e];this.worker.postMessage({type:"processAudio",audioData:r,sampleRate:e})}destroy(){this.worker&&(this.worker.terminate(),this.worker=null)}initKeyboardControls(){document.addEventListener("keydown",t=>{if(t.key>="1"&&t.key<="9"||"0"===t.key){let e="0"===t.key?9:parseInt(t.key)-1;this.playSliceByIndex(e)}let e=["q","w","e","r","t","y","u","i","o","p"].indexOf(t.key.toLowerCase());-1!==e&&this.playSliceByIndex(e+10)})}playSliceByIndex(t){let e=this.morphaweb.markerHandler.getMarkers();if(t<e.length){let r=this.morphaweb.wavesurfer.backend.buffer.getChannelData(0),n=this.morphaweb.wavesurfer.backend.buffer.sampleRate,i=e[t],a=t<e.length-1?e[t+1]:this.morphaweb.wavesurfer.getDuration(),s=Math.round(i.time*n),o=Math.round(a.time*n),u=this.findNearestZeroCrossing(r,s),l=this.findNearestZeroCrossing(r,o),h=this.morphaweb.wavesurfer.addRegion({start:u/n,end:l/n,color:"hsla(358, 57%, 79%, 0.2)"});h.play(),h.once("out",()=>{h.remove()})}}findNearestZeroCrossing(t,e,r=100){let n=Math.max(0,e-r),i=Math.min(t.length-1,e+r);for(let a=0;a<=r;a++){let r=e+a;if(r<=i&&this.isZeroCrossing(t,r))return r;let s=e-a;if(s>=n&&this.isZeroCrossing(t,s))return s}return e}isZeroCrossing(t,e){if(e>=t.length-1)return!1;let r=t[e],n=t[e+1];return r<=0&&n>0||r>=0&&n<0}}class ty{constructor(t){this.morphaweb=t,this.createControls(),this.initializeDefaultValues()}createControls(){let t=document.getElementById("algorithm-controls");t.className="algorithm-controls";let e=this.createSlider({id:"frame-size",label:"Frame Size",min:512,max:8192,value:2048,step:512,tooltip:"Size of audio chunks for analysis. Controls frequency resolution. Increase this when using the 'Complex' or 'Complex Phase' detection functions and a pitched sound."}),r=this.createSlider({id:"hop-size",label:"Hop Size %",min:5,max:100,value:50,step:1,tooltip:"Audio analysis frame rate, given as a percentage of the frame size. Lower values result in increased temporal resolution, but longer analysis time."}),n=this.createSlider({id:"sensitivity",label:"Sensitivity %",min:1,max:100,value:50,step:1,tooltip:"Regulates the threshold for onset detection. Higher values tend to produce more false positives. Increase it if you know that your chosen audio has onsets but few or none are being displayed."}),i=this.createSlider({id:"odf-ratio",label:"ODF Ratio",min:0,max:100,value:50,step:10,helpText:"Higher values improve detection for percussive elements, lower values improve detection for pitch changes",tooltip:"To the right, this function computes the High Frequency Content (HFC) of a sound's spectrum. Great for detecting percussive events. To the left, reacts to deviations in pitch and changes in the frequency components of the sound. Measures spectral differences of both magnitude and phase between frames."});t.appendChild(e),t.appendChild(r),t.appendChild(n),t.appendChild(i),document.querySelector(".controls")}createSlider({id:t,label:e,min:r,max:n,value:i,step:a,helpText:s,tooltip:o}){let u=document.createElement("div");u.className="slider-container";let l=document.createElement("div");l.className="slider-controls";let h=document.createElement("label");h.htmlFor=t,h.textContent=e,o&&(h.title=o);let c=document.createElement("input");c.type="range",c.id=t,c.min=r,c.max=n,c.value=i,c.step=a,o&&(c.title=o);let f=(i-r)/(n-r)*100;c.style.setProperty("--value",f+"%");let d=document.createElement("span");if(d.className="slider-value",d.textContent=Number(i).toFixed(String(a).split(".")[1]?.length||0),c.addEventListener("input",t=>{let e=(t.target.value-r)/(n-r)*100;c.style.setProperty("--value",e+"%"),d.textContent=Number(c.value).toFixed(String(a).split(".")[1]?.length||0),this.handleSliderChange()}),l.appendChild(h),l.appendChild(c),l.appendChild(d),u.appendChild(l),s){let t=document.createElement("div");t.className="slider-help-text",t.textContent=s,u.appendChild(t)}return u}handleSliderChange(){let t,e;let r=parseInt(document.getElementById("frame-size").value),n=parseInt(document.getElementById("hop-size").value),i=parseFloat(document.getElementById("sensitivity").value),a=parseInt(document.getElementById("odf-ratio").value),s=Math.floor(n/100*r),o=a/100;0===a?(t=["complex"],e=[1]):100===a?(t=["hfc"],e=[1]):(t=["hfc","complex"],e=[o,1-o]);let u={frameSize:r,hopSize:s,sensitivity:i/100,odfs:t,odfsWeights:e};this.morphaweb.onsetHandler&&this.morphaweb.onsetHandler.worker.postMessage({type:"updateParams",params:u})}initializeDefaultValues(){this.handleSliderChange()}}new class{constructor(){this.scrollPos=0,this.scrollMin=0,this.playOffset=0,this.wavesurfer=/*@__PURE__*/i(u).create({container:"#waveform",waveColor:"#ffd000",progressColor:"white",plugins:[l.create(),c.create(),f.create({container:"#waveform-timeline",primaryFontColor:"white",secondaryFontColor:"white",primaryColor:"#ffd000",secondaryColor:"#ffd000",primaryFontSize:12,secondaryFontSize:10,height:15,notchPercentHeight:30,unlabeledNotchColor:"#ffd000",labelPadding:5,formatTimeCallback:t=>this.formatTime(t)}),d.create({showTime:!0,opacity:1,customShowTimeStyle:{"background-color":"#000",color:"#fff",padding:"2px","font-size":"10px"}})],minPxPerSec:20,cursorWidth:1,cursorColor:"#ff0000"}),this.dropHandler=new m(this),this.markerHandler=new y(this),this.controlsHandler=new g(this),this.wavHandler=new tf,this.onsetHandler=new tg(this),this.algorithmControls=new ty(this),this.initAnalytics(),this.wavesurfer.on("ready",this.onReady.bind(this)),this.createInfoDisplay(),this.setupZoomListener()}onReady=async()=>{this.scrollMin=Math.round(this.wavesurfer.container.scrollWidth/this.wavesurfer.getDuration()),this.scrollPos=this.scrollMin,this.markerHandler.addMarkers(this.wavHandler.markers),this.updateAllDisplays()};initAnalytics(){document.getElementById("export").addEventListener("click",t=>{this.track("export")})}track(t){}detectOnsets(){let t=this.wavesurfer.backend.buffer;if(!t){console.error("No audio loaded");return}let e=t.getChannelData(0),r=t.sampleRate;this.onsetHandler.detectOnsets(e,r)}createInfoDisplay(){let t=document.createElement("div");t.id="audio-info",t.className="audio-info",this.bpmDisplay=document.createElement("div"),this.bpmDisplay.id="bpm-display",t.appendChild(this.bpmDisplay);let e=document.getElementById("waveform");e.parentNode.insertBefore(t,e.nextSibling)}updateBPM(t){this.bpmDisplay&&(this.bpmDisplay.textContent=`BPM: ${t}`)}formatTime(t){let e=Math.floor(t/60),r=Math.floor(t%60);return`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}updateZoomDisplay(){let t=document.getElementById("zoom-level");if(t&&this.wavesurfer){let e=this.wavesurfer.params.minPxPerSec||20;t.textContent=`(${e} px/sec)`}}updateDurationDisplay(){let t=document.getElementById("audio-duration");if(t&&this.wavesurfer){let e=this.wavesurfer.getDuration();e>0?t.textContent=`Duration: ${this.formatTime(e)}`:t.textContent="Duration: --:--"}}updateRegionDisplays(){this.updateCropRegionDisplay(),this.updateFadeRegionDisplays()}updateCropRegionDisplay(){let t=document.getElementById("crop-info");if(t&&this.controlsHandler.cropRegion){let e=this.controlsHandler.cropRegion.start,r=this.controlsHandler.cropRegion.end;t.textContent=`Crop: ${this.formatTime(e)} - ${this.formatTime(r)}`,t.style.display="block"}else t&&(t.style.display="none")}updateFadeRegionDisplays(){let t=document.getElementById("fade-in-info"),e=document.getElementById("fade-out-info");if(t&&this.controlsHandler.fadeInRegion){let e=this.controlsHandler.fadeInRegion.start,r=this.controlsHandler.fadeInRegion.end;t.textContent=`Fade In: ${this.formatTime(e)} - ${this.formatTime(r)}`,t.style.display="block"}else t&&(t.style.display="none");if(e&&this.controlsHandler.fadeOutRegion){let t=this.controlsHandler.fadeOutRegion.start,r=this.controlsHandler.fadeOutRegion.end;e.textContent=`Fade Out: ${this.formatTime(t)} - ${this.formatTime(r)}`,e.style.display="block"}else e&&(e.style.display="none")}updateAllDisplays(){this.updateZoomDisplay(),this.updateDurationDisplay(),this.updateRegionDisplays()}setupZoomListener(){this.wavesurfer.on("zoom",t=>{this.updateZoomDisplay()})}},document.getElementById("version").textContent="v2.0"}();
//# sourceMappingURL=index.f02a3b4d.js.map
